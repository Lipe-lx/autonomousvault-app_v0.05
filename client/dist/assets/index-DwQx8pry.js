import{P as R,B as M,L as it,T as nt,b as Ii,p as kt,u as Jt,S as pe,a as Ee,g as hs,c as I,d as Br,_ as ws,K as bn,A as Sn,e as dn,f as $n,C as Or,h as ks}from"./index-Dx_s5gse.js";const N=new R("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),ee=new R("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"),Xe=new R("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");new R("So11111111111111111111111111111111111111112");new R("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");class xn extends Error{constructor(t){super(t)}}class ys extends xn{constructor(){super(...arguments),this.name="TokenAccountNotFoundError"}}class Ts extends xn{constructor(){super(...arguments),this.name="TokenInvalidAccountOwnerError"}}class Wn extends xn{constructor(){super(...arguments),this.name="TokenInvalidAccountSizeError"}}class bs extends xn{constructor(){super(...arguments),this.name="TokenInvalidMintError"}}var Pe;(function(e){e[e.InitializeMint=0]="InitializeMint",e[e.InitializeAccount=1]="InitializeAccount",e[e.InitializeMultisig=2]="InitializeMultisig",e[e.Transfer=3]="Transfer",e[e.Approve=4]="Approve",e[e.Revoke=5]="Revoke",e[e.SetAuthority=6]="SetAuthority",e[e.MintTo=7]="MintTo",e[e.Burn=8]="Burn",e[e.CloseAccount=9]="CloseAccount",e[e.FreezeAccount=10]="FreezeAccount",e[e.ThawAccount=11]="ThawAccount",e[e.TransferChecked=12]="TransferChecked",e[e.ApproveChecked=13]="ApproveChecked",e[e.MintToChecked=14]="MintToChecked",e[e.BurnChecked=15]="BurnChecked",e[e.InitializeAccount2=16]="InitializeAccount2",e[e.SyncNative=17]="SyncNative",e[e.InitializeAccount3=18]="InitializeAccount3",e[e.InitializeMultisig2=19]="InitializeMultisig2",e[e.InitializeMint2=20]="InitializeMint2",e[e.GetAccountDataSize=21]="GetAccountDataSize",e[e.InitializeImmutableOwner=22]="InitializeImmutableOwner",e[e.AmountToUiAmount=23]="AmountToUiAmount",e[e.UiAmountToAmount=24]="UiAmountToAmount",e[e.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",e[e.TransferFeeExtension=26]="TransferFeeExtension",e[e.ConfidentialTransferExtension=27]="ConfidentialTransferExtension",e[e.DefaultAccountStateExtension=28]="DefaultAccountStateExtension",e[e.Reallocate=29]="Reallocate",e[e.MemoTransferExtension=30]="MemoTransferExtension",e[e.CreateNativeMint=31]="CreateNativeMint",e[e.InitializeNonTransferableMint=32]="InitializeNonTransferableMint",e[e.InterestBearingMintExtension=33]="InterestBearingMintExtension",e[e.CpiGuardExtension=34]="CpiGuardExtension",e[e.InitializePermanentDelegate=35]="InitializePermanentDelegate",e[e.TransferHookExtension=36]="TransferHookExtension",e[e.MetadataPointerExtension=39]="MetadataPointerExtension"})(Pe||(Pe={}));function hr(e,t,n){if(n.length){e.push({pubkey:t,isSigner:!1,isWritable:!1});for(const r of n)e.push({pubkey:r instanceof R?r:r.publicKey,isSigner:!0,isWritable:!1})}else e.push({pubkey:t,isSigner:!0,isWritable:!1});return e}const _r=it.struct([it.u8("instruction")]);function Ss(e,t,n,r=[],i=N){const s=hr([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,r),o=M.alloc(_r.span);return _r.encode({instruction:Pe.CloseAccount},o),new nt({keys:s,programId:i,data:o})}var Kn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Mint=1]="Mint",e[e.Account=2]="Account"})(Kn||(Kn={}));const vs=1,Is=it.struct([it.u8("m"),it.u8("n"),Ii("isInitialized"),kt("signer1"),kt("signer2"),kt("signer3"),kt("signer4"),kt("signer5"),kt("signer6"),kt("signer7"),kt("signer8"),kt("signer9"),kt("signer10"),kt("signer11")]),Bs=Is.span;var Lr;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",e[e.Frozen=2]="Frozen"})(Lr||(Lr={}));const be=it.struct([kt("mint"),kt("owner"),Jt("amount"),it.u32("delegateOption"),kt("delegate"),it.u8("state"),it.u32("isNativeOption"),Jt("isNative"),Jt("delegatedAmount"),it.u32("closeAuthorityOption"),kt("closeAuthority")]),Dn=be.span,Bi=it.struct([it.u32("mintAuthorityOption"),kt("mintAuthority"),Jt("supply"),it.u8("decimals"),Ii("isInitialized"),it.u32("freezeAuthorityOption"),kt("freezeAuthority")]),Un=Bi.span;function Os(e,t,n=N){if(!t)throw new ys;if(!t.owner.equals(n))throw new Ts;if(t.data.length<Un)throw new Wn;const r=Bi.decode(t.data.slice(0,Un));let i=M.alloc(0);if(t.data.length>Un){if(t.data.length<=Dn)throw new Wn;if(t.data.length===Bs)throw new Wn;if(t.data[Dn]!=Kn.Mint)throw new bs;i=t.data.slice(Dn+vs)}return{address:e,mintAuthority:r.mintAuthorityOption?r.mintAuthority:null,supply:r.supply,decimals:r.decimals,isInitialized:r.isInitialized,freezeAuthority:r.freezeAuthorityOption?r.freezeAuthority:null,tlvData:i}}const _s=1e4;BigInt(_s);function Er(e){return it.struct([Jt("epoch"),Jt("maximumFee"),it.u16("transferFeeBasisPoints")],e)}const Oi=it.struct([kt("transferFeeConfigAuthority"),kt("withdrawWithheldAuthority"),Jt("withheldAmount"),Er("olderTransferFee"),Er("newerTransferFee")]);Oi.span;const Ls=it.struct([Jt("withheldAmount")]);Ls.span;function Es(e){const t=Rs(Jn.TransferFeeConfig,e.tlvData);return t!==null?Oi.decode(t):null}var Jn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.TransferFeeConfig=1]="TransferFeeConfig",e[e.TransferFeeAmount=2]="TransferFeeAmount",e[e.MintCloseAuthority=3]="MintCloseAuthority",e[e.ConfidentialTransferMint=4]="ConfidentialTransferMint",e[e.ConfidentialTransferAccount=5]="ConfidentialTransferAccount",e[e.DefaultAccountState=6]="DefaultAccountState",e[e.ImmutableOwner=7]="ImmutableOwner",e[e.MemoTransfer=8]="MemoTransfer",e[e.NonTransferable=9]="NonTransferable",e[e.InterestBearingConfig=10]="InterestBearingConfig",e[e.CpiGuard=11]="CpiGuard",e[e.PermanentDelegate=12]="PermanentDelegate",e[e.NonTransferableAccount=13]="NonTransferableAccount",e[e.TransferHook=14]="TransferHook",e[e.TransferHookAccount=15]="TransferHookAccount",e[e.MetadataPointer=18]="MetadataPointer",e[e.TokenMetadata=19]="TokenMetadata"})(Jn||(Jn={}));const _i=2,Ps=2;function Pr(e){return e+_i+Ps}function Rs(e,t){let n=0;for(;Pr(n)<=t.length;){const r=t.readUInt16LE(n),i=t.readUInt16LE(n+_i),s=Pr(n);if(r==e)return t.slice(s,s+i);n=s+i}return null}const Rr=it.struct([it.u8("instruction")]);function xs(e,t,n,r=N){const i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:pe,isSigner:!1,isWritable:!1}],s=M.alloc(Rr.span);return Rr.encode({instruction:Pe.InitializeAccount},s),new nt({keys:i,programId:r,data:s})}function Ms(e,t,n,r,i=N,s=Xe){return qs(e,t,n,r,M.alloc(0),i,s)}function qs(e,t,n,r,i,s=N,o=Xe){const a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:Ee.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}];return new nt({keys:a,programId:o,data:i})}const xr=it.struct([it.u8("instruction"),Jt("amount")]);function Ns(e,t,n,r,i=[],s=N){const o=hr([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,i),a=M.alloc(xr.span);return xr.encode({instruction:Pe.MintTo,amount:BigInt(r)},a),new nt({keys:o,programId:s,data:a})}const Mr=it.struct([it.u8("instruction"),Jt("amount")]);function Cs(e,t,n,r,i=[],s=N){const o=hr([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],n,i),a=M.alloc(Mr.span);return Mr.encode({instruction:Pe.Transfer,amount:BigInt(r)},a),new nt({keys:o,programId:s,data:a})}const qr=it.struct([it.u8("instruction"),it.u8("decimals"),kt("mintAuthority"),it.u8("freezeAuthorityOption"),kt("freezeAuthority")]);function Fs(e,t,n,r,i=N){const s=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:pe,isSigner:!1,isWritable:!1}],o=M.alloc(qr.span);return qr.encode({instruction:Pe.InitializeMint,decimals:t,mintAuthority:n,freezeAuthorityOption:r?1:0,freezeAuthority:r||new R(0)},o),new nt({keys:s,programId:i,data:o})}var Ws=20,Ds=1,Re=1e6,Nr=1e6,Us=-7,Vs=21,Gs=!1,an="[big.js] ",xe=an+"Invalid ",Mn=xe+"decimal places",zs=xe+"rounding mode",Li=an+"Division by zero",lt={},te=void 0,Xs=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Ei(){function e(t){var n=this;if(!(n instanceof e))return t===te?Ei():new e(t);if(t instanceof e)n.s=t.s,n.e=t.e,n.c=t.c.slice();else{if(typeof t!="string"){if(e.strict===!0&&typeof t!="bigint")throw TypeError(xe+"value");t=t===0&&1/t<0?"-0":String(t)}Ys(n,t)}n.constructor=e}return e.prototype=lt,e.DP=Ws,e.RM=Ds,e.NE=Us,e.PE=Vs,e.strict=Gs,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function Ys(e,t){var n,r,i;if(!Xs.test(t))throw Error(xe+"number");for(e.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),i=t.length,r=0;r<i&&t.charAt(r)=="0";)++r;if(r==i)e.c=[e.e=0];else{for(;i>0&&t.charAt(--i)=="0";);for(e.e=n-r-1,e.c=[],n=0;r<=i;)e.c[n++]=+t.charAt(r++)}return e}function Me(e,t,n,r){var i=e.c;if(n===te&&(n=e.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(zs);if(t<1)r=n===3&&(r||!!i[0])||t===0&&(n===1&&i[0]>=5||n===2&&(i[0]>5||i[0]===5&&(r||i[1]!==te))),i.length=1,r?(e.e=e.e-t+1,i[0]=1):i[0]=e.e=0;else if(t<i.length){if(r=n===1&&i[t]>=5||n===2&&(i[t]>5||i[t]===5&&(r||i[t+1]!==te||i[t-1]&1))||n===3&&(r||!!i[0]),i.length=t,r){for(;++i[--t]>9;)if(i[t]=0,t===0){++e.e,i.unshift(1);break}}for(t=i.length;!i[--t];)i.pop()}return e}function qe(e,t,n){var r=e.e,i=e.c.join(""),s=i.length;if(t)i=i.charAt(0)+(s>1?"."+i.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)i="0"+i;i="0."+i}else if(r>0)if(++r>s)for(r-=s;r--;)i+="0";else r<s&&(i=i.slice(0,r)+"."+i.slice(r));else s>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&n?"-"+i:i}lt.abs=function(){var e=new this.constructor(this);return e.s=1,e};lt.cmp=function(e){var t,n=this,r=n.c,i=(e=new n.constructor(e)).c,s=n.s,o=e.s,a=n.e,u=e.e;if(!r[0]||!i[0])return r[0]?s:i[0]?-o:0;if(s!=o)return s;if(t=s<0,a!=u)return a>u^t?1:-1;for(o=(a=r.length)<(u=i.length)?a:u,s=-1;++s<o;)if(r[s]!=i[s])return r[s]>i[s]^t?1:-1;return a==u?0:a>u^t?1:-1};lt.div=function(e){var t=this,n=t.constructor,r=t.c,i=(e=new n(e)).c,s=t.s==e.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>Re)throw Error(Mn);if(!i[0])throw Error(Li);if(!r[0])return e.s=s,e.c=[e.e=0],e;var a,u,c,l,d,f=i.slice(),m=a=i.length,p=r.length,g=r.slice(0,a),k=g.length,A=e,h=A.c=[],w=0,T=o+(A.e=t.e-e.e)+1;for(A.s=s,s=T<0?0:T,f.unshift(0);k++<a;)g.push(0);do{for(c=0;c<10;c++){if(a!=(k=g.length))l=a>k?1:-1;else for(d=-1,l=0;++d<a;)if(i[d]!=g[d]){l=i[d]>g[d]?1:-1;break}if(l<0){for(u=k==a?i:f;k;){if(g[--k]<u[k]){for(d=k;d&&!g[--d];)g[d]=9;--g[d],g[k]+=10}g[k]-=u[k]}for(;!g[0];)g.shift()}else break}h[w++]=l?c:++c,g[0]&&l?g[k]=r[m]||0:g=[r[m]]}while((m++<p||g[0]!==te)&&s--);return!h[0]&&w!=1&&(h.shift(),A.e--,T--),w>T&&Me(A,T,n.RM,g[0]!==te),A};lt.eq=function(e){return this.cmp(e)===0};lt.gt=function(e){return this.cmp(e)>0};lt.gte=function(e){return this.cmp(e)>-1};lt.lt=function(e){return this.cmp(e)<0};lt.lte=function(e){return this.cmp(e)<1};lt.minus=lt.sub=function(e){var t,n,r,i,s=this,o=s.constructor,a=s.s,u=(e=new o(e)).s;if(a!=u)return e.s=-u,s.plus(e);var c=s.c.slice(),l=s.e,d=e.c,f=e.e;if(!c[0]||!d[0])return d[0]?e.s=-u:c[0]?e=new o(s):e.s=1,e;if(a=l-f){for((i=a<0)?(a=-a,r=c):(f=l,r=d),r.reverse(),u=a;u--;)r.push(0);r.reverse()}else for(n=((i=c.length<d.length)?c:d).length,a=u=0;u<n;u++)if(c[u]!=d[u]){i=c[u]<d[u];break}if(i&&(r=c,c=d,d=r,e.s=-e.s),(u=(n=d.length)-(t=c.length))>0)for(;u--;)c[t++]=0;for(u=t;n>a;){if(c[--n]<d[n]){for(t=n;t&&!c[--t];)c[t]=9;--c[t],c[n]+=10}c[n]-=d[n]}for(;c[--u]===0;)c.pop();for(;c[0]===0;)c.shift(),--f;return c[0]||(e.s=1,c=[f=0]),e.c=c,e.e=f,e};lt.mod=function(e){var t,n=this,r=n.constructor,i=n.s,s=(e=new r(e)).s;if(!e.c[0])throw Error(Li);return n.s=e.s=1,t=e.cmp(n)==1,n.s=i,e.s=s,t?new r(n):(i=r.DP,s=r.RM,r.DP=r.RM=0,n=n.div(e),r.DP=i,r.RM=s,this.minus(n.times(e)))};lt.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e};lt.plus=lt.add=function(e){var t,n,r,i=this,s=i.constructor;if(e=new s(e),i.s!=e.s)return e.s=-e.s,i.minus(e);var o=i.e,a=i.c,u=e.e,c=e.c;if(!a[0]||!c[0])return c[0]||(a[0]?e=new s(i):e.s=i.s),e;if(a=a.slice(),t=o-u){for(t>0?(u=o,r=c):(t=-t,r=a),r.reverse();t--;)r.push(0);r.reverse()}for(a.length-c.length<0&&(r=c,c=a,a=r),t=c.length,n=0;t;a[t]%=10)n=(a[--t]=a[t]+c[t]+n)/10|0;for(n&&(a.unshift(n),++u),t=a.length;a[--t]===0;)a.pop();return e.c=a,e.e=u,e};lt.pow=function(e){var t=this,n=new t.constructor("1"),r=n,i=e<0;if(e!==~~e||e<-Nr||e>Nr)throw Error(xe+"exponent");for(i&&(e=-e);e&1&&(r=r.times(t)),e>>=1,!!e;)t=t.times(t);return i?n.div(r):r};lt.prec=function(e,t){if(e!==~~e||e<1||e>Re)throw Error(xe+"precision");return Me(new this.constructor(this),e,t)};lt.round=function(e,t){if(e===te)e=0;else if(e!==~~e||e<-Re||e>Re)throw Error(Mn);return Me(new this.constructor(this),e+this.e+1,t)};lt.sqrt=function(){var e,t,n,r=this,i=r.constructor,s=r.s,o=r.e,a=new i("0.5");if(!r.c[0])return new i(r);if(s<0)throw Error(an+"No square root");s=Math.sqrt(+qe(r,!0,!0)),s===0||s===1/0?(t=r.c.join(""),t.length+o&1||(t+="0"),s=Math.sqrt(t),o=((o+1)/2|0)-(o<0||o&1),e=new i((s==1/0?"5e":(s=s.toExponential()).slice(0,s.indexOf("e")+1))+o)):e=new i(s+""),o=e.e+(i.DP+=4);do n=e,e=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==e.c.slice(0,o).join(""));return Me(e,(i.DP-=4)+e.e+1,i.RM)};lt.times=lt.mul=function(e){var t,n=this,r=n.constructor,i=n.c,s=(e=new r(e)).c,o=i.length,a=s.length,u=n.e,c=e.e;if(e.s=n.s==e.s?1:-1,!i[0]||!s[0])return e.c=[e.e=0],e;for(e.e=u+c,o<a&&(t=i,i=s,s=t,c=o,o=a,a=c),t=new Array(c=o+a);c--;)t[c]=0;for(u=a;u--;){for(a=0,c=o+u;c>u;)a=t[c]+s[u]*i[c-u-1]+a,t[c--]=a%10,a=a/10|0;t[c]=a}for(a?++e.e:t.shift(),u=t.length;!t[--u];)t.pop();return e.c=t,e};lt.toExponential=function(e,t){var n=this,r=n.c[0];if(e!==te){if(e!==~~e||e<0||e>Re)throw Error(Mn);for(n=Me(new n.constructor(n),++e,t);n.c.length<e;)n.c.push(0)}return qe(n,!0,!!r)};lt.toFixed=function(e,t){var n=this,r=n.c[0];if(e!==te){if(e!==~~e||e<0||e>Re)throw Error(Mn);for(n=Me(new n.constructor(n),e+n.e+1,t),e=e+n.e+1;n.c.length<e;)n.c.push(0)}return qe(n,!1,!!r)};lt[Symbol.for("nodejs.util.inspect.custom")]=lt.toJSON=lt.toString=function(){var e=this,t=e.constructor;return qe(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])};lt.toNumber=function(){var e=+qe(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error(an+"Imprecise conversion");return e};lt.toPrecision=function(e,t){var n=this,r=n.constructor,i=n.c[0];if(e!==te){if(e!==~~e||e<1||e>Re)throw Error(xe+"precision");for(n=Me(new r(n),e,t);n.c.length<e;)n.c.push(0)}return qe(n,e<=n.e||n.e<=r.NE||n.e>=r.PE,!!i)};lt.valueOf=function(){var e=this,t=e.constructor;if(t.strict===!0)throw Error(an+"valueOf disallowed");return qe(e,e.e<=t.NE||e.e>=t.PE,!0)};var Pi=Ei(),Vn={exports:{}},Cr;function Qs(){return Cr||(Cr=1,(function(e){function t(n){return n.prototype.toFormat=function(i,s,o){if(!this.e&&this.e!==0)return this.toString();var a,u,c,l,d,f,m,p,g,k,A,h,w,T,b,v=this.format||{},S=this.constructor.format||{};if(i!=d?typeof i=="object"?(o=i,i=d):s!=d?typeof s=="object"?(o=s,s=d):typeof o!="object"&&(o={}):o={}:o={},a=this.toFixed(i,s).split("."),p=a[0],g=a[1],m=this.s<0?p.slice(1):p,f=m.length,k=o.decimalSeparator,k==d&&(k=v.decimalSeparator,k==d&&(k=S.decimalSeparator,k==d&&(k="."))),A=o.groupSeparator,A==d&&(A=v.groupSeparator,A==d&&(A=S.groupSeparator)),A&&(h=o.groupSize,h==d&&(h=v.groupSize,h==d&&(h=S.groupSize,h==d&&(h=0))),w=o.secondaryGroupSize,w==d&&(w=v.secondaryGroupSize,w==d&&(w=S.secondaryGroupSize,w==d&&(w=0))),w?(u=+w,c=+h,f-=c):(u=+h,c=+w),u>0&&f>0)){for(l=f%u||u,p=m.substr(0,l);l<f;l+=u)p+=A+m.substr(l,u);c>0&&(p+=A+m.slice(l)),this.s<0&&(p="-"+p)}return g?(T=o.fractionGroupSeparator,T==d&&(T=v.fractionGroupSeparator,T==d&&(T=S.fractionGroupSeparator)),T&&(b=o.fractionGroupSize,b==d&&(b=v.fractionGroupSize,b==d&&(b=S.fractionGroupSize,b==d&&(b=0))),b=+b,b&&(g=g.replace(new RegExp("\\d{"+b+"}\\B","g"),"$&"+T))),p+k+g):p},n.format={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:"",fractionGroupSize:0},n}e.exports&&(e.exports=t)})(Vn)),Vn.exports}var Hs=Qs();const js=hs(Hs);/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var De=9e15,ke=1e9,tr="0123456789abcdef",vn="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",In="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",er={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-De,maxE:De,crypto:!1},Ri,ae,tt=!0,qn="[DecimalError] ",he=qn+"Invalid argument: ",xi=qn+"Precision limit exceeded",Mi=qn+"crypto unavailable",qi="[object Decimal]",Rt=Math.floor,vt=Math.pow,Zs=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,$s=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Ks=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ni=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,zt=1e7,K=7,Js=9007199254740991,to=vn.length-1,nr=In.length-1,x={toStringTag:qi};x.absoluteValue=x.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),Q(e)};x.ceil=function(){return Q(new this.constructor(this),this.e+1,2)};x.clampedTo=x.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(he+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};x.comparedTo=x.cmp=function(e){var t,n,r,i,s=this,o=s.d,a=(e=new s.constructor(e)).d,u=s.s,c=e.s;if(!o||!a)return!u||!c?NaN:u!==c?u:o===a?0:!o^u<0?1:-1;if(!o[0]||!a[0])return o[0]?u:a[0]?-c:0;if(u!==c)return u;if(s.e!==e.e)return s.e>e.e^u<0?1:-1;for(r=o.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(o[t]!==a[t])return o[t]>a[t]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};x.cosine=x.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+K,r.rounding=1,n=eo(r,Ui(r,n)),r.precision=e,r.rounding=t,Q(ae==2||ae==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};x.cubeRoot=x.cbrt=function(){var e,t,n,r,i,s,o,a,u,c,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(tt=!1,s=l.s*vt(l.s*l,1/3),!s||Math.abs(s)==1/0?(n=Ot(l.d),e=l.e,(s=(e-n.length+1)%3)&&(n+=s==1||s==-2?"0":"00"),s=vt(n,1/3),e=Rt((e+1)/3)-(e%3==(e<0?-1:2)),s==1/0?n="5e"+e:(n=s.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new d(n),r.s=l.s):r=new d(s.toString()),o=(e=d.precision)+3;;)if(a=r,u=a.times(a).times(a),c=u.plus(l),r=pt(c.plus(l).times(a),c.plus(u),o+2,1),Ot(a.d).slice(0,o)===(n=Ot(r.d)).slice(0,o))if(n=n.slice(o-3,o+1),n=="9999"||!i&&n=="4999"){if(!i&&(Q(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}o+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(Q(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return tt=!0,Q(r,e,d.rounding,t)};x.decimalPlaces=x.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-Rt(this.e/K))*K,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};x.dividedBy=x.div=function(e){return pt(this,new this.constructor(e))};x.dividedToIntegerBy=x.divToInt=function(e){var t=this,n=t.constructor;return Q(pt(t,new n(e),0,1,1),n.precision,n.rounding)};x.equals=x.eq=function(e){return this.cmp(e)===0};x.floor=function(){return Q(new this.constructor(this),this.e+1,3)};x.greaterThan=x.gt=function(e){return this.cmp(e)>0};x.greaterThanOrEqualTo=x.gte=function(e){var t=this.cmp(e);return t==1||t===0};x.hyperbolicCosine=x.cosh=function(){var e,t,n,r,i,s=this,o=s.constructor,a=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return a;n=o.precision,r=o.rounding,o.precision=n+Math.max(s.e,s.sd())+4,o.rounding=1,i=s.d.length,i<32?(e=Math.ceil(i/3),t=(1/Cn(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),s=ze(o,1,s.times(t),new o(1),!0);for(var u,c=e,l=new o(8);c--;)u=s.times(s),s=a.minus(u.times(l.minus(u.times(l))));return Q(s,o.precision=n,o.rounding=r,!0)};x.hyperbolicSine=x.sinh=function(){var e,t,n,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(t=s.precision,n=s.rounding,s.precision=t+Math.max(i.e,i.sd())+4,s.rounding=1,r=i.d.length,r<3)i=ze(s,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/Cn(5,e)),i=ze(s,2,i,i,!0);for(var o,a=new s(5),u=new s(16),c=new s(20);e--;)o=i.times(i),i=i.times(a.plus(o.times(u.times(o).plus(c))))}return s.precision=t,s.rounding=n,Q(i,t,n,!0)};x.hyperbolicTangent=x.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,pt(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};x.inverseCosine=x.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),r=t.precision,i=t.rounding;return n!==-1?n===0?e.isNeg()?Kt(t,r,i):new t(0):new t(NaN):e.isZero()?Kt(t,r+4,i).times(.5):(t.precision=r+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=r,t.rounding=i,e.times(2))};x.inverseHyperbolicCosine=x.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,tt=!1,n=n.times(n).minus(1).sqrt().plus(n),tt=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};x.inverseHyperbolicSine=x.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,tt=!1,n=n.times(n).plus(1).sqrt().plus(n),tt=!0,r.precision=e,r.rounding=t,n.ln())};x.inverseHyperbolicTangent=x.atanh=function(){var e,t,n,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=s.precision,t=s.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?Q(new s(i),e,t,!0):(s.precision=n=r-i.e,i=pt(i.plus(1),new s(1).minus(i),n+e,1),s.precision=e+4,s.rounding=1,i=i.ln(),s.precision=e,s.rounding=t,i.times(.5))):new s(NaN)};x.inverseSine=x.asin=function(){var e,t,n,r,i=this,s=i.constructor;return i.isZero()?new s(i):(t=i.abs().cmp(1),n=s.precision,r=s.rounding,t!==-1?t===0?(e=Kt(s,n+4,r).times(.5),e.s=i.s,e):new s(NaN):(s.precision=n+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=n,s.rounding=r,i.times(2)))};x.inverseTangent=x.atan=function(){var e,t,n,r,i,s,o,a,u,c=this,l=c.constructor,d=l.precision,f=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&d+4<=nr)return o=Kt(l,d+4,f).times(.25),o.s=c.s,o}else{if(!c.s)return new l(NaN);if(d+4<=nr)return o=Kt(l,d+4,f).times(.5),o.s=c.s,o}for(l.precision=a=d+10,l.rounding=1,n=Math.min(28,a/K+2|0),e=n;e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(tt=!1,t=Math.ceil(a/K),r=1,u=c.times(c),o=new l(c),i=c;e!==-1;)if(i=i.times(u),s=o.minus(i.div(r+=2)),i=i.times(u),o=s.plus(i.div(r+=2)),o.d[t]!==void 0)for(e=t;o.d[e]===s.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),tt=!0,Q(o,l.precision=d,l.rounding=f,!0)};x.isFinite=function(){return!!this.d};x.isInteger=x.isInt=function(){return!!this.d&&Rt(this.e/K)>this.d.length-2};x.isNaN=function(){return!this.s};x.isNegative=x.isNeg=function(){return this.s<0};x.isPositive=x.isPos=function(){return this.s>0};x.isZero=function(){return!!this.d&&this.d[0]===0};x.lessThan=x.lt=function(e){return this.cmp(e)<0};x.lessThanOrEqualTo=x.lte=function(e){return this.cmp(e)<1};x.logarithm=x.log=function(e){var t,n,r,i,s,o,a,u,c=this,l=c.constructor,d=l.precision,f=l.rounding,m=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new l(n&&!n[0]?-1/0:c.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)s=!0;else{for(i=n[0];i%10===0;)i/=10;s=i!==1}if(tt=!1,a=d+m,o=Ae(c,a),r=t?Bn(l,a+10):Ae(e,a),u=pt(o,r,a,1),nn(u.d,i=d,f))do if(a+=10,o=Ae(c,a),r=t?Bn(l,a+10):Ae(e,a),u=pt(o,r,a,1),!s){+Ot(u.d).slice(i+1,i+15)+1==1e14&&(u=Q(u,d+1,0));break}while(nn(u.d,i+=10,f));return tt=!0,Q(u,d,f)};x.minus=x.sub=function(e){var t,n,r,i,s,o,a,u,c,l,d,f,m=this,p=m.constructor;if(e=new p(e),!m.d||!e.d)return!m.s||!e.s?e=new p(NaN):m.d?e.s=-e.s:e=new p(e.d||m.s!==e.s?m:NaN),e;if(m.s!=e.s)return e.s=-e.s,m.plus(e);if(c=m.d,f=e.d,a=p.precision,u=p.rounding,!c[0]||!f[0]){if(f[0])e.s=-e.s;else if(c[0])e=new p(m);else return new p(u===3?-0:0);return tt?Q(e,a,u):e}if(n=Rt(e.e/K),l=Rt(m.e/K),c=c.slice(),s=l-n,s){for(d=s<0,d?(t=c,s=-s,o=f.length):(t=f,n=l,o=c.length),r=Math.max(Math.ceil(a/K),o)+2,s>r&&(s=r,t.length=1),t.reverse(),r=s;r--;)t.push(0);t.reverse()}else{for(r=c.length,o=f.length,d=r<o,d&&(o=r),r=0;r<o;r++)if(c[r]!=f[r]){d=c[r]<f[r];break}s=0}for(d&&(t=c,c=f,f=t,e.s=-e.s),o=c.length,r=f.length-o;r>0;--r)c[o++]=0;for(r=f.length;r>s;){if(c[--r]<f[r]){for(i=r;i&&c[--i]===0;)c[i]=zt-1;--c[i],c[r]+=zt}c[r]-=f[r]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=Nn(c,n),tt?Q(e,a,u):e):new p(u===3?-0:0)};x.modulo=x.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?Q(new r(n),r.precision,r.rounding):(tt=!1,r.modulo==9?(t=pt(n,e.abs(),0,3,1),t.s*=e.s):t=pt(n,e,0,r.modulo,1),t=t.times(e),tt=!0,n.minus(t))};x.naturalExponential=x.exp=function(){return rr(this)};x.naturalLogarithm=x.ln=function(){return Ae(this)};x.negated=x.neg=function(){var e=new this.constructor(this);return e.s=-e.s,Q(e)};x.plus=x.add=function(e){var t,n,r,i,s,o,a,u,c,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(c=d.d,l=e.d,a=f.precision,u=f.rounding,!c[0]||!l[0])return l[0]||(e=new f(d)),tt?Q(e,a,u):e;if(s=Rt(d.e/K),r=Rt(e.e/K),c=c.slice(),i=s-r,i){for(i<0?(n=c,i=-i,o=l.length):(n=l,r=s,o=c.length),s=Math.ceil(a/K),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=l.length,o-i<0&&(i=o,n=l,l=c,c=n),t=0;i;)t=(c[--i]=c[i]+l[i]+t)/zt|0,c[i]%=zt;for(t&&(c.unshift(t),++r),o=c.length;c[--o]==0;)c.pop();return e.d=c,e.e=Nn(c,r),tt?Q(e,a,u):e};x.precision=x.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(he+e);return n.d?(t=Ci(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};x.round=function(){var e=this,t=e.constructor;return Q(new t(e),e.e+1,t.rounding)};x.sine=x.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+K,r.rounding=1,n=ro(r,Ui(r,n)),r.precision=e,r.rounding=t,Q(ae>2?n.neg():n,e,t,!0)):new r(NaN)};x.squareRoot=x.sqrt=function(){var e,t,n,r,i,s,o=this,a=o.d,u=o.e,c=o.s,l=o.constructor;if(c!==1||!a||!a[0])return new l(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);for(tt=!1,c=Math.sqrt(+o),c==0||c==1/0?(t=Ot(a),(t.length+u)%2==0&&(t+="0"),c=Math.sqrt(t),u=Rt((u+1)/2)-(u<0||u%2),c==1/0?t="5e"+u:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+u),r=new l(t)):r=new l(c.toString()),n=(u=l.precision)+3;;)if(s=r,r=s.plus(pt(o,s,n+2,1)).times(.5),Ot(s.d).slice(0,n)===(t=Ot(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(Q(s,u+1,0),s.times(s).eq(o))){r=s;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(Q(r,u+1,1),e=!r.times(r).eq(o));break}return tt=!0,Q(r,u,l.rounding,e)};x.tangent=x.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=pt(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,Q(ae==2||ae==4?n.neg():n,e,t,!0)):new r(NaN)};x.times=x.mul=function(e){var t,n,r,i,s,o,a,u,c,l=this,d=l.constructor,f=l.d,m=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!m||!m[0])return new d(!e.s||f&&!f[0]&&!m||m&&!m[0]&&!f?NaN:!f||!m?e.s/0:e.s*0);for(n=Rt(l.e/K)+Rt(e.e/K),u=f.length,c=m.length,u<c&&(s=f,f=m,m=s,o=u,u=c,c=o),s=[],o=u+c,r=o;r--;)s.push(0);for(r=c;--r>=0;){for(t=0,i=u+r;i>r;)a=s[i]+m[r]*f[i-r-1]+t,s[i--]=a%zt|0,t=a/zt|0;s[i]=(s[i]+t)%zt|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=Nn(s,n),tt?Q(e,d.precision,d.rounding):e};x.toBinary=function(e,t){return wr(this,2,e,t)};x.toDecimalPlaces=x.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Nt(e,0,ke),t===void 0?t=r.rounding:Nt(t,0,8),Q(n,e+n.e+1,t))};x.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=ne(r,!0):(Nt(e,0,ke),t===void 0?t=i.rounding:Nt(t,0,8),r=Q(new i(r),e+1,t),n=ne(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};x.toFixed=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?n=ne(i):(Nt(e,0,ke),t===void 0?t=s.rounding:Nt(t,0,8),r=Q(new s(i),e+i.e+1,t),n=ne(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};x.toFraction=function(e){var t,n,r,i,s,o,a,u,c,l,d,f,m=this,p=m.d,g=m.constructor;if(!p)return new g(m);if(c=n=new g(1),r=u=new g(0),t=new g(r),s=t.e=Ci(p)-m.e-1,o=s%K,t.d[0]=vt(10,o<0?K+o:o),e==null)e=s>0?t:c;else{if(a=new g(e),!a.isInt()||a.lt(c))throw Error(he+a);e=a.gt(t)?s>0?t:c:a}for(tt=!1,a=new g(Ot(p)),l=g.precision,g.precision=s=p.length*K*2;d=pt(a,t,0,1,1),i=n.plus(d.times(r)),i.cmp(e)!=1;)n=r,r=i,i=c,c=u.plus(d.times(i)),u=i,i=t,t=a.minus(d.times(i)),a=i;return i=pt(e.minus(n),r,0,1,1),u=u.plus(i.times(c)),n=n.plus(i.times(r)),u.s=c.s=m.s,f=pt(c,r,s,1).minus(m).abs().cmp(pt(u,n,s,1).minus(m).abs())<1?[c,r]:[u,n],g.precision=l,tt=!0,f};x.toHexadecimal=x.toHex=function(e,t){return wr(this,16,e,t)};x.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:Nt(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(tt=!1,n=pt(n,e,0,t,1).times(e),tt=!0,Q(n)):(e.s=n.s,n=e),n};x.toNumber=function(){return+this};x.toOctal=function(e,t){return wr(this,8,e,t)};x.toPower=x.pow=function(e){var t,n,r,i,s,o,a=this,u=a.constructor,c=+(e=new u(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new u(vt(+a,c));if(a=new u(a),a.eq(1))return a;if(r=u.precision,s=u.rounding,e.eq(1))return Q(a,r,s);if(t=Rt(e.e/K),t>=e.d.length-1&&(n=c<0?-c:c)<=Js)return i=Fi(u,a,n,r),e.s<0?new u(1).div(i):Q(i,r,s);if(o=a.s,o<0){if(t<e.d.length-1)return new u(NaN);if((e.d[t]&1)==0&&(o=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=o,a}return n=vt(+a,c),t=n==0||!isFinite(n)?Rt(c*(Math.log("0."+Ot(a.d))/Math.LN10+a.e+1)):new u(n+"").e,t>u.maxE+1||t<u.minE-1?new u(t>0?o/0:0):(tt=!1,u.rounding=a.s=1,n=Math.min(12,(t+"").length),i=rr(e.times(Ae(a,r+n)),r),i.d&&(i=Q(i,r+5,1),nn(i.d,r,s)&&(t=r+10,i=Q(rr(e.times(Ae(a,t+n)),t),t+5,1),+Ot(i.d).slice(r+1,r+15)+1==1e14&&(i=Q(i,r+1,0)))),i.s=o,tt=!0,u.rounding=s,Q(i,r,s))};x.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=ne(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(Nt(e,1,ke),t===void 0?t=i.rounding:Nt(t,0,8),r=Q(new i(r),e,t),n=ne(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};x.toSignificantDigits=x.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Nt(e,1,ke),t===void 0?t=r.rounding:Nt(t,0,8)),Q(new r(n),e,t)};x.toString=function(){var e=this,t=e.constructor,n=ne(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};x.truncated=x.trunc=function(){return Q(new this.constructor(this),this.e+1,1)};x.valueOf=x.toJSON=function(){var e=this,t=e.constructor,n=ne(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function Ot(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)r=e[t]+"",n=K-r.length,n&&(s+=fe(n)),s+=r;o=e[t],r=o+"",n=K-r.length,n&&(s+=fe(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}function Nt(e,t,n){if(e!==~~e||e<t||e>n)throw Error(he+e)}function nn(e,t,n,r){var i,s,o,a;for(s=e[0];s>=10;s/=10)--t;return--t<0?(t+=K,i=0):(i=Math.ceil((t+1)/K),t%=K),s=vt(10,K-t),a=e[i]%s|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),o=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):o=(n<4&&a+1==s||n>3&&a+1==s/2)&&(e[i+1]/s/100|0)==vt(10,t-2)-1||(a==s/2||a==0)&&(e[i+1]/s/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),o=(r||n<4)&&a==9999||!r&&n>3&&a==4999):o=((r||n<4)&&a+1==s||!r&&n>3&&a+1==s/2)&&(e[i+1]/s/1e3|0)==vt(10,t-3)-1,o}function hn(e,t,n){for(var r,i=[0],s,o=0,a=e.length;o<a;){for(s=i.length;s--;)i[s]*=t;for(i[0]+=tr.indexOf(e.charAt(o++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function eo(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/Cn(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=ze(e,1,t.times(i),new e(1));for(var s=n;s--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}var pt=(function(){function e(r,i,s){var o,a=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+a,r[u]=o%s|0,a=o/s|0;return a&&r.unshift(a),r}function t(r,i,s,o){var a,u;if(s!=o)u=s>o?1:-1;else for(a=u=0;a<s;a++)if(r[a]!=i[a]){u=r[a]>i[a]?1:-1;break}return u}function n(r,i,s,o){for(var a=0;s--;)r[s]-=a,a=r[s]<i[s]?1:0,r[s]=a*o+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o,a,u){var c,l,d,f,m,p,g,k,A,h,w,T,b,v,S,P,O,L,_,W,D=r.constructor,et=r.s==i.s?1:-1,G=r.d,H=i.d;if(!G||!G[0]||!H||!H[0])return new D(!r.s||!i.s||(G?H&&G[0]==H[0]:!H)?NaN:G&&G[0]==0||!H?et*0:et/0);for(u?(m=1,l=r.e-i.e):(u=zt,m=K,l=Rt(r.e/m)-Rt(i.e/m)),_=H.length,O=G.length,A=new D(et),h=A.d=[],d=0;H[d]==(G[d]||0);d++);if(H[d]>(G[d]||0)&&l--,s==null?(v=s=D.precision,o=D.rounding):a?v=s+(r.e-i.e)+1:v=s,v<0)h.push(1),p=!0;else{if(v=v/m+2|0,d=0,_==1){for(f=0,H=H[0],v++;(d<O||f)&&v--;d++)S=f*u+(G[d]||0),h[d]=S/H|0,f=S%H|0;p=f||d<O}else{for(f=u/(H[0]+1)|0,f>1&&(H=e(H,f,u),G=e(G,f,u),_=H.length,O=G.length),P=_,w=G.slice(0,_),T=w.length;T<_;)w[T++]=0;W=H.slice(),W.unshift(0),L=H[0],H[1]>=u/2&&++L;do f=0,c=t(H,w,_,T),c<0?(b=w[0],_!=T&&(b=b*u+(w[1]||0)),f=b/L|0,f>1?(f>=u&&(f=u-1),g=e(H,f,u),k=g.length,T=w.length,c=t(g,w,k,T),c==1&&(f--,n(g,_<k?W:H,k,u))):(f==0&&(c=f=1),g=H.slice()),k=g.length,k<T&&g.unshift(0),n(w,g,T,u),c==-1&&(T=w.length,c=t(H,w,_,T),c<1&&(f++,n(w,_<T?W:H,T,u))),T=w.length):c===0&&(f++,w=[0]),h[d++]=f,c&&w[0]?w[T++]=G[P]||0:(w=[G[P]],T=1);while((P++<O||w[0]!==void 0)&&v--);p=w[0]!==void 0}h[0]||h.shift()}if(m==1)A.e=l,Ri=p;else{for(d=1,f=h[0];f>=10;f/=10)d++;A.e=d+l*m-1,Q(A,a?s+A.e+1:s,o,p)}return A}})();function Q(e,t,n,r){var i,s,o,a,u,c,l,d,f,m=e.constructor;t:if(t!=null){if(d=e.d,!d)return e;for(i=1,a=d[0];a>=10;a/=10)i++;if(s=t-i,s<0)s+=K,o=t,l=d[f=0],u=l/vt(10,i-o-1)%10|0;else if(f=Math.ceil((s+1)/K),a=d.length,f>=a)if(r){for(;a++<=f;)d.push(0);l=u=0,i=1,s%=K,o=s-K+1}else break t;else{for(l=a=d[f],i=1;a>=10;a/=10)i++;s%=K,o=s-K+i,u=o<0?0:l/vt(10,i-o-1)%10|0}if(r=r||t<0||d[f+1]!==void 0||(o<0?l:l%vt(10,i-o-1)),c=n<4?(u||r)&&(n==0||n==(e.s<0?3:2)):u>5||u==5&&(n==4||r||n==6&&(s>0?o>0?l/vt(10,i-o):0:d[f-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,c?(t-=e.e+1,d[0]=vt(10,(K-t%K)%K),e.e=-t||0):d[0]=e.e=0,e;if(s==0?(d.length=f,a=1,f--):(d.length=f+1,a=vt(10,K-s),d[f]=o>0?(l/vt(10,i-o)%vt(10,o)|0)*a:0),c)for(;;)if(f==0){for(s=1,o=d[0];o>=10;o/=10)s++;for(o=d[0]+=a,a=1;o>=10;o/=10)a++;s!=a&&(e.e++,d[0]==zt&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=zt)break;d[f--]=0,a=1}for(s=d.length;d[--s]===0;)d.pop()}return tt&&(e.e>m.maxE?(e.d=null,e.e=NaN):e.e<m.minE&&(e.e=0,e.d=[0])),e}function ne(e,t,n){if(!e.isFinite())return Di(e);var r,i=e.e,s=Ot(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+fe(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):i<0?(s="0."+fe(-i-1)+s,n&&(r=n-o)>0&&(s+=fe(r))):i>=o?(s+=fe(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+fe(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=fe(r))),s}function Nn(e,t){var n=e[0];for(t*=K;n>=10;n/=10)t++;return t}function Bn(e,t,n){if(t>to)throw tt=!0,n&&(e.precision=n),Error(xi);return Q(new e(vn),t,1,!0)}function Kt(e,t,n){if(t>nr)throw Error(xi);return Q(new e(In),t,n,!0)}function Ci(e){var t=e.length-1,n=t*K+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function fe(e){for(var t="";e--;)t+="0";return t}function Fi(e,t,n,r){var i,s=new e(1),o=Math.ceil(r/K+4);for(tt=!1;;){if(n%2&&(s=s.times(t),Wr(s.d,o)&&(i=!0)),n=Rt(n/2),n===0){n=s.d.length-1,i&&s.d[n]===0&&++s.d[n];break}t=t.times(t),Wr(t.d,o)}return tt=!0,s}function Fr(e){return e.d[e.d.length-1]&1}function Wi(e,t,n){for(var r,i,s=new e(t[0]),o=0;++o<t.length;){if(i=new e(t[o]),!i.s){s=i;break}r=s.cmp(i),(r===n||r===0&&s.s===n)&&(s=i)}return s}function rr(e,t){var n,r,i,s,o,a,u,c=0,l=0,d=0,f=e.constructor,m=f.rounding,p=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(t==null?(tt=!1,u=p):u=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(r=Math.log(vt(2,d))/Math.LN10*2+5|0,u+=r,n=s=o=new f(1),f.precision=u;;){if(s=Q(s.times(e),u,1),n=n.times(++l),a=o.plus(pt(s,n,u,1)),Ot(a.d).slice(0,u)===Ot(o.d).slice(0,u)){for(i=d;i--;)o=Q(o.times(o),u,1);if(t==null)if(c<3&&nn(o.d,u-r,m,c))f.precision=u+=10,n=s=a=new f(1),l=0,c++;else return Q(o,f.precision=p,m,tt=!0);else return f.precision=p,o}o=a}}function Ae(e,t){var n,r,i,s,o,a,u,c,l,d,f,m=1,p=10,g=e,k=g.d,A=g.constructor,h=A.rounding,w=A.precision;if(g.s<0||!k||!k[0]||!g.e&&k[0]==1&&k.length==1)return new A(k&&!k[0]?-1/0:g.s!=1?NaN:k?0:g);if(t==null?(tt=!1,l=w):l=t,A.precision=l+=p,n=Ot(k),r=n.charAt(0),Math.abs(s=g.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=Ot(g.d),r=n.charAt(0),m++;s=g.e,r>1?(g=new A("0."+n),s++):g=new A(r+"."+n.slice(1))}else return c=Bn(A,l+2,w).times(s+""),g=Ae(new A(r+"."+n.slice(1)),l-p).plus(c),A.precision=w,t==null?Q(g,w,h,tt=!0):g;for(d=g,u=o=g=pt(g.minus(1),g.plus(1),l,1),f=Q(g.times(g),l,1),i=3;;){if(o=Q(o.times(f),l,1),c=u.plus(pt(o,new A(i),l,1)),Ot(c.d).slice(0,l)===Ot(u.d).slice(0,l))if(u=u.times(2),s!==0&&(u=u.plus(Bn(A,l+2,w).times(s+""))),u=pt(u,new A(m),l,1),t==null)if(nn(u.d,l-p,h,a))A.precision=l+=p,c=o=g=pt(d.minus(1),d.plus(1),l,1),f=Q(g.times(g),l,1),i=a=1;else return Q(u,A.precision=w,h,tt=!0);else return A.precision=w,u;u=c,i+=2}}function Di(e){return String(e.s*e.s/0)}function wn(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%K,n<0&&(r+=K),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=K;r<i;)e.d.push(+t.slice(r,r+=K));t=t.slice(r),r=K-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),tt&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function no(e,t){var n,r,i,s,o,a,u,c,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Ni.test(t))return wn(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if($s.test(t))n=16,t=t.toLowerCase();else if(Zs.test(t))n=2;else if(Ks.test(t))n=8;else throw Error(he+t);for(s=t.search(/p/i),s>0?(u=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),s=t.indexOf("."),o=s>=0,r=e.constructor,o&&(t=t.replace(".",""),a=t.length,s=a-s,i=Fi(r,new r(n),s,s*2)),c=hn(t,n,zt),l=c.length-1,s=l;c[s]===0;--s)c.pop();return s<0?new r(e.s*0):(e.e=Nn(c,l),e.d=c,tt=!1,o&&(e=pt(e,i,a*4)),u&&(e=e.times(Math.abs(u)<54?vt(2,u):j.pow(2,u))),tt=!0,e)}function ro(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:ze(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Cn(5,n)),t=ze(e,2,t,t);for(var i,s=new e(5),o=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(s.plus(i.times(o.times(i).minus(a))));return t}function ze(e,t,n,r,i){var s,o,a,u,c=e.precision,l=Math.ceil(c/K);for(tt=!1,u=n.times(n),a=new e(r);;){if(o=pt(a.times(u),new e(t++*t++),c,1),a=i?r.plus(o):r.minus(o),r=pt(o.times(u),new e(t++*t++),c,1),o=a.plus(r),o.d[l]!==void 0){for(s=l;o.d[s]===a.d[s]&&s--;);if(s==-1)break}s=a,a=r,r=o,o=s}return tt=!0,o.d.length=l+1,o}function Cn(e,t){for(var n=e;--t;)n*=e;return n}function Ui(e,t){var n,r=t.s<0,i=Kt(e,e.precision,1),s=i.times(.5);if(t=t.abs(),t.lte(s))return ae=r?4:1,t;if(n=t.divToInt(i),n.isZero())ae=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(s))return ae=Fr(n)?r?2:3:r?4:1,t;ae=Fr(n)?r?1:4:r?3:2}return t.minus(i).abs()}function wr(e,t,n,r){var i,s,o,a,u,c,l,d,f,m=e.constructor,p=n!==void 0;if(p?(Nt(n,1,ke),r===void 0?r=m.rounding:Nt(r,0,8)):(n=m.precision,r=m.rounding),!e.isFinite())l=Di(e);else{for(l=ne(e),o=l.indexOf("."),p?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,o>=0&&(l=l.replace(".",""),f=new m(1),f.e=l.length-o,f.d=hn(ne(f),10,i),f.e=f.d.length),d=hn(l,10,i),s=u=d.length;d[--u]==0;)d.pop();if(!d[0])l=p?"0p+0":"0";else{if(o<0?s--:(e=new m(e),e.d=d,e.e=s,e=pt(e,f,n,r,0,i),d=e.d,s=e.e,c=Ri),o=d[n],a=i/2,c=c||d[n+1]!==void 0,c=r<4?(o!==void 0||c)&&(r===0||r===(e.s<0?3:2)):o>a||o===a&&(r===4||c||r===6&&d[n-1]&1||r===(e.s<0?8:7)),d.length=n,c)for(;++d[--n]>i-1;)d[n]=0,n||(++s,d.unshift(1));for(u=d.length;!d[u-1];--u);for(o=0,l="";o<u;o++)l+=tr.charAt(d[o]);if(p){if(u>1)if(t==16||t==8){for(o=t==16?4:3,--u;u%o;u++)l+="0";for(d=hn(l,i,t),u=d.length;!d[u-1];--u);for(o=1,l="1.";o<u;o++)l+=tr.charAt(d[o])}else l=l.charAt(0)+"."+l.slice(1);l=l+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)l="0"+l;l="0."+l}else if(++s>u)for(s-=u;s--;)l+="0";else s<u&&(l=l.slice(0,s)+"."+l.slice(s))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Wr(e,t){if(e.length>t)return e.length=t,!0}function io(e){return new this(e).abs()}function so(e){return new this(e).acos()}function oo(e){return new this(e).acosh()}function ao(e,t){return new this(e).plus(t)}function co(e){return new this(e).asin()}function uo(e){return new this(e).asinh()}function lo(e){return new this(e).atan()}function mo(e){return new this(e).atanh()}function fo(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,s=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=Kt(this,s,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?Kt(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=Kt(this,s,1).times(.5),n.s=e.s):t.s<0?(this.precision=s,this.rounding=1,n=this.atan(pt(e,t,s,1)),t=Kt(this,s,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(pt(e,t,s,1)),n}function po(e){return new this(e).cbrt()}function go(e){return Q(e=new this(e),e.e+1,2)}function Ao(e,t,n){return new this(e).clamp(t,n)}function ho(e){if(!e||typeof e!="object")throw Error(qn+"Object expected");var t,n,r,i=e.defaults===!0,s=["precision",1,ke,"rounding",0,8,"toExpNeg",-De,0,"toExpPos",0,De,"maxE",0,De,"minE",-De,0,"modulo",0,9];for(t=0;t<s.length;t+=3)if(n=s[t],i&&(this[n]=er[n]),(r=e[n])!==void 0)if(Rt(r)===r&&r>=s[t+1]&&r<=s[t+2])this[n]=r;else throw Error(he+n+": "+r);if(n="crypto",i&&(this[n]=er[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Mi);else this[n]=!1;else throw Error(he+n+": "+r);return this}function wo(e){return new this(e).cos()}function ko(e){return new this(e).cosh()}function Vi(e){var t,n,r;function i(s){var o,a,u,c=this;if(!(c instanceof i))return new i(s);if(c.constructor=i,Dr(s)){c.s=s.s,tt?!s.d||s.e>i.maxE?(c.e=NaN,c.d=null):s.e<i.minE?(c.e=0,c.d=[0]):(c.e=s.e,c.d=s.d.slice()):(c.e=s.e,c.d=s.d?s.d.slice():s.d);return}if(u=typeof s,u==="number"){if(s===0){c.s=1/s<0?-1:1,c.e=0,c.d=[0];return}if(s<0?(s=-s,c.s=-1):c.s=1,s===~~s&&s<1e7){for(o=0,a=s;a>=10;a/=10)o++;tt?o>i.maxE?(c.e=NaN,c.d=null):o<i.minE?(c.e=0,c.d=[0]):(c.e=o,c.d=[s]):(c.e=o,c.d=[s]);return}if(s*0!==0){s||(c.s=NaN),c.e=NaN,c.d=null;return}return wn(c,s.toString())}if(u==="string")return(a=s.charCodeAt(0))===45?(s=s.slice(1),c.s=-1):(a===43&&(s=s.slice(1)),c.s=1),Ni.test(s)?wn(c,s):no(c,s);if(u==="bigint")return s<0?(s=-s,c.s=-1):c.s=1,wn(c,s.toString());throw Error(he+s)}if(i.prototype=x,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=ho,i.clone=Vi,i.isDecimal=Dr,i.abs=io,i.acos=so,i.acosh=oo,i.add=ao,i.asin=co,i.asinh=uo,i.atan=lo,i.atanh=mo,i.atan2=fo,i.cbrt=po,i.ceil=go,i.clamp=Ao,i.cos=wo,i.cosh=ko,i.div=yo,i.exp=To,i.floor=bo,i.hypot=So,i.ln=vo,i.log=Io,i.log10=Oo,i.log2=Bo,i.max=_o,i.min=Lo,i.mod=Eo,i.mul=Po,i.pow=Ro,i.random=xo,i.round=Mo,i.sign=qo,i.sin=No,i.sinh=Co,i.sqrt=Fo,i.sub=Wo,i.sum=Do,i.tan=Uo,i.tanh=Vo,i.trunc=Go,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function yo(e,t){return new this(e).div(t)}function To(e){return new this(e).exp()}function bo(e){return Q(e=new this(e),e.e+1,3)}function So(){var e,t,n=new this(0);for(tt=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return tt=!0,new this(1/0);n=t}return tt=!0,n.sqrt()}function Dr(e){return e instanceof j||e&&e.toStringTag===qi||!1}function vo(e){return new this(e).ln()}function Io(e,t){return new this(e).log(t)}function Bo(e){return new this(e).log(2)}function Oo(e){return new this(e).log(10)}function _o(){return Wi(this,arguments,-1)}function Lo(){return Wi(this,arguments,1)}function Eo(e,t){return new this(e).mod(t)}function Po(e,t){return new this(e).mul(t)}function Ro(e,t){return new this(e).pow(t)}function xo(e){var t,n,r,i,s=0,o=new this(1),a=[];if(e===void 0?e=this.precision:Nt(e,1,ke),r=Math.ceil(e/K),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));s<r;)i=t[s],i>=429e7?t[s]=crypto.getRandomValues(new Uint32Array(1))[0]:a[s++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);s<r;)i=t[s]+(t[s+1]<<8)+(t[s+2]<<16)+((t[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,s):(a.push(i%1e7),s+=4);s=r/4}else throw Error(Mi);else for(;s<r;)a[s++]=Math.random()*1e7|0;for(r=a[--s],e%=K,r&&e&&(i=vt(10,K-e),a[s]=(r/i|0)*i);a[s]===0;s--)a.pop();if(s<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=K)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<K&&(n-=K-r)}return o.e=n,o.d=a,o}function Mo(e){return Q(e=new this(e),e.e+1,this.rounding)}function qo(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function No(e){return new this(e).sin()}function Co(e){return new this(e).sinh()}function Fo(e){return new this(e).sqrt()}function Wo(e,t){return new this(e).sub(t)}function Do(){var e=0,t=arguments,n=new this(t[e]);for(tt=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return tt=!0,Q(n,this.precision,this.rounding)}function Uo(e){return new this(e).tan()}function Vo(e){return new this(e).tanh()}function Go(e){return Q(e=new this(e),e.e+1,1)}x[Symbol.for("nodejs.util.inspect.custom")]=x.toString;x[Symbol.toStringTag]="Decimal";var j=x.constructor=Vi(er);vn=new j(vn);In=new j(In);var zo=Object.defineProperty,Xo=Object.defineProperties,Yo=Object.getOwnPropertyDescriptors,Ur=Object.getOwnPropertySymbols,Qo=Object.prototype.hasOwnProperty,Ho=Object.prototype.propertyIsEnumerable,Fe=Math.pow,Vr=(e,t,n)=>t in e?zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Z=(e,t)=>{for(var n in t||(t={}))Qo.call(t,n)&&Vr(e,n,t[n]);if(Ur)for(var n of Ur(t))Ho.call(t,n)&&Vr(e,n,t[n]);return e},yt=(e,t)=>Xo(e,Yo(t)),U=(e,t,n)=>new Promise((r,i)=>{var s=u=>{try{a(n.next(u))}catch(c){i(c)}},o=u=>{try{a(n.throw(u))}catch(c){i(c)}},a=u=>u.done?r(u.value):Promise.resolve(u.value).then(s,o);a((n=n.apply(e,t)).next())});function ir(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function jo(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function Gi(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Zo(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ir(e.outputLen),ir(e.blockLen)}function $o(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ko(e,t){Gi(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var Jo={number:ir,bool:jo,bytes:Gi,hash:Zo,exists:$o,output:Ko},Gn=Jo,zn=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Ht=(e,t)=>e<<32-t|e>>>t,ta=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ta)throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ea(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function zi(e){if(typeof e=="string"&&(e=ea(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}var na=class{clone(){return this._cloneInto()}};function Xi(e){const t=r=>e().update(zi(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ra(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),u=r?4:0,c=r?0:4;e.setUint32(t+u,o,r),e.setUint32(t+c,a,r)}var ia=class extends na{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=zn(this.buffer)}update(e){Gn.exists(this);const{view:t,buffer:n,blockLen:r}=this;e=zi(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o===r){const a=zn(e);for(;r<=i-s;s+=r)this.process(a,s);continue}n.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gn.exists(this),Gn.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>r-s&&(this.process(n,0),s=0);for(let l=s;l<r;l++)t[l]=0;ra(n,r-8,BigInt(this.length*8),i),this.process(n,0);const o=zn(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)o.setUint32(4*l,c[l],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:s,pos:o}=this;return e.length=r,e.pos=o,e.finished=i,e.destroyed=s,r%t&&e.buffer.set(n),e}},sa=(e,t,n)=>e&t^~e&n,oa=(e,t,n)=>e&t^e&n^t&n,aa=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),le=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),de=new Uint32Array(64),Yi=class extends ia{constructor(){super(64,32,8,!1),this.A=le[0]|0,this.B=le[1]|0,this.C=le[2]|0,this.D=le[3]|0,this.E=le[4]|0,this.F=le[5]|0,this.G=le[6]|0,this.H=le[7]|0}get(){const{A:e,B:t,C:n,D:r,E:i,F:s,G:o,H:a}=this;return[e,t,n,r,i,s,o,a]}set(e,t,n,r,i,s,o,a){this.A=e|0,this.B=t|0,this.C=n|0,this.D=r|0,this.E=i|0,this.F=s|0,this.G=o|0,this.H=a|0}process(e,t){for(let l=0;l<16;l++,t+=4)de[l]=e.getUint32(t,!1);for(let l=16;l<64;l++){const d=de[l-15],f=de[l-2],m=Ht(d,7)^Ht(d,18)^d>>>3,p=Ht(f,17)^Ht(f,19)^f>>>10;de[l]=p+de[l-7]+m+de[l-16]|0}let{A:n,B:r,C:i,D:s,E:o,F:a,G:u,H:c}=this;for(let l=0;l<64;l++){const d=Ht(o,6)^Ht(o,11)^Ht(o,25),f=c+d+sa(o,a,u)+aa[l]+de[l]|0,p=(Ht(n,2)^Ht(n,13)^Ht(n,22))+oa(n,r,i)|0;c=u,u=a,a=o,o=s+f|0,s=i,i=r,r=n,n=f+p|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,r,i,s,o,a,u,c)}roundClean(){de.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},ca=class extends Yi{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},ua=Xi(()=>new Yi);Xi(()=>new ca);var Gr="1.1.0-beta.6",zr=!1,Xr=!1,mn={debug:1,default:2,info:2,warning:3,error:4,off:5},Yr={},Xn;function la(){try{const e=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test".normalize(t)!=="test")throw new Error("bad normalize")}catch{e.push(t)}}),e.length)throw new Error("missing "+e.join(", "));if("".normalize("NFD")!=="e")throw new Error("broken implementation")}catch(e){if(e instanceof Error)return e.message}return""}var Qr=la(),Qi=(e=>(e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.OFF="OFF",e))(Qi||{}),Hi=(e=>(e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",e.NETWORK_ERROR="NETWORK_ERROR",e.RPC_ERROR="RPC_ERROR",e.TIMEOUT="TIMEOUT",e.BUFFER_OVERRUN="BUFFER_OVERRUN",e.NUMERIC_FAULT="NUMERIC_FAULT",e.MISSING_NEW="MISSING_NEW",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.MISSING_ARGUMENT="MISSING_ARGUMENT",e.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",e.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",e))(Hi||{}),Hr="0123456789abcdef";function ji(e,t=!1){let n=e;try{if(e instanceof Uint8Array){let r="";for(let i=0;i<e.length;i++)r+=Hr[e[i]>>4],r+=Hr[e[i]&15];n=`Uint8Array(0x${r})`}else if(e instanceof R)n=`PublicKey(${e.toBase58()})`;else if(e instanceof Object&&!t){const r={};Object.entries(e).forEach(([i,s])=>{r[i]=ji(s,!0)}),n=JSON.stringify(r)}else t||(n=JSON.stringify(e))}catch{n=JSON.stringify(e.toString())}return n}var kr=class bt{constructor(t){this.version=Gr,this.moduleName=t}_log(t,n){const r=t.toLowerCase();mn[r]==null&&this.throwArgumentError("invalid log level name","logLevel",t),!((Yr[this.moduleName]||mn.default)>mn[r])&&console.log(...n)}debug(...t){this._log(bt.levels.DEBUG,["[DEBUG]",...t])}info(...t){this._log(bt.levels.INFO,["[INFO]",...t])}warn(...t){this._log(bt.levels.WARNING,["[WARN]",...t])}makeError(t,n,r){if(Xr)return this.makeError("censored error",n,{});n||(n=bt.errors.UNKNOWN_ERROR),r||(r={});const i=[];Object.entries(r).forEach(([a,u])=>{i.push(`${a}=${ji(u)})`)}),i.push(`code=${n}`),i.push(`module=${this.moduleName}`),i.push(`version=${this.version}`);const s=t;i.length&&(t+=" ("+i.join(", ")+")");const o=new Error(t);return o.reason=s,o.code=n,Object.entries(r).forEach(([a,u])=>{o[a]=u}),o}throwError(t,n,r){throw this.makeError(t,n,r)}throwArgumentError(t,n,r){return this.throwError(t,bt.errors.INVALID_ARGUMENT,{argument:n,value:r})}assert(t,n,r,i){t||this.throwError(n,r,i)}assertArgument(t,n,r,i){t||this.throwArgumentError(n,r,i)}checkNormalize(t){Qr&&this.throwError("platform missing String.prototype.normalize",bt.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Qr})}checkSafeUint53(t,n){typeof t=="number"&&(n==null&&(n="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(n,bt.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(n,bt.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,n,r){r?r=": "+r:r="",t<n&&this.throwError("missing argument"+r,bt.errors.MISSING_ARGUMENT,{count:t,expectedCount:n}),t>n&&this.throwError("too many arguments"+r,bt.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:n})}checkNew(t,n){(t===Object||t==null)&&this.throwError("missing new",bt.errors.MISSING_NEW,{name:n.name})}checkAbstract(t,n){t===n?this.throwError("cannot instantiate abstract class "+JSON.stringify(n.name)+" directly; use a sub-class",bt.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):(t===Object||t==null)&&this.throwError("missing new",bt.errors.MISSING_NEW,{name:n.name})}static globalLogger(){return Xn||(Xn=new bt(Gr)),Xn}static setCensorship(t,n){if(!t&&n&&this.globalLogger().throwError("cannot permanently disable censorship",bt.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),zr){if(!t)return;this.globalLogger().throwError("error censorship permanent",bt.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Xr=!!t,zr=!!n}static setLogLevel(t,n){const r=mn[n.toLowerCase()];if(r==null){bt.globalLogger().warn("invalid log level - "+n);return}Yr[t]=r}static from(t){return new bt(t)}};kr.errors=Hi;kr.levels=Qi;var _t=kr,jr=_t.from("common/pubkey"),Pt=Ee.programId,yr=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Ne=new R("SysvarRent111111111111111111111111111111111"),On=new R("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Tr=new R("Sysvar1nstructions1111111111111111111111111");function sr(e){if(e instanceof R)return e;if(typeof e=="string")try{return new R(e)}catch{return jr.throwArgumentError("invalid public key","publicKey",e)}return jr.throwArgumentError("invalid public key","publicKey",e)}function ct(e,t){const[n,r]=R.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}function B(e,t){return{pubkey:e,isWritable:!0,isSigner:t}}function E(e,t){return{pubkey:e,isWritable:!1,isSigner:t}}function Zr(e,t=1,n=[]){const r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}function da(e){const t=[],n=[];return e.microLamports&&(t.push(Or.setComputeUnitPrice({microLamports:e.microLamports})),n.push(9)),e.units&&(t.push(Or.setComputeUnitLimit({units:e.units})),n.push(10)),{address:{},innerTransaction:{instructions:t,signers:[],instructionTypes:n}}}var Dt=_t.from("common/web3");function ce(e,t,n){return U(this,null,function*(){const{batchRequest:r,commitment:i}=Z(Z({},{batchRequest:!1}),n),s=Zr(t,100);let o=new Array(s.length).fill([]);if(r){const a=s.map(l=>({methodName:"getMultipleAccounts",args:e._buildArgs([l.map(f=>f.toBase58())],i,"base64")})),u=Zr(a,10);o=(yield(yield Promise.all(u.map(l=>U(this,null,function*(){return yield e._rpcBatchRequest(l)})))).flat()).map(l=>l.error?Dt.throwError("failed to get info for multiple accounts",_t.errors.RPC_ERROR,{message:l.error.message}):l.result.value.map(d=>{if(d){const{data:f,executable:m,lamports:p,owner:g,rentEpoch:k}=d;return f.length!==2&&f[1]!=="base64"?Dt.throwError("info must be base64 encoded",_t.errors.RPC_ERROR):{data:M.from(f[0],"base64"),executable:m,lamports:p,owner:new R(g),rentEpoch:k}}else return null}))}else try{o=yield Promise.all(s.map(a=>e.getMultipleAccountsInfo(a,i)))}catch(a){if(a instanceof Error)return Dt.throwError("failed to get info for multiple accounts",_t.errors.RPC_ERROR,{message:a.message})}return o.flat()})}function _n(e,t,n){return U(this,null,function*(){const r=yield ce(e,t.map(i=>i.pubkey),n);return t.map((i,s)=>yt(Z({},i),{accountInfo:r[s]}))})}function Zi(e,t){if(e.length<1)return Dt.throwArgumentError("no instructions provided","instructions",e);if(t.length<1)return Dt.throwArgumentError("no signers provided","signers",t);const n=new $n({recentBlockhash:"11111111111111111111111111111111",feePayer:t[0]});n.add(...e);try{return M.from(n.serialize({verifySignatures:!1})).toString("base64").length<$i}catch{return!1}}function ma(e,t,n,r=!0){return U(this,null,function*(){const i=new R("RaydiumSimuLateTransaction11111111111111111"),s=[];let o=new $n;o.feePayer=i;for(const c of t)Zi([...o.instructions,c],[i])||(s.push(o),o=new $n,o.feePayer=i),o.add(c);o.instructions.length>0&&s.push(o);let a=[];try{if(a=yield pa(e,s,r),a.find(c=>c.err!==null))throw Error("rpc simulateTransaction error")}catch(c){if(c instanceof Error)return Dt.throwError("failed to simulate for instructions",_t.errors.RPC_ERROR,{message:c.message})}const u=[];for(const c of a)if(Dt.debug("simulate result:",c),c.logs){const l=c.logs.filter(d=>d&&d.includes(n));Dt.debug("filteredLog:",u),Dt.assertArgument(l.length!==0,"simulate log not match keyword","keyword",n),u.push(...l)}return u})}function fa(e,t){const n=e.match(/{["\w:,]+}/g);return!n||n.length!==1?Dt.throwArgumentError("simulate log fail to match json","keyword",t):n[0]}function me(e,t){const r=new RegExp(`"${t}":(\\d+)`,"g").exec(e);return!r||r.length!==2?Dt.throwArgumentError("simulate log fail to match key","key",t):r[1]}function pa(e,t,n){return U(this,null,function*(){let r=[];if(n){const i=yield e.getLatestBlockhash(),s=[];for(const c of t){c.recentBlockhash=i.blockhash,c.lastValidBlockHeight=i.lastValidBlockHeight;const d=c._compile().serialize(),m=c._serialize(d).toString("base64");s.push(m)}const o=s.map(c=>({methodName:"simulateTransaction",args:e._buildArgs([c],void 0,"base64")})),a=[],u=20;for(let c=0;c<Math.ceil(o.length/u);c++)a.push(o.slice(c*u,(c+1)*u));r=yield(yield Promise.all(a.map(c=>U(this,null,function*(){return(yield e._rpcBatchRequest(c)).map(d=>d.result.value)})))).flat()}else try{r=yield Promise.all(t.map(i=>U(this,null,function*(){return yield(yield e.simulateTransaction(i)).value})))}catch(i){if(i instanceof Error)return Dt.throwError("failed to get info for multiple accounts",_t.errors.RPC_ERROR,{message:i.message})}return r})}function at(e){return U(this,arguments,function*({connection:t,makeTxVersion:n,innerTransaction:r,lookupTableCache:i,computeBudgetConfig:s,payer:o}){const a=i??{},u=[...new Set(r.map(p=>{var g;return((g=p.lookupTableAddress)!=null?g:[]).map(k=>k.toString())}).flat())],c=[];for(const p of u)a[p]===void 0&&c.push(new R(p));const l=yield ha({connection:t,address:c});for(const[p,g]of Object.entries(l))a[p]=g;const d=s?da(s).innerTransaction:void 0,f=[];let m=[];for(const p of r){if(p.instructions.length===0)continue;const g=[...m,p],k=d?[d,...g]:g;if(m.length<12&&(fn({makeTxVersion:n,innerIns:k,payer:o,lookupTableAddressAccount:a})||fn({makeTxVersion:n,innerIns:g,payer:o,lookupTableAddressAccount:a})))m.push(p);else{if(m.length===0)throw Error(" item ins too big ");let A;if(n===0){A={};for(const h of[...new Set(m.map(w=>{var T;return(T=w.lookupTableAddress)!=null?T:[]}).flat().map(w=>w.toString()))])a[h]!==void 0&&(A[h]=a[h])}if(fn({makeTxVersion:n,innerIns:d?[d,...m]:m,payer:o,lookupTableAddressAccount:a})){const h=d?[d,...m]:m;f.push({instructionTypes:h.map(w=>w.instructionTypes).flat(),instructions:h.map(w=>w.instructions).flat(),signers:m.map(w=>w.signers).flat(),lookupTableAddress:A})}else f.push({instructionTypes:m.map(h=>h.instructionTypes).flat(),instructions:m.map(h=>h.instructions).flat(),signers:m.map(h=>h.signers).flat(),lookupTableAddress:A});m=[p]}}if(m.length>0){let p;if(n===0){p={};for(const g of[...new Set(m.map(k=>{var A;return(A=k.lookupTableAddress)!=null?A:[]}).flat().map(k=>k.toString()))])a[g]!==void 0&&(p[g]=a[g])}if(fn({makeTxVersion:n,innerIns:d?[d,...m]:m,payer:o,lookupTableAddressAccount:a})){const g=d?[d,...m]:m;f.push({instructionTypes:g.map(k=>k.instructionTypes).flat(),instructions:g.map(k=>k.instructions).flat(),signers:m.map(k=>k.signers).flat(),lookupTableAddress:p})}else f.push({instructionTypes:m.map(g=>g.instructionTypes).flat(),instructions:m.map(g=>g.instructions).flat(),signers:m.map(g=>g.signers).flat(),lookupTableAddress:p})}return f})}function fn({makeTxVersion:e,innerIns:t,payer:n,lookupTableAddressAccount:r}){const i=t.map(c=>c.instructions).flat(),s=[...new Set(t.map(c=>c.signers).flat().map(c=>c.publicKey.toString()))].map(c=>new R(c)),o=t.map(c=>{var l;return(l=c.lookupTableAddress)!=null?l:[]}).flat().map(c=>c.toString()),a={},u=r??{};for(const c of o)u[c]!==void 0&&(a[c]=u[c]);return e===0?Aa({instructions:i,payer:n,lookupTableAddressAccount:a}):ga({instructions:i,payer:n,signers:s})}var $i=1644;function ga({instructions:e,payer:t,signers:n}){return Zi(e,[t,...n])}function Aa({instructions:e,payer:t,lookupTableAddressAccount:n}){const i=new ks({payerKey:t,recentBlockhash:bn.generate().publicKey.toString(),instructions:e}).compileToV0Message(Object.values(n??{}));try{return M.from(i.serialize()).toString("base64").length<$i}catch{return!1}}function ha(e){return U(this,arguments,function*({connection:t,address:n}){const r=yield ce(t,[...new Set(n.map(s=>s.toString()))].map(s=>new R(s))),i={};for(let s=0;s<n.length;s++){const o=r[s],a=n[s];o&&(i[a.toString()]=new Sn({key:a,state:Sn.deserialize(o.data)}))}return i})}var Y=new I(0),gt=new I(1);new I(2);new I(3);new I(5);var Ln=new I(10),wa=new I(100);new I(1e3);new I(1e4);var pn=_t.from("entity/bignumber"),$r=9007199254740991;function X(e){return e instanceof I?e:typeof e=="string"?e.match(/^-?[0-9]+$/)?new I(e):pn.throwArgumentError("invalid BigNumberish string","value",e):typeof e=="number"?e%1?pn.throwArgumentError("BigNumberish number underflow","value",e):e>=$r||e<=-$r?pn.throwArgumentError("BigNumberish number overflow","value",e):new I(String(e)):typeof e=="bigint"?new I(e.toString()):pn.throwArgumentError("invalid BigNumberish value","value",e)}function Kr(e){return Ln.pow(X(e))}function Yn(e,t){const n=e.divmod(t);return n.mod.isZero()?n.div:n.div.isNeg()?n.div.isubn(1):n.div.iaddn(1)}var Ke={symbol:"SOL",name:"Solana",decimals:9},Wt={symbol:"WSOL",name:"Wrapped SOL",mint:"So11111111111111111111111111111111111111112",decimals:9,extensions:{coingeckoId:"solana"}};Z({},Wt);var Jr={WSOL:Z({},Wt)};Jr.WSOL.decimals,Jr.WSOL.decimals;Z({},Wt);var or=class{constructor(t,n="UNKNOWN",r="UNKNOWN"){this.decimals=t,this.symbol=n,this.name=r}};or.SOL=new or(Ke.decimals,Ke.symbol,Ke.name);var rn=or,ar=class extends rn{constructor(t,n,r,i="UNKNOWN",s="UNKNOWN"){super(r,i,s),this.programId=sr(t),this.mint=sr(n)}equals(t){return this===t?!0:this.mint.equals(t.mint)}};ar.WSOL=new ar(N,Wt.mint,Wt.decimals,Ke.symbol,Ke.name);var C=ar;function ve(e,t){return e instanceof C&&t instanceof C?e.equals(t):e instanceof C||t instanceof C?!1:e===t}var ka=js,br=ka,gn=_t.from("entity/fraction"),Ve=br(Pi),Je=br(ws),ya={0:Je.ROUND_DOWN,1:Je.ROUND_HALF_UP,2:Je.ROUND_UP},Ta={0:Ve.roundDown,1:Ve.roundHalfUp,2:Ve.roundUp},Ge=class Lt{constructor(t,n=gt){this.numerator=X(t),this.denominator=X(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new Lt(this.denominator,this.numerator)}add(t){const n=t instanceof Lt?t:new Lt(X(t));return this.denominator.eq(n.denominator)?new Lt(this.numerator.add(n.numerator),this.denominator):new Lt(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){const n=t instanceof Lt?t:new Lt(X(t));return this.denominator.eq(n.denominator)?new Lt(this.numerator.sub(n.numerator),this.denominator):new Lt(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){const n=t instanceof Lt?t:new Lt(X(t));return new Lt(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){const n=t instanceof Lt?t:new Lt(X(t));return new Lt(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){gn.assert(Number.isInteger(t),`${t} is not an integer.`),gn.assert(t>0,`${t} is not positive.`),Je.set({precision:t+1,rounding:ya[r]});const i=new Je(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return gn.assert(Number.isInteger(t),`${t} is not an integer.`),gn.assert(t>=0,`${t} is negative.`),Ve.DP=t,Ve.RM=Ta[r],new Ve(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}},ge=_t.from("entity/amount"),ti=br(Pi);function ba(e,t){let n="0",r="0";if(e.includes(".")){const i=e.split(".");if(i.length===2)[n,r]=i,r=r.padEnd(t,"0");else return ge.throwArgumentError("invalid number string","num",e)}else n=e;return[n,r.slice(0,t)||r]}var xt=class cr extends Ge{constructor(t,n,r=!0){let i=new I(0);const s=Ln.pow(new I(t.decimals));if(r)i=X(n);else{let o=new I(0),a=new I(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){const[u,c]=ba(n.toString(),t.decimals);o=X(u),a=X(c)}o=o.mul(s),i=o.add(a)}super(i,s),this.currency=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return ge.assert(ve(this.currency,t.currency),"gt currency not equals"),this.raw.gt(t.raw)}lt(t){return ge.assert(ve(this.currency,t.currency),"lt currency not equals"),this.raw.lt(t.raw)}add(t){return ge.assert(ve(this.currency,t.currency),"add currency not equals"),new cr(this.currency,this.raw.add(t.raw))}sub(t){return ge.assert(ve(this.currency,t.currency),"sub currency not equals"),new cr(this.currency,this.raw.sub(t.raw))}toSignificant(t=this.currency.decimals,n,r=0){return super.toSignificant(t,n,r)}toFixed(t=this.currency.decimals,n,r=0){return ge.assert(t<=this.currency.decimals,"decimals overflow"),super.toFixed(t,n,r)}toExact(t={groupSeparator:""}){return ti.DP=this.currency.decimals,new ti(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}},ft=class ur extends xt{constructor(t,n,r=!0){super(t,n,r),this.token=t}add(t){return ge.assert(ve(this.token,t.token),"add token not equals"),new ur(this.token,this.raw.add(t.raw))}subtract(t){return ge.assert(ve(this.token,t.token),"sub token not equals"),new ur(this.token,this.raw.sub(t.raw))}},ei=new Ge(wa),Oe=class extends Ge{toSignificant(e=5,t,n){return this.mul(ei).toSignificant(e,t,n)}toFixed(e=2,t,n){return this.mul(ei).toFixed(e,t,n)}},Sa=_t.from("entity/price"),$t=class lr extends Ge{constructor(t,n,r,i){super(i,n),this.baseCurrency=t,this.quoteCurrency=r,this.scalar=new Ge(Kr(t.decimals),Kr(r.decimals))}get raw(){return new Ge(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new lr(this.quoteCurrency,this.numerator,this.baseCurrency,this.denominator)}mul(t){Sa.assert(ve(this.quoteCurrency,t.baseCurrency),"mul currency not equals");const n=super.mul(t);return new lr(this.baseCurrency,n.denominator,t.quoteCurrency,n.numerator)}toSignificant(t=this.quoteCurrency.decimals,n,r){return this.adjusted.toSignificant(t,n,r)}toFixed(t=this.quoteCurrency.decimals,n,r){return this.adjusted.toFixed(t,n,r)}},Sr=it.Layout,va=it.Structure,Ki=it.UInt,Ia=it.u8,tn=it.u16,ni=it.u32,Mt=it.s32,Ba=it.seq,Tt=it.blob,ri=it.bits,cn=class extends Sr{constructor(e,t,n){super(e,n),this.blob=Tt(e),this.signed=t}decode(e,t=0){const n=new I(this.blob.decode(e,t),10,"le");return this.signed?n.fromTwos(this.span*8).clone():n}encode(e,t,n=0){return typeof e=="number"&&(e=new I(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(M,"le",this.span),t,n)}},Oa=class extends Sr{constructor(e){super(8,e),this._lower=ri(ni(),!1),this._upper=ri(ni(),!1)}addBoolean(e){this._lower.fields.length<32?this._lower.addBoolean(e):this._upper.addBoolean(e)}decode(e,t=0){const n=this._lower.decode(e,t),r=this._upper.decode(e,t+this._lower.span);return Z(Z({},n),r)}encode(e,t,n=0){return this._lower.encode(e,t,n)+this._upper.encode(e,t,n+this._lower.span)}};function V(e){return new Ki(1,e)}function Ut(e){return new Ki(4,e)}function y(e){return new cn(8,!1,e)}function J(e){return new cn(16,!1,e)}function _a(e){return new cn(1,!0,e)}function dr(e){return new cn(8,!0,e)}function La(e){return new cn(16,!0,e)}var Ji=class extends Sr{constructor(e,t,n,r){super(e.span,r),this.layout=e,this.decoder=t,this.encoder=n}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,n){return this.layout.encode(this.encoder(e),t,n)}getSpan(e,t){return this.layout.getSpan(e,t)}};function q(e){return new Ji(Tt(32),t=>new R(t),t=>t.toBuffer(),e)}function Yt(e){return new Ji(Ia(),Ea,Pa,e)}function Ea(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function Pa(e){return e?1:0}var Ra=class extends va{decode(e,t){return super.decode(e,t)}};function F(e,t,n){return new Ra(e,t,n)}function $(e,t,n){let r;const i=typeof t=="number"?t:Br.isBN(t)?t.toNumber():new Proxy(t,{get(s,o){if(!r){const a=Reflect.get(s,"count");r=Br.isBN(a)?a.toNumber():a,Reflect.set(s,"count",r)}return Reflect.get(s,o)},set(s,o,a){return o==="count"&&(r=a),Reflect.set(s,o,a)}});return Ba(e,i,n)}var au=F([Ut("mintAuthorityOption"),q("mintAuthority"),y("supply"),V("decimals"),V("isInitialized"),Ut("freezeAuthorityOption"),q("freezeAuthority")]),Zt=F([q("mint"),q("owner"),y("amount"),Ut("delegateOption"),q("delegate"),V("state"),Ut("isNativeOption"),y("isNative"),y("delegatedAmount"),Ut("closeAuthorityOption"),q("closeAuthority")]);function St(e,t,n){return ct([e.toBuffer(),n.toBuffer(),t.toBuffer()],new R("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}var mt=class{static getAssociatedTokenAccount({mint:e,owner:t,programId:n}){return St(t,e,n).publicKey}static makeCreateAssociatedTokenAccountInstruction({programId:e,mint:t,associatedAccount:n,owner:r,payer:i,instructionsType:s}){return s.push(2),Ms(i,n,r,t,e)}static makeCreateWrappedNativeAccountInstructions(e){return U(this,arguments,function*({connection:t,owner:n,payer:r,amount:i,commitment:s}){const o=[],a=[],u=yield t.getMinimumBalanceForRentExemption(Zt.span,s),c=X(i).add(new I(u)),l=sn({fromPublicKey:r,programId:N});return o.push(Ee.createAccountWithSeed({fromPubkey:r,basePubkey:r,seed:l.seed,newAccountPubkey:l.publicKey,lamports:c.toNumber(),space:Zt.span,programId:N})),a.push(0),o.push(this.makeInitAccountInstruction({programId:N,mint:sr(Wt.mint),tokenAccount:l.publicKey,owner:n,instructionTypes:a})),{address:{newAccount:l.publicKey},innerTransaction:{instructions:o,signers:[],lookupTableAddress:[],instructionTypes:a}}})}static insertCreateWrappedNativeAccount(e){return U(this,arguments,function*({connection:t,owner:n,payer:r,amount:i,instructions:s,instructionsType:o,signers:a,commitment:u}){const c=yield this.makeCreateWrappedNativeAccountInstructions({connection:t,owner:n,payer:r,amount:i,commitment:u});return s.push(...c.innerTransaction.instructions),a.push(...c.innerTransaction.signers),o.push(...c.innerTransaction.instructionTypes),c.address.newAccount})}static makeInitMintInstruction({programId:e,mint:t,decimals:n,mintAuthority:r,freezeAuthority:i=null,instructionTypes:s}){return s.push(5),Fs(t,n,r,i,e)}static makeMintToInstruction({programId:e,mint:t,dest:n,authority:r,amount:i,multiSigners:s=[],instructionTypes:o}){return o.push(6),Ns(t,n,r,BigInt(String(i)),s,e)}static makeInitAccountInstruction({programId:e,mint:t,tokenAccount:n,owner:r,instructionTypes:i}){return i.push(1),xs(n,t,r,e)}static makeTransferInstruction({programId:e,source:t,destination:n,owner:r,amount:i,multiSigners:s=[],instructionsType:o}){return o.push(4),Cs(t,n,r,BigInt(String(i)),s,e)}static makeCloseAccountInstruction({programId:e,tokenAccount:t,owner:n,payer:r,multiSigners:i=[],instructionsType:s}){return s.push(3),Ss(t,r,n,i,e)}static createInitAccountInstruction(e,t,n,r){const i=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:pe,isSigner:!1,isWritable:!1}],s=V("instruction"),o=M.alloc(s.span);return s.encode(1,o),new nt({keys:i,programId:e,data:o})}},xa=(e=>(e[e.V0=0]="V0",e[e.LEGACY=1]="LEGACY",e))(xa||{}),Fn=class{static _selectTokenAccount(e){const{tokenAccounts:t,programId:n,mint:r,owner:i,config:s}=e,{associatedOnly:o}=Z(Z({},{associatedOnly:!0}),s),a=t.filter(({accountInfo:c})=>c.mint.equals(r)).sort((c,l)=>c.accountInfo.amount.lt(l.accountInfo.amount)?1:-1),u=mt.getAssociatedTokenAccount({mint:r,owner:i,programId:n});for(const c of a){const{pubkey:l}=c;if(o){if(u.equals(l))return l}else return l}return null}static _handleTokenAccount(e){return U(this,null,function*(){const{connection:t,side:n,amount:r,programId:i,mint:s,tokenAccount:o,owner:a,payer:u=a,frontInstructions:c,endInstructions:l,signers:d,bypassAssociatedCheck:f,frontInstructionsType:m,endInstructionsType:p,checkCreateATAOwner:g}=e,k=mt.getAssociatedTokenAccount({mint:s,owner:a,programId:i});if(C.WSOL.mint.equals(s)){const A=yield mt.insertCreateWrappedNativeAccount({connection:t,owner:a,payer:u,instructions:c,instructionsType:m,signers:d,amount:r});return l&&l.push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:A,owner:a,payer:u,instructionsType:p??[]})),A}else if(!o||n==="out"&&!k.equals(o)&&!f){const A=mt.makeCreateAssociatedTokenAccountInstruction({programId:i,mint:s,associatedAccount:k,owner:a,payer:u,instructionsType:m});if(g){const h=yield t.getAccountInfo(k);if(h===null)c.push(A);else if(!(h.owner.equals(N)&&be.decode(h.data).mint.equals(s)&&be.decode(h.data).owner.equals(a)))throw Error(`create ata check error -> mint: ${s.toString()}, ata: ${k.toString()}`)}else c.push(A);return k}return o})}static _selectOrCreateTokenAccount(e){return U(this,null,function*(){var t,n,r,i,s,o,a,u,c,l;const{mint:d,tokenAccounts:f,createInfo:m,associatedOnly:p,owner:g,checkCreateATAOwner:k,programId:A}=e,h=mt.getAssociatedTokenAccount({mint:d,owner:g,programId:A}),w=f.filter(T=>T.accountInfo.mint.equals(d)&&(!p||T.pubkey.equals(h))).sort((T,b)=>T.accountInfo.amount.lt(b.accountInfo.amount)?1:-1);if(m===void 0||w.length>0)return w.length>0?w[0].pubkey:void 0;if(p){const T=mt.makeCreateAssociatedTokenAccountInstruction({programId:A,mint:d,associatedAccount:h,owner:g,payer:m.payer,instructionsType:m.frontInstructionsType});if(k){const b=yield m.connection.getAccountInfo(h);if(b===null)m.frontInstructions.push(T);else if(!(b.owner.equals(A)&&be.decode(b.data).mint.equals(d)&&be.decode(b.data).owner.equals(g)))throw Error(`create ata check error -> mint: ${d.toString()}, ata: ${h.toString()}`)}else m.frontInstructions.push(T);if(d.equals(C.WSOL.mint)&&m.amount){const b=yield mt.insertCreateWrappedNativeAccount({connection:m.connection,owner:g,payer:m.payer,instructions:m.frontInstructions,instructionsType:m.frontInstructionsType,signers:m.signers,amount:(t=m.amount)!=null?t:0});((n=m.endInstructions)!=null?n:[]).push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:b,owner:g,payer:m.payer,instructionsType:(r=m.endInstructionsType)!=null?r:[]})),m.amount&&m.frontInstructions.push(mt.makeTransferInstruction({programId:N,source:b,destination:h,owner:g,amount:m.amount,instructionsType:m.frontInstructionsType}))}return((i=m.endInstructions)!=null?i:[]).push(mt.makeCloseAccountInstruction({programId:A,tokenAccount:h,owner:g,payer:m.payer,instructionsType:(s=m.endInstructionsType)!=null?s:[]})),h}else if(d.equals(C.WSOL.mint)){const T=yield mt.insertCreateWrappedNativeAccount({connection:m.connection,owner:g,payer:m.payer,instructions:m.frontInstructions,instructionsType:m.frontInstructionsType,signers:m.signers,amount:(o=m.amount)!=null?o:0});return((a=m.endInstructions)!=null?a:[]).push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:T,owner:g,payer:m.payer,instructionsType:(u=m.endInstructionsType)!=null?u:[]})),T}else{const T=sn({fromPublicKey:g,programId:A}),b=yield m.connection.getMinimumBalanceForRentExemption(be.span),v=Ee.createAccountWithSeed({fromPubkey:g,basePubkey:g,seed:T.seed,newAccountPubkey:T.publicKey,lamports:b,space:be.span,programId:A}),S=mt.createInitAccountInstruction(A,d,T.publicKey,g);return m.frontInstructions.push(v,S),m.frontInstructionsType.push(0,1),((c=m.endInstructions)!=null?c:[]).push(mt.makeCloseAccountInstruction({programId:A,tokenAccount:T.publicKey,owner:g,payer:m.payer,instructionsType:(l=m.endInstructionsType)!=null?l:[]})),T.publicKey}})}};function sn({fromPublicKey:e,programId:t=N}){const n=bn.generate().publicKey.toBase58().slice(0,32);return{publicKey:Ma(e,n,t),seed:n}}function Ma(e,t,n){const r=M.concat([e.toBuffer(),M.from(t),n.toBuffer()]),i=ua(r);return new R(i)}new Sn({key:new R("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Sn.deserialize(M.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))});var Qe=1e4;function qt(e,t,n,r){if(t===void 0)return{amount:e,fee:void 0,expirationTime:void 0};const i=n.epoch<t.newerTransferFee.epoch?t.olderTransferFee:t.newerTransferFee,s=new I(i.maximumFee.toString()),o=n.epoch<t.newerTransferFee.epoch?(Number(t.newerTransferFee.epoch)*n.slotsInEpoch-n.absoluteSlot)*400/1e3:void 0;if(r)if(i.transferFeeBasisPoints===Qe){const a=new I(i.maximumFee.toString());return{amount:e.add(a),fee:a,expirationTime:o}}else{const a=kn(e.mul(new I(Qe)),new I(Qe-i.transferFeeBasisPoints)),u=new I(i.maximumFee.toString()),c=a.sub(e).gt(u)?e.add(u):a,l=kn(c.mul(new I(i.transferFeeBasisPoints)),new I(Qe)),d=l.gt(s)?s:l;return{amount:c,fee:d,expirationTime:o}}else{const a=kn(e.mul(new I(i.transferFeeBasisPoints)),new I(Qe)),u=a.gt(s)?s:a;return{amount:e,fee:u,expirationTime:o}}}function Qn(e,t){return e===void 0?t:t===void 0?e:Math.min(e,t)}function ii(e){return U(this,arguments,function*({connection:t,mints:n}){var r,i;if(n.length===0)return{};const s=yield _n(t,n.map(a=>({pubkey:a}))),o={};for(const a of s){const u=Os(a.pubkey,a.accountInfo,(r=a.accountInfo)==null?void 0:r.owner);o[a.pubkey.toString()]=yt(Z({},u),{feeConfig:(i=Es(u))!=null?i:void 0})}return o})}function kn(e,t){const{div:n,mod:r}=e.divmod(t);return r.gt(Y)?n.add(gt):n}var un={voterStakeRegistryCreateVoter:M.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:M.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:M.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:M.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:M.from([45,185,3,36,109,190,115,169])};function qa(e,t,n,r,i,s){const o=F([V("ins")]),a=[E(t,!1),E(n,!1),B(s,!1),E(r,!1),B(i,!0),E(Pt,!1)],u=M.alloc(o.span);return o.encode({ins:23},u),new nt({keys:a,programId:e,data:u})}function Na(e,t,n,r,i,s,o,a){const u=F([V("voterBump"),V("voterWeightRecordBump")]),c=[E(t,!1),B(n,!1),E(i,!0),B(r,!1),B(s,!0),E(Pt,!1),E(Ne,!1),E(Tr,!1)],l=M.alloc(u.span);u.encode({voterBump:o,voterWeightRecordBump:a},l);const d=M.from([...un.voterStakeRegistryCreateVoter,...l]);return new nt({keys:c,programId:e,data:d})}function Ca(e,t,n,r,i,s,o,a,u,c,l,d){const f=F([V("depositEntryIndex"),V("kind"),V("option"),y("startTs"),Ut("periods"),Yt("allowClawback")]),m=[E(t,!1),B(n,!1),B(r,!1),E(i,!0),B(s,!0),E(o,!1),E(Pt,!1),E(N,!1),E(Xe,!1),E(Ne,!1)],p=M.alloc(f.span);f.encode({depositEntryIndex:a,kind:u,option:0,startTs:Y,periods:l,allowClawback:d},p);const g=M.from([...un.voterStakeRegistryCreateDepositEntry,...p]);return new nt({keys:m,programId:e,data:g})}function Fa(e,t,n,r,i,s,o,a,u,c,l,d,f){const m=F([V("depositEntryIndex"),y("amount")]),p=[E(t,!1),B(n,!1),B(r,!1),B(i,!1),E(s,!0),E(N,!1),B(o,!1),E(a,!1),B(u,!1),E(c,!1),E(l,!1),E(Tr,!1)],g=M.alloc(m.span);m.encode({depositEntryIndex:d,amount:f},g);const k=M.from([...un.voterStakeRegistryDeposit,...g]);return new nt({keys:p,programId:e,data:k})}function Wa(e,t,n,r){const i=F([]),s=[E(t,!1),E(n,!1),B(r,!1),E(Pt,!1)],o=M.alloc(i.span);i.encode({},o);const a=M.from([...un.voterStakeRegistryUpdateVoterWeightRecord,...o]);return new nt({keys:s,programId:e,data:a})}function Da(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p){const g=F([V("depositEntryIndex"),y("amount")]),k=[E(t,!1),B(n,!1),E(r,!0),E(i,!1),B(s,!1),B(o,!1),B(a,!1),E(N,!1),B(u,!1),E(c,!1),B(l,!1),E(d,!1),E(f,!1),E(Tr,!1)],A=M.alloc(g.span);g.encode({depositEntryIndex:m,amount:p},A);const h=M.from([...un.voterStakeRegistryWithdraw,...A]);return new nt({keys:k,programId:e,data:h})}var ts=F([y("state"),y("nonce"),q("lpVault"),q("rewardVault"),q(),q(),y(),y(),y("totalReward"),J("perShareReward"),y("lastSlot"),y("perSlotReward")]),es=F([y("state"),y("nonce"),q("lpVault"),q("rewardVaultA"),y("totalRewardA"),J("perShareRewardA"),y("perSlotRewardA"),V("option"),q("rewardVaultB"),Tt(7),y("totalRewardB"),J("perShareRewardB"),y("perSlotRewardB"),y("lastSlot"),q()]),Ua=F([y("rewardState"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardLastUpdateTime"),y("totalReward"),y("totalRewardEmissioned"),y("rewardClaimed"),y("rewardPerSecond"),J("accRewardPerShare"),q("rewardVault"),q("rewardMint"),q("rewardSender"),y("rewardType"),$(y(),15,"padding")]),Va=F([y(),y("state"),y("nonce"),y("validRewardTokenNum"),J("rewardMultiplier"),y("rewardPeriodMax"),y("rewardPeriodMin"),y("rewardPeriodExtend"),q("lpMint"),q("lpVault"),$(Ua,5,"rewardInfos"),q("creator"),q(),$(y(),32,"padding")]),Ga=new Proxy(ts,{get(e,t,n){return t==="decode"?(...r)=>{const i=e.decode(...r);return yt(Z({},i),{version:3,rewardInfos:[{rewardVault:i.rewardVault,totalReward:i.totalReward,perSlotReward:i.perSlotReward,perShareReward:i.perShareReward}]})}:Reflect.get(e,t,n)}}),za=new Proxy(es,{get(e,t,n){return t==="decode"?(...r)=>{const i=e.decode(...r);return yt(Z({},i),{version:5,rewardInfos:[{rewardVault:i.rewardVaultA,totalReward:i.totalRewardA,perSlotReward:i.perSlotRewardA,perShareReward:i.perShareRewardA},{rewardVault:i.rewardVaultB,totalReward:i.totalRewardB,perSlotReward:i.perSlotRewardB,perShareReward:i.perShareRewardB}]})}:Reflect.get(e,t,n)}}),je=new Proxy(Va,{get(e,t,n){return t==="decode"?(...r)=>{const i=e.decode(...r);return yt(Z({},i),{version:6,rewardInfos:i.rewardInfos.map(s=>{var o;return yt(Z({},s),{rewardType:((o=Object.entries(We).find(a=>String(a[1])===s.rewardType.toString()))!=null?o:["Standard SPL"])[0]})})})}:Reflect.get(e,t,n)}}),si=F([y("state"),q("id"),q("owner"),y("deposited"),$(y(),1,"rewardDebts")]),yn=F([y("state"),q("id"),q("owner"),y("deposited"),$(J(),1,"rewardDebts"),y(""),y("voteLockedBalance"),$(y(),15)]),oi=F([y("state"),q("id"),q("owner"),y("deposited"),$(y(),2,"rewardDebts")]),ns=F([y("state"),q("id"),q("owner"),y("deposited"),$(J(),2,"rewardDebts"),$(y(),17)]),Xa=F([y(),y("state"),q("id"),q("owner"),y("deposited"),$(J(),5,"rewardDebts"),$(y(),16)]),Ya={3:Ga,5:za,6:je},Qa={3:yn,5:ns,6:Xa},Ha=F([q("mint"),q("grantAuthority"),y("baselineVoteWeightScaledFactor"),y("maxExtraLockupVoteWeightScaledFactor"),y("lockupSaturationSecs"),_a("digitShift"),$(V(),7,"reserved1"),$(y(),7,"reserved2")]),ja=F([Tt(8),q("governanceProgramId"),q("realm"),q("realmGoverningTokenMint"),q("realmAuthority"),$(V(),32,"reserved1"),$(Ha,4,"votingMints"),dr("timeOffset"),V("bump"),$(V(),7,"reserved2"),$(y(),11,"reserved3")]),Za=F([dr("startTime"),dr("endTime"),V("kind"),$(V(),15,"reserved")]),$a=F([$(Za,1,"lockup"),y("amountDeposited_native"),y("amountInitiallyLockedNative"),Yt("isUsed"),Yt("allowClawback"),V("votingMintConfigIdx"),$(V(),29,"reserved")]),Ka=F([Tt(8),q("voterAuthority"),q("registrar"),$($a,32,"deposits"),V("voterBump"),V("voterWweightRecordBump"),$(V(),94,"reserved")]);function ai(e,t,n){return ct([t.toBuffer(),M.from("registrar","utf8"),n.toBuffer()],e)}function ci(e,t){return ct([t.toBuffer(),M.from("voting_mint_seed","utf8")],e)}function ui(e,t){return ct([t.toBuffer()],e)}function li(e,t,n){return ct([t.toBuffer(),M.from("voter","utf8"),n.toBuffer()],e)}function di(e,t,n){return ct([t.toBuffer(),M.from("voter-weight-record","utf8"),n.toBuffer()],e)}function mi(e,t,n,r){return ct([M.from("governance","utf8"),t.toBuffer(),n.toBuffer(),r.toBuffer()],e)}var rt=_t.from("Farm"),We={"Standard SPL":0,"Option tokens":1},fi=class Ft extends Fn{static getStateLayout(t){const n=Ya[t];return rt.assertArgument(!!n,"invalid version","version",t),n}static getLedgerLayout(t){const n=Qa[t];return rt.assertArgument(!!n,"invalid version","version",t),n}static getLayouts(t){return{state:this.getStateLayout(t),ledger:this.getLedgerLayout(t)}}static getAssociatedAuthority({programId:t,poolId:n}){return ct([n.toBuffer()],t)}static getAssociatedLedgerAccount({programId:t,poolId:n,owner:r,version:i}){const{publicKey:s}=ct([n.toBuffer(),r.toBuffer(),M.from(i===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],t);return s}static getAssociatedLedgerPoolAccount({programId:t,poolId:n,mint:r,type:i}){const{publicKey:s}=ct([n.toBuffer(),r.toBuffer(),M.from(i==="lpVault"?"lp_vault_associated_seed":i==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],t);return s}static makeDepositInstruction(t){const{poolKeys:n}=t,{version:r}=n;return r===3?this.makeDepositInstructionV3(t):r===5?this.makeDepositInstructionV5(t):r===6?this.makeDepositInstructionV6(t):rt.throwArgumentError("invalid version","poolKeys.version",r)}static makeDepositInstructionV3({poolKeys:t,userKeys:n,amount:r}){rt.assertArgument(t.rewardInfos.length===1,"lengths not equal 1","poolKeys.rewardInfos",t.rewardInfos),rt.assertArgument(n.rewardTokenAccounts.length===1,"lengths not equal 1","userKeys.rewardTokenAccounts",n.rewardTokenAccounts);const i=F([V("instruction"),y("amount")]),s=M.alloc(i.span);i.encode({instruction:10,amount:X(r)},s);const o=[B(t.id,!1),E(t.authority,!1),B(n.ledger,!1),E(n.owner,!0),B(n.lpTokenAccount,!1),B(t.lpVault,!1),B(n.rewardTokenAccounts[0],!1),B(t.rewardInfos[0].rewardVault,!1),E(dn,!1),E(N,!1)];if(n.auxiliaryLedgers)for(const a of n.auxiliaryLedgers)o.push(B(a,!1));return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:o,data:s})],signers:[],lookupTableAddress:[],instructionTypes:[38]}}}static makeDepositInstructionV5({poolKeys:t,userKeys:n,amount:r}){rt.assertArgument(n.rewardTokenAccounts.length===t.rewardInfos.length,"lengths not equal with poolKeys.rewardInfos","userKeys.rewardTokenAccounts",n.rewardTokenAccounts);const i=F([V("instruction"),y("amount")]),s=M.alloc(i.span);i.encode({instruction:11,amount:X(r)},s);const o=[B(t.id,!1),E(t.authority,!1),B(n.ledger,!1),E(n.owner,!0),B(n.lpTokenAccount,!1),B(t.lpVault,!1),B(n.rewardTokenAccounts[0],!1),B(t.rewardInfos[0].rewardVault,!1),E(dn,!1),E(N,!1)];for(let a=1;a<t.rewardInfos.length;a++)o.push(B(n.rewardTokenAccounts[a],!1)),o.push(B(t.rewardInfos[a].rewardVault,!1));if(n.auxiliaryLedgers)for(const a of n.auxiliaryLedgers)o.push(B(a,!1));return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:o,data:s})],signers:[],lookupTableAddress:[],instructionTypes:[41]}}}static makeDepositInstructionV6({poolKeys:t,userKeys:n,amount:r}){rt.assertArgument(n.rewardTokenAccounts.length!==0,"lengths equal zero","userKeys.rewardTokenAccounts",n.rewardTokenAccounts),rt.assertArgument(n.rewardTokenAccounts.length===t.rewardInfos.length,"lengths not equal with poolKeys.rewardInfos","userKeys.rewardTokenAccounts",n.rewardTokenAccounts);const i=F([V("instruction"),y("amount")]),s=M.alloc(i.span);i.encode({instruction:1,amount:X(r)},s);const o=[E(N,!1),E(Pt,!1),B(t.id,!1),E(t.authority,!1),B(t.lpVault,!1),B(n.ledger,!1),E(n.owner,!0),B(n.lpTokenAccount,!1)];for(let a=0;a<t.rewardInfos.length;a++)o.push(B(t.rewardInfos[a].rewardVault,!1)),o.push(B(n.rewardTokenAccounts[a],!1));return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:o,data:s})],signers:[],lookupTableAddress:[],instructionTypes:[44]}}}static makeWithdrawInstruction(t){const{poolKeys:n}=t,{version:r}=n;return r===3?this.makeWithdrawInstructionV3(t):r===5?this.makeWithdrawInstructionV5(t):r===6?this.makeWithdrawInstructionV6(t):rt.throwArgumentError("invalid version","poolKeys.version",r)}static makeWithdrawInstructionV3({poolKeys:t,userKeys:n,amount:r}){rt.assertArgument(t.rewardInfos.length===1,"lengths not equal 1","poolKeys.rewardInfos",t.rewardInfos),rt.assertArgument(n.rewardTokenAccounts.length===1,"lengths not equal 1","userKeys.rewardTokenAccounts",n.rewardTokenAccounts);const i=F([V("instruction"),y("amount")]),s=M.alloc(i.span);i.encode({instruction:11,amount:X(r)},s);const o=[B(t.id,!1),E(t.authority,!1),B(n.ledger,!1),E(n.owner,!0),B(n.lpTokenAccount,!1),B(t.lpVault,!1),B(n.rewardTokenAccounts[0],!1),B(t.rewardInfos[0].rewardVault,!1),E(dn,!1),E(N,!1)];if(n.auxiliaryLedgers)for(const a of n.auxiliaryLedgers)o.push(B(a,!1));return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:o,data:s})],signers:[],lookupTableAddress:[],instructionTypes:[41]}}}static makeWithdrawInstructionV5({poolKeys:t,userKeys:n,amount:r}){rt.assertArgument(n.rewardTokenAccounts.length===t.rewardInfos.length,"lengths not equal with params.poolKeys.rewardInfos","userKeys.rewardTokenAccounts",n.rewardTokenAccounts);const i=F([V("instruction"),y("amount")]),s=M.alloc(i.span);i.encode({instruction:12,amount:X(r)},s);const o=[B(t.id,!1),E(t.authority,!1),B(n.ledger,!1),E(n.owner,!0),B(n.lpTokenAccount,!1),B(t.lpVault,!1),B(n.rewardTokenAccounts[0],!1),B(t.rewardInfos[0].rewardVault,!1),E(dn,!1),E(N,!1)];for(let a=1;a<t.rewardInfos.length;a++)o.push(B(n.rewardTokenAccounts[a],!1)),o.push(B(t.rewardInfos[a].rewardVault,!1));if(n.auxiliaryLedgers)for(const a of n.auxiliaryLedgers)o.push(B(a,!1));return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:o,data:s})],signers:[],lookupTableAddress:[],instructionTypes:[42]}}}static makeWithdrawInstructionV6({poolKeys:t,userKeys:n,amount:r}){rt.assertArgument(n.rewardTokenAccounts.length!==0,"lengths equal zero","userKeys.rewardTokenAccounts",n.rewardTokenAccounts),rt.assertArgument(n.rewardTokenAccounts.length===t.rewardInfos.length,"lengths not equal with params.poolKeys.rewardInfos","userKeys.rewardTokenAccounts",n.rewardTokenAccounts);const i=F([V("instruction"),y("amount")]),s=M.alloc(i.span);i.encode({instruction:2,amount:X(r)},s);const o=[E(N,!1),B(t.id,!1),E(t.authority,!1),B(t.lpVault,!1),B(n.ledger,!1),E(n.owner,!0),B(n.lpTokenAccount,!1)];for(let a=0;a<t.rewardInfos.length;a++)o.push(B(t.rewardInfos[a].rewardVault,!1)),o.push(B(n.rewardTokenAccounts[a],!1));return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:o,data:s})],signers:[],lookupTableAddress:[],instructionTypes:[45]}}}static makeCreateAssociatedLedgerAccountInstruction(t){const{poolKeys:n}=t,{version:r}=n;return r===3?this.makeCreateAssociatedLedgerAccountInstructionV3(t):r===5?this.makeCreateAssociatedLedgerAccountInstructionV5(t):rt.throwArgumentError("invalid version","poolKeys.version",r)}static makeCreateAssociatedLedgerAccountInstructionV3({poolKeys:t,userKeys:n}){const r=F([V("instruction")]),i=M.alloc(r.span);r.encode({instruction:9},i);const s=[B(t.id,!1),B(n.ledger,!1),E(n.owner,!0),E(Pt,!1),E(pe,!1)];return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:s,data:i})],signers:[],lookupTableAddress:[],instructionTypes:[40]}}}static makeCreateAssociatedLedgerAccountInstructionV5({poolKeys:t,userKeys:n}){const r=F([V("instruction")]),i=M.alloc(r.span);r.encode({instruction:10},i);const s=[B(t.id,!1),B(n.ledger,!1),E(n.owner,!0),E(Pt,!1),E(pe,!1)];return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:s,data:i})],signers:[],lookupTableAddress:[],instructionTypes:[43]}}}static makeCreateFarmInstruction({connection:t,userKeys:n,poolInfo:r}){const{version:i}=r;return i===6?this.makeCreateFarmInstructionV6({connection:t,userKeys:n,poolInfo:r}):rt.throwArgumentError("invalid version","version",i)}static makeCreateFarmInstructionV6(t){return U(this,arguments,function*({connection:n,userKeys:r,poolInfo:i}){var s,o,a;const u=(s=r.payer)!=null?s:r.owner,c=sn({fromPublicKey:u,programId:i.programId}),l=yield n.getMinimumBalanceForRentExemption(je.span),d=[],f=[],m=[],p=[],g=[];d.push(Ee.createAccountWithSeed({fromPubkey:u,basePubkey:u,seed:c.seed,newAccountPubkey:c.publicKey,lamports:l,space:je.span,programId:i.programId}));const{publicKey:k,nonce:A}=Ft.getAssociatedAuthority({programId:i.programId,poolId:c.publicKey}),h=Ft.getAssociatedLedgerPoolAccount({programId:i.programId,poolId:c.publicKey,mint:i.lpMint,type:"lpVault"}),w=[],T=[];for(const _ of i.rewardInfos){rt.assertArgument(_.rewardOpenTime<_.rewardEndTime,"start time error","rewardInfo.rewardOpenTime",_.rewardOpenTime),rt.assertArgument(We[_.rewardType]!==void 0,"reward type error","rewardInfo.rewardType",_.rewardType),rt.assertArgument(X(_.rewardPerSecond).gt(Y),"rewardPerSecond error","rewardInfo.rewardPerSecond",_.rewardPerSecond),w.push({isSet:new I(1),rewardPerSecond:X(_.rewardPerSecond),rewardOpenTime:X(_.rewardOpenTime),rewardEndTime:X(_.rewardEndTime),rewardType:X(We[_.rewardType])});let W;_.rewardMint.equals(R.default)?(W=yield mt.insertCreateWrappedNativeAccount({connection:n,owner:r.owner,payer:(o=r.payer)!=null?o:r.owner,instructions:d,signers:g,amount:X(_.rewardEndTime).sub(X(_.rewardOpenTime)).mul(X(_.rewardPerSecond)),instructionsType:m}),f.push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:W,owner:r.owner,payer:(a=r.payer)!=null?a:r.owner,instructionsType:p}))):W=this._selectTokenAccount({programId:N,tokenAccounts:r.tokenAccounts,mint:_.rewardMint,owner:r.owner,config:{associatedOnly:!1}}),rt.assertArgument(W!==null,"cannot found target token accounts","tokenAccounts",r.tokenAccounts);const D=_.rewardMint.equals(R.default)?C.WSOL.mint:_.rewardMint;T.push({rewardMint:D,rewardVault:Ft.getAssociatedLedgerPoolAccount({programId:i.programId,poolId:c.publicKey,mint:D,type:"rewardVault"}),userRewardToken:W})}const b=this._selectTokenAccount({programId:N,tokenAccounts:r.tokenAccounts,mint:i.lockInfo.lockMint,owner:r.owner,config:{associatedOnly:!1}});rt.assertArgument(b!==null,"cannot found lock vault","tokenAccounts",r.tokenAccounts);const v=F([y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),S=F([V("instruction"),y("nonce"),$(v,5,"rewardTimeInfo")]),P=M.alloc(S.span);S.encode({instruction:0,nonce:new I(A),rewardTimeInfo:w},P);const O=[E(N,!1),E(Pt,!1),E(pe,!1),B(c.publicKey,!1),E(k,!1),B(h,!1),E(i.lpMint,!1),B(i.lockInfo.lockVault,!1),E(i.lockInfo.lockMint,!1),B(b??R.default,!1),E(r.owner,!0)];for(const _ of T)O.push({pubkey:_.rewardMint,isSigner:!1,isWritable:!1},{pubkey:_.rewardVault,isSigner:!1,isWritable:!0},{pubkey:_.userRewardToken,isSigner:!1,isWritable:!0});const L=new nt({programId:i.programId,keys:O,data:P});return{address:{farmId:c.publicKey},innerTransaction:{instructions:[...d,L,...f],signers:g,lookupTableAddress:[],instructionTypes:[...m,46,...p]}}})}static makeCreatorWithdrawFarmRewardInstruction(t){const{poolKeys:n}=t,{version:r}=n;return r===6?this.makeCreatorWithdrawFarmRewardInstructionV6(t):rt.throwArgumentError("invalid version","version",r)}static makeCreatorWithdrawFarmRewardInstructionV6({poolKeys:t,userKeys:n,withdrawMint:r}){var i;const s=t.rewardInfos.find(d=>d.rewardMint.equals(r.equals(R.default)?C.WSOL.mint:r));rt.assertArgument(s!==void 0,"withdraw mint error","poolKeys.rewardInfos",t.rewardInfos);const o=(i=s==null?void 0:s.rewardVault)!=null?i:R.default,a=F([V("instruction")]),u=M.alloc(a.span);a.encode({instruction:5},u);const c=[E(N,!1),B(t.id,!1),E(t.authority,!1),E(t.lpVault,!1),B(o,!1),B(n.userRewardToken,!1),E(n.owner,!0)],l=new nt({programId:t.programId,keys:c,data:u});return{address:{},innerTransaction:{instructions:[l],signers:[],lookupTableAddress:[],instructionTypes:[49]}}}static fetchMultipleInfoAndUpdate(t){return U(this,arguments,function*({connection:n,pools:r,owner:i,config:s,chainTime:o}){let a=!1,u=!1;const c=[],l={};for(const p of r)l[p.id.toString()]=p,p.version===6?u=!0:a=!0,c.push({pubkey:p.id,version:p.version,key:"state",poolId:p.id}),c.push({pubkey:p.lpVault,version:p.version,key:"lpVault",poolId:p.id}),i&&c.push({pubkey:this.getAssociatedLedgerAccount({programId:p.programId,poolId:p.id,owner:i,version:p.version}),version:p.version,key:"ledger",poolId:p.id});const d={},f=yield _n(n,c,s);for(const{pubkey:p,version:g,key:k,poolId:A,accountInfo:h}of f){const w=A.toBase58();if(k==="state"){const T=this.getStateLayout(g);if(!h||!h.data||h.data.length!==T.span)return rt.throwArgumentError("invalid farm state account info","pools.id",p);d[w]=Z(Z(Z({},d[w]),{apiPoolInfo:l[w]}),{state:T.decode(h.data)})}else if(k==="lpVault"){if(!h||!h.data||h.data.length!==Zt.span)return rt.throwArgumentError("invalid farm lp vault account info","pools.lpVault",p);d[w]=Z(Z({},d[w]),{lpVault:Zt.decode(h.data)})}else if(k==="ledger"){const T=this.getLedgerLayout(g);h&&h.data&&(rt.assertArgument(h.data.length===T.span,"invalid farm ledger account info","ledger",p),d[w]=Z(Z({},d[w]),{ledger:T.decode(h.data)}))}}const m=u||a?yield n.getSlot():0;for(const p of Object.keys(d))d[p]!==void 0&&(d[p].state=Ft.updatePoolInfo(d[p].state,d[p].lpVault,m,o));for(const[p,{state:g,ledger:k}]of Object.entries(d))if(k){let A;g.version===6?A=g.rewardMultiplier:A=g.rewardInfos.length===1?Ln.pow(new I(9)):Ln.pow(new I(15));const h=g.rewardInfos.map((w,T)=>{const b=k.rewardDebts[T];return k.deposited.mul(g.version===6?w.accRewardPerShare:w.perShareReward).div(A).sub(b)});d[p].wrapped=yt(Z({},d[p].wrapped),{pendingRewards:h})}return d})}static updatePoolInfo(t,n,r,i){if(t.version===3||t.version===5){if(t.lastSlot.gte(new I(r)))return t;const s=new I(r).sub(t.lastSlot);t.lastSlot=new I(r);for(const o of t.rewardInfos){if(n.amount.eq(new I(0)))continue;const a=o.perSlotReward.mul(s);o.perShareReward=o.perShareReward.add(a.mul(new I(10).pow(new I(t.version===3?9:15))).div(n.amount)),o.totalReward=o.totalReward.add(a)}}else if(t.version===6)for(const s of t.rewardInfos){if(s.rewardState.eq(new I(0)))continue;const o=I.min(new I(i),s.rewardEndTime);if(s.rewardOpenTime.gte(o))continue;let u=o.sub(s.rewardLastUpdateTime).mul(s.rewardPerSecond);const c=s.totalReward.sub(s.totalRewardEmissioned);c.lt(u)?(u=c,s.rewardLastUpdateTime=s.rewardLastUpdateTime.add(c.div(s.rewardPerSecond))):s.rewardLastUpdateTime=o,!n.amount.eq(new I(0))&&(s.accRewardPerShare=s.accRewardPerShare.add(u.mul(t.rewardMultiplier).div(n.amount)),s.totalRewardEmissioned=s.totalRewardEmissioned.add(u))}return t}static makeCreatorWithdrawFarmRewardInstructionSimple(t){const{poolKeys:n}=t,{version:r}=n;return r===6?this.makeCreatorWithdrawFarmRewardInstructionV6Simple(t):rt.throwArgumentError("invalid version","version",r)}static makeCreatorWithdrawFarmRewardInstructionV6Simple(t){return U(this,arguments,function*({connection:n,poolKeys:r,userKeys:i,withdrawMint:s,makeTxVersion:o,lookupTableCache:a,computeBudgetConfig:u}){var c,l,d,f;const m=[],p=[],g=[],k=[],A=[];let h;if(s.equals(R.default))h=yield mt.insertCreateWrappedNativeAccount({connection:n,owner:i.owner,payer:(c=i.payer)!=null?c:i.owner,instructions:m,signers:A,amount:0,instructionsType:g}),p.push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:h,owner:i.owner,payer:(l=i.payer)!=null?l:i.owner,instructionsType:k}));else{const T=this._selectTokenAccount({programId:N,tokenAccounts:i.tokenAccounts,mint:s,owner:i.owner});T===null?(h=St(i.owner,s,N).publicKey,m.push(mt.makeCreateAssociatedTokenAccountInstruction({programId:N,mint:s,associatedAccount:h,owner:i.owner,payer:(d=i.payer)!=null?d:i.owner,instructionsType:g}))):h=T}const w=this.makeCreatorWithdrawFarmRewardInstructionV6({poolKeys:r,userKeys:{userRewardToken:h,owner:i.owner,payer:i.payer},withdrawMint:s});return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:o,computeBudgetConfig:u,payer:(f=i.payer)!=null?f:i.owner,innerTransaction:[{instructionTypes:g,instructions:m,signers:A},w.innerTransaction,{instructionTypes:k,instructions:p,signers:[]}],lookupTableCache:a})}})}static makeCreateFarmInstructionSimple(t){const{version:n}=t.poolInfo;return n===6?this.makeCreateFarmInstructionV6Simple(t):rt.throwArgumentError("invalid version","version",n)}static makeCreateFarmInstructionV6Simple(t){return U(this,arguments,function*({connection:n,userKeys:r,poolInfo:i,makeTxVersion:s,lookupTableCache:o,computeBudgetConfig:a}){var u,c,l,d;const f=(u=r.payer)!=null?u:r.owner,m=sn({fromPublicKey:f,programId:i.programId}),p=yield n.getMinimumBalanceForRentExemption(je.span),g=[],k=[],A=[],h=[],w=[];g.push(Ee.createAccountWithSeed({fromPubkey:f,basePubkey:f,seed:m.seed,newAccountPubkey:m.publicKey,lamports:p,space:je.span,programId:i.programId}));const{publicKey:T,nonce:b}=Ft.getAssociatedAuthority({programId:i.programId,poolId:m.publicKey}),v=Ft.getAssociatedLedgerPoolAccount({programId:i.programId,poolId:m.publicKey,mint:i.lpMint,type:"lpVault"}),S=[],P=[];for(const G of i.rewardInfos){rt.assertArgument(G.rewardOpenTime<G.rewardEndTime,"start time error","rewardInfo.rewardOpenTime",G.rewardOpenTime),rt.assertArgument(We[G.rewardType]!==void 0,"reward type error","rewardInfo.rewardType",G.rewardType),rt.assertArgument(X(G.rewardPerSecond).gt(Y),"rewardPerSecond error","rewardInfo.rewardPerSecond",G.rewardPerSecond),S.push({isSet:new I(1),rewardPerSecond:X(G.rewardPerSecond),rewardOpenTime:X(G.rewardOpenTime),rewardEndTime:X(G.rewardEndTime),rewardType:X(We[G.rewardType])});let H;if(G.rewardMint.equals(R.default)?(H=yield mt.insertCreateWrappedNativeAccount({connection:n,owner:r.owner,payer:(c=r.payer)!=null?c:r.owner,instructions:g,signers:w,amount:X(G.rewardEndTime).sub(X(G.rewardOpenTime)).mul(X(G.rewardPerSecond)),instructionsType:A}),k.push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:H,owner:r.owner,payer:(l=r.payer)!=null?l:r.owner,instructionsType:h}))):H=this._selectTokenAccount({programId:N,tokenAccounts:r.tokenAccounts,mint:G.rewardMint,owner:r.owner,config:{associatedOnly:!1}}),rt.assertArgument(H!==null,"cannot found target token accounts","tokenAccounts",r.tokenAccounts),H===null)throw Error("cannot found target token accounts");const At=G.rewardMint.equals(R.default)?C.WSOL.mint:G.rewardMint;P.push({rewardMint:At,rewardVault:Ft.getAssociatedLedgerPoolAccount({programId:i.programId,poolId:m.publicKey,mint:At,type:"rewardVault"}),userRewardToken:H})}const O=this._selectTokenAccount({programId:N,tokenAccounts:r.tokenAccounts,mint:i.lockInfo.lockMint,owner:r.owner,config:{associatedOnly:!1}});rt.assertArgument(O!==null,"cannot found lock vault","tokenAccounts",r.tokenAccounts);const L=F([y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),_=F([V("instruction"),y("nonce"),$(L,5,"rewardTimeInfo")]),W=M.alloc(_.span);_.encode({instruction:0,nonce:new I(b),rewardTimeInfo:S},W);const D=[E(N,!1),E(Pt,!1),E(pe,!1),B(m.publicKey,!1),E(T,!1),B(v,!1),E(i.lpMint,!1),B(i.lockInfo.lockVault,!1),E(i.lockInfo.lockMint,!1),B(O??R.default,!1),E(r.owner,!0)];for(const G of P)D.push({pubkey:G.rewardMint,isSigner:!1,isWritable:!1},{pubkey:G.rewardVault,isSigner:!1,isWritable:!0},{pubkey:G.userRewardToken,isSigner:!1,isWritable:!0});const et=new nt({programId:i.programId,keys:D,data:W});return{address:{farmId:m.publicKey},innerTransactions:yield at({connection:n,makeTxVersion:s,computeBudgetConfig:a,payer:(d=r.payer)!=null?d:r.owner,innerTransaction:[{instructionTypes:A,instructions:g,signers:w},{instructionTypes:[46],instructions:[et],signers:[]},{instructionTypes:h,instructions:k,signers:[]}],lookupTableCache:o})}})}static makeRestartFarmInstructionSimple(t){const{poolKeys:n}=t,{version:r}=n;return r===6?this.makeRestartFarmInstructionV6Simple(t):rt.throwArgumentError("invalid version","version",r)}static makeRestartFarmInstructionV6Simple(t){return U(this,arguments,function*({connection:n,poolKeys:r,userKeys:i,newRewardInfo:s,makeTxVersion:o,lookupTableCache:a,computeBudgetConfig:u}){var c,l,d,f;rt.assertArgument(s.rewardOpenTime<s.rewardEndTime,"start time error","newRewardInfo",s);const m=s.rewardMint.equals(R.default)?C.WSOL.mint:s.rewardMint,p=r.rewardInfos.find(L=>L.rewardMint.equals(m));rt.assertArgument(p,"configuration does not exist","rewardInfo",p);const g=(c=p==null?void 0:p.rewardVault)!=null?c:R.default,k=[],A=[],h=[],w=[],T=[];let b;if(s.rewardMint.equals(R.default)?(b=yield mt.insertCreateWrappedNativeAccount({connection:n,owner:i.owner,payer:(l=i.payer)!=null?l:i.owner,instructions:k,signers:T,amount:X(s.rewardEndTime).sub(X(s.rewardOpenTime)).mul(X(s.rewardPerSecond)),instructionsType:h}),A.push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:b,owner:i.owner,payer:(d=i.payer)!=null?d:i.owner,instructionsType:w}))):b=this._selectTokenAccount({programId:N,tokenAccounts:i.tokenAccounts,mint:s.rewardMint,owner:i.owner,config:{associatedOnly:!1}}),rt.assertArgument(b!==null,"cannot found target token accounts","tokenAccounts",i.tokenAccounts),b===null)throw Error("cannot found target token accounts");const v=F([V("instruction"),y("rewardReopenTime"),y("rewardEndTime"),y("rewardPerSecond")]),S=M.alloc(v.span);v.encode({instruction:3,rewardReopenTime:X(s.rewardOpenTime),rewardEndTime:X(s.rewardEndTime),rewardPerSecond:X(s.rewardPerSecond)},S);const P=[E(N,!1),B(r.id,!1),E(r.lpVault,!1),B(g,!1),B(b,!1),E(i.owner,!0)],O=new nt({programId:r.programId,keys:P,data:S});return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:o,computeBudgetConfig:u,payer:(f=i.payer)!=null?f:i.owner,innerTransaction:[{instructionTypes:h,instructions:k,signers:T},{instructionTypes:[47],instructions:[O],signers:[]},{instructionTypes:w,instructions:A,signers:[]}],lookupTableCache:a})}})}static makeFarmCreatorAddRewardTokenInstructionSimple(t){const{poolKeys:n}=t,{version:r}=n;return r===6?this.makeFarmCreatorAddRewardTokenInstructionV6Simple(t):rt.throwArgumentError("invalid version","version",r)}static makeFarmCreatorAddRewardTokenInstructionV6Simple(t){return U(this,arguments,function*({connection:n,poolKeys:r,userKeys:i,newRewardInfo:s,makeTxVersion:o,lookupTableCache:a,computeBudgetConfig:u}){var c,l,d;const f=Ft.getAssociatedLedgerPoolAccount({programId:r.programId,poolId:r.id,mint:s.rewardMint.equals(R.default)?C.WSOL.mint:s.rewardMint,type:"rewardVault"}),m=[],p=[],g=[],k=[],A=[];let h;if(s.rewardMint.equals(R.default)?(h=yield mt.insertCreateWrappedNativeAccount({connection:n,owner:i.owner,payer:(c=i.payer)!=null?c:i.owner,instructions:m,signers:A,amount:X(s.rewardEndTime).sub(X(s.rewardOpenTime)).mul(X(s.rewardPerSecond)),instructionsType:g}),p.push(mt.makeCloseAccountInstruction({programId:N,tokenAccount:h,owner:i.owner,payer:(l=i.payer)!=null?l:i.owner,instructionsType:k}))):h=this._selectTokenAccount({programId:N,tokenAccounts:i.tokenAccounts,mint:s.rewardMint,owner:i.owner,config:{associatedOnly:!1}}),rt.assertArgument(h!==null,"cannot found target token accounts","tokenAccounts",i.tokenAccounts),h===null)throw Error("cannot found target token accounts");const w=s.rewardMint.equals(R.default)?C.WSOL.mint:s.rewardMint,T=F([V("instruction"),y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),b=M.alloc(T.span);T.encode({instruction:4,isSet:new I(1),rewardPerSecond:X(s.rewardPerSecond),rewardOpenTime:X(s.rewardOpenTime),rewardEndTime:X(s.rewardEndTime),rewardType:X(We[s.rewardType])},b);const v=[E(N,!1),E(Pt,!1),E(pe,!1),B(r.id,!1),E(r.authority,!1),E(w,!1),B(f,!1),B(h,!1),E(i.owner,!0)],S=new nt({programId:r.programId,keys:v,data:b});return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:o,computeBudgetConfig:u,payer:(d=i.payer)!=null?d:i.owner,innerTransaction:[{instructionTypes:g,instructions:m,signers:A},{instructionTypes:[48],instructions:[S],signers:[]},{instructionTypes:k,instructions:p,signers:[]}],lookupTableCache:a})}})}static makeDepositInstructionSimple(t){return U(this,arguments,function*({connection:n,poolKeys:r,fetchPoolInfo:i,ownerInfo:s,amount:o,associatedOnly:a=!0,checkCreateATAOwner:u=!1,makeTxVersion:c,lookupTableCache:l,computeBudgetConfig:d}){var f;const m={};for(const _ of s.tokenAccounts)a?St(s.wallet,_.accountInfo.mint,_.programId).publicKey.equals(_.pubkey)&&(m[_.accountInfo.mint.toString()]=_.pubkey):m[_.accountInfo.mint.toString()]=_.pubkey;const p=[],g=[],k=[],A=[],h=[],{lpVault:w,apiPoolInfo:T,ledger:b}=i,v=w.mint,S=m[v.toString()];rt.assertArgument(S,"you don't have any lp","lp zero",m);const P=[];for(const _ of T.rewardInfos){const W=s.useSOLBalance&&_.rewardMint.equals(C.WSOL.mint),D=(f=m[_.rewardMint.toString()])!=null?f:yield this._selectOrCreateTokenAccount({programId:N,mint:_.rewardMint,tokenAccounts:W?[]:s.tokenAccounts,owner:s.wallet,createInfo:{connection:n,payer:s.feePayer,amount:0,frontInstructions:p,frontInstructionsType:k,endInstructions:W?g:[],endInstructionsType:W?A:[],signers:h},associatedOnly:W?!1:a,checkCreateATAOwner:u});m[_.rewardMint.toString()]=D,P.push(D)}const O=yield Ft.getAssociatedLedgerAccount({programId:new R(T.programId),poolId:new R(T.id),owner:s.wallet,version:T.version});if(T.version<6&&!b){const _=Ft.makeCreateAssociatedLedgerAccountInstruction({poolKeys:r,userKeys:{owner:s.wallet,ledger:O}});p.push(..._.innerTransaction.instructions),k.push(..._.innerTransaction.instructionTypes)}const L=Ft.makeDepositInstruction({poolKeys:r,userKeys:{ledger:O,lpTokenAccount:S,owner:s.wallet,rewardTokenAccounts:P},amount:o});return{address:L.address,innerTransactions:yield at({connection:n,makeTxVersion:c,computeBudgetConfig:d,payer:s.feePayer,innerTransaction:[{instructionTypes:k,instructions:p,signers:h},L.innerTransaction,{instructionTypes:A,instructions:g,signers:[]}],lookupTableCache:l})}})}static makeWithdrawInstructionSimple(t){return U(this,arguments,function*({connection:n,fetchPoolInfo:r,ownerInfo:i,amount:s,associatedOnly:o=!0,checkCreateATAOwner:a=!1,makeTxVersion:u,lookupTableCache:c,computeBudgetConfig:l}){var d,f;const m={};for(const D of i.tokenAccounts)o?St(i.wallet,D.accountInfo.mint,D.programId).publicKey.equals(D.pubkey)&&(m[D.accountInfo.mint.toString()]=D.pubkey):m[D.accountInfo.mint.toString()]=D.pubkey;const p=[],g=[],k=[],A=[],h=[],w=[],T=[],{lpVault:b,wrapped:v,apiPoolInfo:S}=r;if(v===void 0)throw Error("no lp");const P=b.mint,O=i.useSOLBalance&&P.equals(C.WSOL.mint),L=(d=m[P.toString()])!=null?d:yield this._selectOrCreateTokenAccount({programId:N,mint:P,tokenAccounts:O?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:n,payer:i.feePayer,amount:0,frontInstructions:p,frontInstructionsType:k,signers:T},associatedOnly:O?!1:o,checkCreateATAOwner:a});m[P.toString()]=L;const _=[];for(const D of S.rewardInfos){const et=i.useSOLBalance&&D.rewardMint.equals(C.WSOL.mint),G=(f=m[D.rewardMint.toString()])!=null?f:yield this._selectOrCreateTokenAccount({programId:N,mint:D.rewardMint,tokenAccounts:et?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:n,payer:i.feePayer,amount:0,frontInstructions:p,frontInstructionsType:k,endInstructions:et?g:[],endInstructionsType:et?A:[],signers:T},associatedOnly:et?!1:o,checkCreateATAOwner:a});m[D.rewardMint.toString()]=G,_.push(G)}const W=this.makeWithdrawInstruction({poolKeys:S,userKeys:{ledger:this.getAssociatedLedgerAccount({programId:S.programId,poolId:S.id,owner:i.wallet,version:S.version}),lpTokenAccount:L,rewardTokenAccounts:_,owner:i.wallet},amount:s});return h.push(...W.innerTransaction.instructions),w.push(...W.innerTransaction.instructionTypes),{address:{},innerTransactions:yield at({connection:n,makeTxVersion:u,computeBudgetConfig:l,payer:i.feePayer,innerTransaction:[{instructionTypes:k,instructions:p,signers:T},{instructionTypes:w,instructions:h,signers:[]},{instructionTypes:A,instructions:g,signers:[]}],lookupTableCache:c})}})}static makeHarvestAllRewardInstructionSimple(t){return U(this,arguments,function*({connection:n,fetchPoolInfos:r,ownerInfo:i,associatedOnly:s=!0,checkCreateATAOwner:o=!1,makeTxVersion:a,lookupTableCache:u,computeBudgetConfig:c}){var l,d;const f={};for(const w of i.tokenAccounts)s?St(i.wallet,w.accountInfo.mint,w.programId).publicKey.equals(w.pubkey)&&(f[w.accountInfo.mint.toString()]=w.pubkey):f[w.accountInfo.mint.toString()]=w.pubkey;const m=[],p=[],g=[],k=[],A=[],h=[];for(const{lpVault:w,wrapped:T,apiPoolInfo:b,ledger:v}of Object.values(r)){if(T===void 0||v===void 0||!(T.pendingRewards.find(W=>W.gt(Y))!==void 0||v.deposited.isZero()))continue;const S=w.mint,P=i.useSOLBalance&&S.equals(C.WSOL.mint),O=(l=f[S.toString()])!=null?l:yield this._selectOrCreateTokenAccount({programId:N,mint:S,tokenAccounts:P?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:n,payer:i.feePayer,amount:0,frontInstructions:m,frontInstructionsType:g,signers:h},associatedOnly:P?!1:s,checkCreateATAOwner:o});f[S.toString()]=O;const L=[];for(const W of b.rewardInfos){const D=i.useSOLBalance&&W.rewardMint.equals(C.WSOL.mint),et=(d=f[W.rewardMint.toString()])!=null?d:yield this._selectOrCreateTokenAccount({programId:N,mint:W.rewardMint,tokenAccounts:D?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:n,payer:i.feePayer,amount:0,frontInstructions:m,frontInstructionsType:g,endInstructions:D?p:[],endInstructionsType:D?k:[],signers:h},associatedOnly:D?!1:s,checkCreateATAOwner:o});f[W.rewardMint.toString()]=et,L.push(et)}const _=this.makeWithdrawInstruction({poolKeys:b,userKeys:{ledger:this.getAssociatedLedgerAccount({programId:b.programId,poolId:b.id,owner:i.wallet,version:b.version}),lpTokenAccount:O,rewardTokenAccounts:L,owner:i.wallet},amount:0});A.push(_.innerTransaction)}return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:a,computeBudgetConfig:c,payer:i.feePayer,innerTransaction:[{instructionTypes:g,instructions:m,signers:h},...A,{instructionTypes:k,instructions:p,signers:[]}],lookupTableCache:u})}})}static makeV1InfoToV2PdaAndHarvestSimple(t){return U(this,arguments,function*({connection:n,wallet:r,tokenAccounts:i,programIdV3:s,programIdV5:o,makeTxVersion:a,lookupTableCache:u,computeBudgetConfig:c}){const l={};for(const S of i){const P=S.accountInfo.mint,O=St(r,P,S.programId).publicKey;O.equals(S.pubkey)&&(l[P.toString()]=O),l[P.toString()]===void 0&&(l[P.toString()]=S.pubkey)}const d=yield n.getProgramAccounts(s,{filters:[{memcmp:{offset:40,bytes:r.toString()}}]}),f=yield n.getProgramAccounts(o,{filters:[{memcmp:{offset:40,bytes:r.toString()}}]}),m={},p={};for(const S of d){const O=(S.account.data.length===si.span?si:yn).decode(S.account.data),L=O.id.toString(),_=this.getAssociatedLedgerAccount({programId:s,poolId:O.id,owner:r,version:3});m[L]===void 0&&(m[L]={pda:void 0,other:[]}),_.equals(S.pubkey)?m[L].pda=S.pubkey:m[L].other.push(S.pubkey)}for(const S of f){const O=(S.account.data.length===oi.span?oi:ns).decode(S.account.data),L=O.id.toString(),_=this.getAssociatedLedgerAccount({programId:o,poolId:O.id,owner:r,version:5});p[L]===void 0&&(p[L]={pda:void 0,other:[]}),_.equals(S.pubkey)?p[L].pda=S.pubkey:p[L].other.push(S.pubkey)}const g=[...Object.entries(m).filter(S=>S[1].other.length>0).map(S=>S[0]),...Object.entries(p).filter(S=>S[1].other.length>0).map(S=>S[0])],k=yield n.getMultipleAccountsInfo(g.map(S=>new R(S))),A={};for(let S=0;S<g.length;S++){const P=g[S],O=k[S];O!==null&&(A[P]=O.data)}const h=[],w=[],T=[],b=[],v=[];for(const[S,P]of Object.entries(m)){if(P.other.length===0||A[S]===void 0)continue;const O=ts.decode(A[S]),[L,_]=yield n.getMultipleAccountsInfo([O.lpVault,O.rewardVault]);if(L===null||_===null)throw Error("get lp and reward info error");const W=Zt.decode(L.data),D=Zt.decode(_.data);let et=l[W.mint.toString()];et===void 0&&(et=yield this._selectOrCreateTokenAccount({programId:L.owner,mint:W.mint,tokenAccounts:[],owner:r,createInfo:{connection:n,payer:r,amount:0,frontInstructions:h,frontInstructionsType:w,endInstructions:[],endInstructionsType:[],signers:[]},associatedOnly:!0,checkCreateATAOwner:!0}),l[W.mint.toString()]=et);let G=l[D.mint.toString()];if(G===void 0&&(G=yield this._selectOrCreateTokenAccount({programId:_.owner,mint:D.mint,tokenAccounts:[],owner:r,createInfo:{connection:n,payer:r,amount:0,frontInstructions:h,frontInstructionsType:w,endInstructions:D.mint.toString()===Wt.mint?b:[],endInstructionsType:D.mint.toString()===Wt.mint?v:[],signers:[]},associatedOnly:!0,checkCreateATAOwner:!0}),l[D.mint.toString()]=G),P.pda===void 0){const At=this.makeCreateAssociatedLedgerAccountInstructionV3({poolKeys:{programId:s,id:new R(S)},userKeys:{ledger:this.getAssociatedLedgerAccount({programId:s,poolId:new R(S),owner:r,version:3}),owner:r}});T.push(At.innerTransaction)}const H=this.makeDepositInstructionV3({amount:0,userKeys:{ledger:this.getAssociatedLedgerAccount({programId:s,poolId:new R(S),owner:r,version:3}),owner:r,lpTokenAccount:et,rewardTokenAccounts:[G],auxiliaryLedgers:P.other},poolKeys:{programId:s,id:new R(S),authority:this.getAssociatedAuthority({programId:s,poolId:new R(S)}).publicKey,lpVault:O.lpVault,rewardInfos:[{rewardVault:O.rewardVault}]}});T.push(H.innerTransaction)}for(const[S,P]of Object.entries(p)){if(P.other.length===0||A[S]===void 0)continue;const O=es.decode(A[S]),[L,_,W]=yield n.getMultipleAccountsInfo([O.lpVault,O.rewardVaultA,O.rewardVaultB]);if(L===null||_===null||W===null)throw Error("get lp and reward A / B info error");const D=Zt.decode(L.data),et=Zt.decode(_.data),G=Zt.decode(W.data);let H=l[D.mint.toString()];H===void 0&&(H=yield this._selectOrCreateTokenAccount({programId:L.owner,mint:D.mint,tokenAccounts:[],owner:r,createInfo:{connection:n,payer:r,amount:0,frontInstructions:h,frontInstructionsType:w,endInstructions:[],endInstructionsType:[],signers:[]},associatedOnly:!0,checkCreateATAOwner:!0}),l[D.mint.toString()]=H);let At=l[et.mint.toString()];At===void 0&&(At=yield this._selectOrCreateTokenAccount({programId:_.owner,mint:et.mint,tokenAccounts:[],owner:r,createInfo:{connection:n,payer:r,amount:0,frontInstructions:h,frontInstructionsType:w,endInstructions:et.mint.toString()===Wt.mint?b:[],endInstructionsType:et.mint.toString()===Wt.mint?v:[],signers:[]},associatedOnly:!0,checkCreateATAOwner:!0}),l[et.mint.toString()]=At);let Gt=l[G.mint.toString()];if(Gt===void 0&&(Gt=yield this._selectOrCreateTokenAccount({programId:W.owner,mint:G.mint,tokenAccounts:[],owner:r,createInfo:{connection:n,payer:r,amount:0,frontInstructions:h,frontInstructionsType:w,endInstructions:G.mint.toString()===Wt.mint?b:[],endInstructionsType:G.mint.toString()===Wt.mint?v:[],signers:[]},associatedOnly:!0,checkCreateATAOwner:!0}),l[G.mint.toString()]=Gt),P.pda===void 0){const re=this.makeCreateAssociatedLedgerAccountInstructionV5({poolKeys:{programId:o,id:new R(S)},userKeys:{ledger:this.getAssociatedLedgerAccount({programId:o,poolId:new R(S),owner:r,version:5}),owner:r}});T.push(re.innerTransaction)}const ue=this.makeDepositInstructionV5({amount:0,userKeys:{ledger:this.getAssociatedLedgerAccount({programId:o,poolId:new R(S),owner:r,version:5}),owner:r,lpTokenAccount:H,rewardTokenAccounts:[At,Gt],auxiliaryLedgers:P.other},poolKeys:{programId:o,id:new R(S),authority:this.getAssociatedAuthority({programId:o,poolId:new R(S)}).publicKey,lpVault:O.lpVault,rewardInfos:[{rewardVault:O.rewardVaultA},{rewardVault:O.rewardVaultB}]}});T.push(ue.innerTransaction)}return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:a,computeBudgetConfig:c,payer:r,innerTransaction:[{instructionTypes:w.slice(0,10),instructions:h.slice(0,10),signers:[]},...h.length>10?[{instructionTypes:w.slice(10),instructions:h.slice(10),signers:[]}]:[],...T,{instructionTypes:v,instructions:b,signers:[]}],lookupTableCache:u})}})}static makeDepositTokenInstruction(t){return U(this,arguments,function*({connection:n,programId:r,governanceProgramId:i,voteWeightAddinProgramId:s,realm:o,communityTokenMint:a,owner:u,poolId:c}){const l=ai(s,o,a).publicKey,d=this.getAssociatedLedgerAccount({programId:r,poolId:c,owner:u,version:3}),f=yield n.getAccountInfo(d);if(f===null)throw Error("user is not staker");const m=yn.decode(f.data),p=m.deposited.sub(m.voteLockedBalance);if(p.eq(Y))throw Error("user do not has new stake amount");const g=ci(r,c).publicKey,k=ui(r,c).publicKey,{publicKey:A,nonce:h}=li(s,l,u),w=St(A,g,N).publicKey,{publicKey:T,nonce:b}=di(s,l,u),v=mi(i,o,a,u).publicKey,S=[],P=St(u,g,N).publicKey;if((yield n.getAccountInfo(P))===null&&S.push(mt.makeCreateAssociatedTokenAccountInstruction({programId:N,mint:g,associatedAccount:P,owner:u,payer:u,instructionsType:[]})),(yield n.getAccountInfo(A))===null){const D=qa(i,o,u,a,u,v);S.push(D,Na(s,l,A,T,u,u,h,b))}const{index:_,isInit:W}=yield pi(n,l,A,g);return W||S.push(Ca(s,l,A,w,u,u,g,_,0,void 0,0,!1)),S.push(Fa(s,l,A,w,P,u,d,c,g,k,r,_,p),Wa(s,l,A,T)),{address:{},innerTransaction:{instructions:S,signers:[],lookupTableAddress:[],instructionTypes:Array(S.length).fill(50)}}})}static makeWithdrawTokenInstruction(t){return U(this,arguments,function*({connection:n,programId:r,governanceProgramId:i,voteWeightAddinProgramId:s,realm:o,communityTokenMint:a,owner:u,poolId:c}){const l=ai(s,o,a).publicKey,d=this.getAssociatedLedgerAccount({programId:r,poolId:c,owner:u,version:3}),f=yield n.getAccountInfo(d);if(f===null)throw Error("user is not staker");const m=yn.decode(f.data);if(m.voteLockedBalance.eq(Y))throw Error("user has vote locked balance = 0");const p=ci(r,c).publicKey,g=ui(r,c).publicKey,{publicKey:k}=li(s,l,u),A=St(k,p,N).publicKey,{publicKey:h}=di(s,l,u),w=mi(i,o,a,u).publicKey,T=[],{index:b,isInit:v}=yield pi(n,l,k,p);if(!v)throw Error("deposit entry index check error");return T.push(Da(s,l,k,u,w,h,A,St(u,p,N).publicKey,d,c,p,g,r,b,m.voteLockedBalance)),{address:{},innerTransaction:{instructions:T,signers:[],lookupTableAddress:[],instructionTypes:Array(T.length).fill(50)}}})}};function pi(e,t,n,r){return U(this,null,function*(){const i=yield e.getAccountInfo(t);if(i===null)throw Error("registrar info check error");const o=ja.decode(i.data).votingMints.findIndex(l=>l.mint.equals(r));if(o===-1)throw Error("find voter mint error");const a=yield e.getAccountInfo(n);if(a===null)return{index:o,isInit:!1};const c=Ka.decode(a.data).deposits.findIndex(l=>l.isUsed&&l.votingMintConfigIdx===o);return c===-1?{index:o,isInit:!1}:{index:c,isInit:!0}})}var Ja=F([y("status"),y("nonce"),y("maxOrder"),y("depth"),y("baseDecimal"),y("quoteDecimal"),y("state"),y("resetFlag"),y("minSize"),y("volMaxCutRatio"),y("amountWaveRatio"),y("baseLotSize"),y("quoteLotSize"),y("minPriceMultiplier"),y("maxPriceMultiplier"),y("systemDecimalValue"),y("minSeparateNumerator"),y("minSeparateDenominator"),y("tradeFeeNumerator"),y("tradeFeeDenominator"),y("pnlNumerator"),y("pnlDenominator"),y("swapFeeNumerator"),y("swapFeeDenominator"),y("baseNeedTakePnl"),y("quoteNeedTakePnl"),y("quoteTotalPnl"),y("baseTotalPnl"),y("poolOpenTime"),y("punishPcAmount"),y("punishCoinAmount"),y("orderbookToInitTime"),J("swapBaseInAmount"),J("swapQuoteOutAmount"),y("swapBase2QuoteFee"),J("swapQuoteInAmount"),J("swapBaseOutAmount"),y("swapQuote2BaseFee"),q("baseVault"),q("quoteVault"),q("baseMint"),q("quoteMint"),q("lpMint"),q("openOrders"),q("marketId"),q("marketProgramId"),q("targetOrders"),q("withdrawQueue"),q("lpVault"),q("owner"),y("lpReserve"),$(y(),3,"padding")]),tc=F([y("accountType"),y("status"),y("nonce"),y("maxOrder"),y("depth"),y("baseDecimal"),y("quoteDecimal"),y("state"),y("resetFlag"),y("minSize"),y("volMaxCutRatio"),y("amountWaveRatio"),y("baseLotSize"),y("quoteLotSize"),y("minPriceMultiplier"),y("maxPriceMultiplier"),y("systemDecimalsValue"),y("abortTradeFactor"),y("priceTickMultiplier"),y("priceTick"),y("minSeparateNumerator"),y("minSeparateDenominator"),y("tradeFeeNumerator"),y("tradeFeeDenominator"),y("pnlNumerator"),y("pnlDenominator"),y("swapFeeNumerator"),y("swapFeeDenominator"),y("baseNeedTakePnl"),y("quoteNeedTakePnl"),y("quoteTotalPnl"),y("baseTotalPnl"),y("poolOpenTime"),y("punishPcAmount"),y("punishCoinAmount"),y("orderbookToInitTime"),J("swapBaseInAmount"),J("swapQuoteOutAmount"),J("swapQuoteInAmount"),J("swapBaseOutAmount"),y("swapQuote2BaseFee"),y("swapBase2QuoteFee"),q("baseVault"),q("quoteVault"),q("baseMint"),q("quoteMint"),q("lpMint"),q("modelDataAccount"),q("openOrders"),q("marketId"),q("marketProgramId"),q("targetOrders"),q("owner"),$(y(),64,"padding")]),gi={4:Ja,5:tc},Qt={createPool:[233,146,209,142,207,104,64,188],initReward:[95,135,192,196,242,129,230,68],setRewardEmissions:[112,52,167,75,32,201,211,137],openPosition:[77,184,74,214,112,86,241,199],closePosition:[123,134,81,0,49,68,98,98],increaseLiquidity:[133,29,89,223,69,238,176,10],decreaseLiquidity:[58,127,188,62,79,82,196,96],swap:[43,4,237,11,26,201,30,98],collectReward:[18,237,166,197,34,16,213,144]};function ec(e,t,n,r,i,s,o,a,u,c,l,d,f,m){const p=F([J("sqrtPriceX64"),y("startTime")]),g=[{pubkey:n,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:Pt,isSigner:!1,isWritable:!1},{pubkey:Ne,isSigner:!1,isWritable:!1}],k=M.alloc(p.span);p.encode({sqrtPriceX64:f,startTime:m},k);const A=M.from([...Qt.createPool,...k]);return new nt({keys:g,programId:e,data:A})}function nc(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p,g,k,A,h,w,T,b,v,S,P,O){const L=F([Mt("tickLowerIndex"),Mt("tickUpperIndex"),Mt("tickArrayLowerStartIndex"),Mt("tickArrayUpperStartIndex"),J("liquidity"),y("amountMaxA"),y("amountMaxB"),Yt("withMetadata"),V("optionBaseFlag"),Yt("baseFlag")]),_=[...O?[{pubkey:O,isSigner:!1,isWritable:!0}]:[]],W=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:Ne,isSigner:!1,isWritable:!1},{pubkey:Pt,isSigner:!1,isWritable:!1},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:Xe,isSigner:!1,isWritable:!1},{pubkey:On,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},..._],D=M.alloc(L.span);L.encode({tickLowerIndex:A,tickUpperIndex:h,tickArrayLowerStartIndex:w,tickArrayUpperStartIndex:T,liquidity:b,amountMaxA:v,amountMaxB:S,withMetadata:P==="create",baseFlag:!1,optionBaseFlag:0},D);const et=M.from([...Qt.openPosition,...D]);return new nt({keys:W,programId:e,data:et})}function rc(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p,g,k,A,h,w,T,b,v,S,P,O){const L=F([Mt("tickLowerIndex"),Mt("tickUpperIndex"),Mt("tickArrayLowerStartIndex"),Mt("tickArrayUpperStartIndex"),J("liquidity"),y("amountMaxA"),y("amountMaxB"),Yt("withMetadata"),V("optionBaseFlag"),Yt("baseFlag")]),_=[...O?[{pubkey:O,isSigner:!1,isWritable:!0}]:[]],W=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:Ne,isSigner:!1,isWritable:!1},{pubkey:Pt,isSigner:!1,isWritable:!1},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:Xe,isSigner:!1,isWritable:!1},{pubkey:On,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},..._],D=M.alloc(L.span);L.encode({tickLowerIndex:A,tickUpperIndex:h,tickArrayLowerStartIndex:w,tickArrayUpperStartIndex:T,liquidity:Y,amountMaxA:v==="MintA"?S:P,amountMaxB:v==="MintA"?P:S,withMetadata:b==="create",baseFlag:v==="MintA",optionBaseFlag:1},D);const et=M.from([...Qt.openPosition,...D]);return new nt({keys:W,programId:e,data:et})}function ic(e,t,n,r,i){const s=F([]),o=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:Pt,isSigner:!1,isWritable:!1},{pubkey:N,isSigner:!1,isWritable:!1}],a=M.alloc(s.span);s.encode({},a);const u=M.from([...Qt.closePosition,...a]);return new nt({keys:o,programId:e,data:u})}function sc(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p,g,k,A){const h=F([J("liquidity"),y("amountMaxA"),y("amountMaxB"),V("optionBaseFlag"),Yt("baseFlag")]),w=[...A?[{pubkey:A,isSigner:!1,isWritable:!0}]:[]],T=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},...w],b=M.alloc(h.span);h.encode({liquidity:p,amountMaxA:g,amountMaxB:k,optionBaseFlag:0,baseFlag:!1},b);const v=M.from([...Qt.increaseLiquidity,...b]);return new nt({keys:T,programId:e,data:v})}function oc(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p,g,k,A){const h=F([J("liquidity"),y("amountMaxA"),y("amountMaxB"),V("optionBaseFlag"),Yt("baseFlag")]),w=[...A?[{pubkey:A,isSigner:!1,isWritable:!0}]:[]],T=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},...w],b=M.alloc(h.span);h.encode({liquidity:Y,amountMaxA:p==="MintA"?g:k,amountMaxB:p==="MintA"?k:g,baseFlag:p==="MintA",optionBaseFlag:1},b);const v=M.from([...Qt.increaseLiquidity,...b]);return new nt({keys:T,programId:e,data:v})}function ac(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p,g,k,A,h){const w=F([J("liquidity"),y("amountMinA"),y("amountMinB")]),T=[...h?[{pubkey:h,isSigner:!1,isWritable:!0}]:[],...p.map(P=>[{pubkey:P.poolRewardVault,isSigner:!1,isWritable:!0},{pubkey:P.ownerRewardVault,isSigner:!1,isWritable:!0},{pubkey:P.rewardMint,isSigner:!1,isWritable:!1}]).flat()],b=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},...T],v=M.alloc(w.span);w.encode({liquidity:g,amountMinA:k,amountMinB:A},v);const S=M.from([...Qt.decreaseLiquidity,...v]);return new nt({keys:b,programId:e,data:S})}function Ai(e,t,n,r,i,s,o,a,u,c,l,d,f,m,p,g,k){const A=F([y("amount"),y("otherAmountThreshold"),J("sqrtPriceLimitX64"),Yt("isBaseInput")]),h=[...k?[{pubkey:k,isSigner:!1,isWritable:!0}]:[],...l.map(v=>({pubkey:v,isSigner:!1,isWritable:!0}))],w=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},...h],T=M.alloc(A.span);A.encode({amount:f,otherAmountThreshold:m,sqrtPriceLimitX64:p,isBaseInput:g},T);const b=M.from([...Qt.swap,...T]);return new nt({keys:w,programId:e,data:b})}function cc(e,t,n,r,i,s,o,a,u,c,l,d){const f=F([y("openTime"),y("endTime"),J("emissionsPerSecondX64")]),m=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:Pt,isSigner:!1,isWritable:!1},{pubkey:Ne,isSigner:!1,isWritable:!1}],p=M.alloc(f.span);f.encode({openTime:X(c),endTime:X(l),emissionsPerSecondX64:d},p);const g=M.from([...Qt.initReward,...p]);return new nt({keys:m,programId:e,data:g})}function uc(e,t,n,r,i,s,o,a,u,c,l,d){const f=F([V("rewardIndex"),J("emissionsPerSecondX64"),y("openTime"),y("endTime")]),m=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0}],p=M.alloc(f.span);f.encode({rewardIndex:u,emissionsPerSecondX64:d,openTime:X(c),endTime:X(l)},p);const g=M.from([...Qt.setRewardEmissions,...p]);return new nt({keys:m,programId:e,data:g})}function lc(e,t,n,r,i,s,o){const a=F([V("rewardIndex")]),u=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:ee,isSigner:!1,isWritable:!1},{pubkey:yr,isSigner:!1,isWritable:!1}],c=M.alloc(a.span);a.encode({rewardIndex:o},c);const l=M.from([...Qt.collectReward,...c]);return new nt({keys:u,programId:e,data:l})}var Se=new I(-1),_e=new I(1).shln(64),mr=new I(1).shln(128),hi=_e.sub(gt),En=64,dc=mr.subn(1),Vt=-443636,Xt=-Vt,Ie=new I("4295048016"),Be=new I("79226673521066979257578248091"),mc=16,fc="59543866431248",pc="184467440737095516",gc="15793534762490258745",Hn=new I(10).pow(new I(6)),jn=new I("18446744073700000000");function fr(e){const t=new ArrayBuffer(4);return new DataView(t).setInt32(0,e,!1),new Uint8Array(t)}function rs(e,t){let n=0;for(let r=e-1;r>=0&&!t.testn(r);r--)n++;return n}function is(e,t){let n=0;for(let r=0;r<e&&!t.testn(r);r++)n++;return n}function Pn(e,t){for(let n=0;n<e;n++)if(t.testn(n))return!1;return!0}function Ac(e,t){return Pn(e,t)?null:rs(e,t)}function hc(e,t){return Pn(e,t)?null:is(e,t)}M.from("amm_config","utf8");var wc=M.from("pool","utf8"),kc=M.from("pool_vault","utf8"),yc=M.from("pool_reward_vault","utf8"),ss=M.from("position","utf8"),Tc=M.from("tick_array","utf8"),bc=M.from("operation","utf8"),Sc=M.from("pool_tick_array_bitmap_extension","utf8");function vc(e,t,n,r){return ct([wc,t.toBuffer(),n.toBuffer(),r.toBuffer()],e)}function wi(e,t,n){return ct([kc,t.toBuffer(),n.toBuffer()],e)}function Ic(e,t,n){return ct([yc,t.toBuffer(),n.toBuffer()],e)}function wt(e,t,n){return ct([Tc,t.toBuffer(),fr(n)],e)}function He(e,t,n,r){return ct([ss,t.toBuffer(),fr(n),fr(r)],e)}function Te(e,t){return ct([ss,t.toBuffer()],e)}function ki(e){return ct([M.from("metadata","utf8"),On.toBuffer(),e.toBuffer()],On)}function Zn(e){return ct([bc],e)}function ie(e,t){return ct([Sc,t.toBuffer()],e)}var Bc=15,dt=class os{static getTickArrays(t,n,r,i,s,o,a){return U(this,null,function*(){const u=[],c=st.getTickArrayStartIndexByTick(i,s),l=st.getInitializedTickArrayInRange(o,a,s,c,Math.floor(Bc/2));for(let m=0;m<l.length;m++){const{publicKey:p}=wt(n,r,l[m]);u.push(p)}const d=(yield ce(t,u)).map(m=>m!==null?pr.decode(m.data):null),f={};for(let m=0;m<u.length;m++){const p=d[m];p!==null&&(f[p.startTickIndex]=yt(Z({},p),{address:u[m]}))}return f})}static nextInitializedTick(t,n,r,i,s,o){let{initializedTick:a,tickArrayAddress:u,tickArrayStartTickIndex:c}=this.nextInitializedTickInOneArray(t,n,r,i,s,o);for(;a==null||a.liquidityGross.lten(0);){if(c=st.getNextTickArrayStartIndex(c,s,o),this.checkIsValidStartIndex(c,s))throw new Error("No enough initialized tickArray");const l=r[c];if(l===void 0)continue;const{nextTick:d,tickArrayAddress:f,tickArrayStartTickIndex:m}=this.firstInitializedTickInOneArray(t,n,l,o);[a,u,c]=[d,f,m]}if(a==null)throw new Error("No invaild tickArray cache");return{nextTick:a,tickArrayAddress:u,tickArrayStartTickIndex:c}}static nextInitializedTickArray(t,n,r,i,s){const o=Math.floor(t/os.tickCount(n)),a=r?st.searchLowBitFromStart(i,s,o-1,1,n):st.searchHightBitFromStart(i,s,o+1,1,n);return a.length>0?{isExist:!0,nextStartIndex:a[0]}:{isExist:!1,nextStartIndex:0}}static firstInitializedTickInOneArray(t,n,r,i){let s;if(i){let a=Et-1;for(;a>=0;){const u=r.ticks[a];if(u.liquidityGross.gtn(0)){s=u;break}a=a-1}}else{let a=0;for(;a<Et;){const u=r.ticks[a];if(u.liquidityGross.gtn(0)){s=u;break}a=a+1}}const{publicKey:o}=wt(t,n,r.startTickIndex);return{nextTick:s,tickArrayAddress:o,tickArrayStartTickIndex:r.startTickIndex}}static nextInitializedTickInOneArray(t,n,r,i,s,o){const a=st.getTickArrayStartIndexByTick(i,s);let u=Math.floor((i-a)/s);const c=r[a];if(c==null)return{initializedTick:void 0,tickArrayAddress:void 0,tickArrayStartTickIndex:a};let l;if(o)for(;u>=0;){const f=c.ticks[u];if(f.liquidityGross.gtn(0)){l=f;break}u=u-1}else for(u=u+1;u<Et;){const f=c.ticks[u];if(f.liquidityGross.gtn(0)){l=f;break}u=u+1}const{publicKey:d}=wt(t,n,a);return{initializedTick:l,tickArrayAddress:d,tickArrayStartTickIndex:c.startTickIndex}}static getArrayStartIndex(t,n){const r=this.tickCount(n);return Math.floor(t/r)*r}static checkIsValidStartIndex(t,n){if(st.checkIsOutOfBoundary(t)){if(t>Xt)return!1;const r=st.getTickArrayStartIndexByTick(Vt,n);return t==r}return t%this.tickCount(n)==0}static tickCount(t){return Et*t}},Et=60,on=512,st=class se{static getTickArrayAddressByTick(t,n,r,i){const s=se.getTickArrayStartIndexByTick(r,i),{publicKey:o}=wt(t,n,s);return o}static getTickOffsetInArray(t,n){if(t%n!=0)throw new Error("tickIndex % tickSpacing not equal 0");const r=se.getTickArrayStartIndexByTick(t,n),i=Math.floor((t-r)/n);if(i<0||i>=Et)throw new Error("tick offset in array overflow");return i}static getTickArrayBitIndex(t,n){const r=dt.tickCount(n);let i=t/r;return t<0&&t%r!=0?i=Math.ceil(i)-1:i=Math.floor(i),i}static getTickArrayStartIndexByTick(t,n){return this.getTickArrayBitIndex(t,n)*dt.tickCount(n)}static getTickArrayOffsetInBitmapByTick(t,n){const r=n*Et,i=Math.floor(t/r)+512;return Math.abs(i)}static checkTickArrayIsInitialized(t,n,r){const i=r*Et,s=Math.floor(n/i)+512,o=Math.abs(s);return{isInitialized:t.testn(o),startIndex:(o-512)*i}}static getNextTickArrayStartIndex(t,n,r){return r?t-n*Et:t+n*Et}static mergeTickArrayBitmap(t){let n=new I(0);for(let r=0;r<t.length;r++)n=n.add(t[r].shln(64*r));return n}static getInitializedTickArrayInRange(t,n,r,i,s){const o=Math.floor(i/(r*Et));return[...se.searchLowBitFromStart(t,n,o-1,s,r),...se.searchHightBitFromStart(t,n,o,s,r)]}static getAllInitializedTickArrayStartIndex(t,n,r){return se.searchHightBitFromStart(t,n,0,on,r)}static getAllInitializedTickArrayInfo(t,n,r,i,s){const o=[],a=se.getAllInitializedTickArrayStartIndex(r,i,s);for(const u of a){const{publicKey:c}=wt(t,n,u);o.push({tickArrayStartIndex:u,tickArrayAddress:c})}return o}static getAllInitializedTickInTickArray(t){return t.ticks.filter(n=>n.liquidityGross.gtn(0))}static searchLowBitFromStart(t,n,r,i,s){const o=[...[...n.negativeTickArrayBitmap].reverse(),t.slice(0,8),t.slice(8,16),...n.positiveTickArrayBitmap].map(c=>se.mergeTickArrayBitmap(c)),a=[];for(;r>=-7680;){const c=Math.floor((r+7680)/512),l=(r+7680)%512;if(o[c].testn(l)&&a.push(r),r--,a.length===i)break}const u=dt.tickCount(s);return a.map(c=>c*u)}static searchHightBitFromStart(t,n,r,i,s){const o=[...[...n.negativeTickArrayBitmap].reverse(),t.slice(0,8),t.slice(8,16),...n.positiveTickArrayBitmap].map(c=>se.mergeTickArrayBitmap(c)),a=[];for(;r<7680;){const c=Math.floor((r+7680)/512),l=(r+7680)%512;if(o[c].testn(l)&&a.push(r),r++,a.length===i)break}const u=dt.tickCount(s);return a.map(c=>c*u)}static checkIsOutOfBoundary(t){return t<Vt||t>Xt}static nextInitTick(t,n,r,i,s){if(dt.getArrayStartIndex(n,r)!=t.startTickIndex)return null;let a=Math.floor((n-t.startTickIndex)/r);if(i)for(;a>=0;){if(t.ticks[a].liquidityGross.gtn(0))return t.ticks[a];a=a-1}else for(s||(a=a+1);a<Et;){if(t.ticks[a].liquidityGross.gtn(0))return t.ticks[a];a=a+1}return null}static firstInitializedTick(t,n){if(n){let r=Et-1;for(;r>=0;){if(t.ticks[r].liquidityGross.gtn(0))return t.ticks[r];r=r-1}}else{let r=0;for(;r<Et;){if(t.ticks[r].liquidityGross.gtn(0))return t.ticks[r];r=r+1}}throw Error(`firstInitializedTick check error: ${t} - ${n}`)}},Rn=14,Ue=class{static maxTickInTickarrayBitmap(e){return e*Et*on}static getBitmapTickBoundary(e,t){const n=this.maxTickInTickarrayBitmap(t);let r=Math.floor(Math.abs(e)/n);e<0&&Math.abs(e)%n!=0&&(r+=1);const i=n*r;return e<0?{minValue:-i,maxValue:-i+n}:{minValue:i,maxValue:i+n}}static nextInitializedTickArrayStartIndex(e,t,n,r){if(!dt.checkIsValidStartIndex(t,n))throw Error("nextInitializedTickArrayStartIndex check error");const i=this.maxTickInTickarrayBitmap(n),s=r?t-dt.tickCount(n):t+dt.tickCount(n);if(s<-i||s>=i)return{isInit:!1,tickIndex:t};const o=n*Et;let a=s/o+512;s<0&&s%o!=0&&a--;const u=Math.abs(a);if(r){const c=e.shln(1024-u-1),l=Ac(1024,c);return l!==null?{isInit:!0,tickIndex:(u-l-512)*o}:{isInit:!1,tickIndex:-i}}else{const c=e.shrn(u),l=hc(1024,c);return l!==null?{isInit:!0,tickIndex:(u+l-512)*o}:{isInit:!1,tickIndex:i-dt.tickCount(n)}}}},yi=class{static getBitmapOffset(e,t){if(!dt.checkIsValidStartIndex(e,t))throw new Error("No enough initialized tickArray");this.checkExtensionBoundary(e,t);const n=Ue.maxTickInTickarrayBitmap(t);let r=Math.floor(Math.abs(e)/n)-1;return e<0&&Math.abs(e)%n===0&&r--,r}static getBitmap(e,t,n){const r=this.getBitmapOffset(e,t);return e<0?{offset:r,tickarrayBitmap:n.negativeTickArrayBitmap[r]}:{offset:r,tickarrayBitmap:n.positiveTickArrayBitmap[r]}}static checkExtensionBoundary(e,t){const{positiveTickBoundary:n,negativeTickBoundary:r}=this.extensionTickBoundary(t);if(e>=r&&e<n)throw Error("checkExtensionBoundary -> InvalidTickArrayBoundary")}static extensionTickBoundary(e){const t=Ue.maxTickInTickarrayBitmap(e),n=-t;if(Xt<=t)throw Error(`extensionTickBoundary check error: ${Xt}, ${t}`);if(n<=Vt)throw Error(`extensionTickBoundary check error: ${n}, ${Vt}`);return{positiveTickBoundary:t,negativeTickBoundary:n}}static checkTickArrayIsInit(e,t,n){const{tickarrayBitmap:r}=this.getBitmap(e,t,n),i=this.tickArrayOffsetInBitmap(e,t);return{isInitialized:st.mergeTickArrayBitmap(r).testn(i),startIndex:e}}static nextInitializedTickArrayFromOneBitmap(e,t,n,r){const i=dt.tickCount(t),s=n?e-i:e+i,o=dt.getArrayStartIndex(Vt,t),a=dt.getArrayStartIndex(Xt,t);if(s<o||s>a)return{isInit:!1,tickIndex:s};const{tickarrayBitmap:u}=this.getBitmap(s,t,r);return this.nextInitializedTickArrayInBitmap(u,s,t,n)}static nextInitializedTickArrayInBitmap(e,t,n,r){const{minValue:i,maxValue:s}=Ue.getBitmapTickBoundary(t,n),o=this.tickArrayOffsetInBitmap(t,n);if(r){const a=st.mergeTickArrayBitmap(e).shln(on-1-o),u=Pn(512,a)?null:rs(512,a);return u!==null?{isInit:!0,tickIndex:t-u*dt.tickCount(n)}:{isInit:!1,tickIndex:i}}else{const a=st.mergeTickArrayBitmap(e).shrn(o),u=Pn(512,a)?null:is(512,a);return u!==null?{isInit:!0,tickIndex:t+u*dt.tickCount(n)}:{isInit:!1,tickIndex:s-dt.tickCount(n)}}}static tickArrayOffsetInBitmap(e,t){const n=Math.abs(e)%Ue.maxTickInTickarrayBitmap(t);let r=Math.floor(n/dt.tickCount(t));return e<0&&n!=0&&(r=on-r),r}};F([Tt(8),V("bump"),tn("index"),q(""),Ut("protocolFeeRate"),Ut("tradeFeeRate"),tn("tickSpacing"),Ut("fundFeeRate"),$(Ut(),1,"padding"),q("fundOwner"),$(y(),3,"padding")]);var Oc=F([Ut("blockTimestamp"),J("sqrtPriceX64"),J("cumulativeTimePriceX64"),$(J(),1,"")]),Ti=F([Tt(8),Yt("initialized"),q("poolId"),$(Oc,1e3,"observations"),$(J(),5,"")]),_c=F([V("rewardState"),y("openTime"),y("endTime"),y("lastUpdateTime"),J("emissionsPerSecondX64"),y("rewardTotalEmissioned"),y("rewardClaimed"),q("tokenMint"),q("tokenVault"),q("creator"),J("rewardGrowthGlobalX64")]),Lc=F([Tt(8),V("bump"),q("ammConfig"),q("creator"),q("mintA"),q("mintB"),q("vaultA"),q("vaultB"),q("observationId"),V("mintDecimalsA"),V("mintDecimalsB"),tn("tickSpacing"),J("liquidity"),J("sqrtPriceX64"),Mt("tickCurrent"),tn("observationIndex"),tn("observationUpdateDuration"),J("feeGrowthGlobalX64A"),J("feeGrowthGlobalX64B"),y("protocolFeesTokenA"),y("protocolFeesTokenB"),J("swapInAmountTokenA"),J("swapOutAmountTokenB"),J("swapInAmountTokenB"),J("swapOutAmountTokenA"),V("status"),$(V(),7,""),$(_c,3,"rewardInfos"),$(y(),16,"tickArrayBitmap"),y("totalFeesTokenA"),y("totalFeesClaimedTokenA"),y("totalFeesTokenB"),y("totalFeesClaimedTokenB"),y("fundFeesTokenA"),y("fundFeesTokenB"),y("startTime"),$(y(),57,"padding")]),Ec=F([J("growthInsideLastX64"),y("rewardAmountOwed")]),Pc=F([Tt(8),V("bump"),q("nftMint"),q("poolId"),Mt("tickLower"),Mt("tickUpper"),J("liquidity"),J("feeGrowthInsideLastX64A"),J("feeGrowthInsideLastX64B"),y("tokenFeesOwedA"),y("tokenFeesOwedB"),$(Ec,3,"rewardInfos"),$(y(),8,"")]);F([Tt(8),V("bump"),q("poolId"),Mt("tickLowerIndex"),Mt("tickUpperIndex"),J("liquidity"),J("feeGrowthInsideLastX64A"),J("feeGrowthInsideLastX64B"),y("tokenFeesOwedA"),y("tokenFeesOwedB"),$(J(),3,"rewardGrowthInside"),$(y(),8,"")]);var Rc=F([Mt("tick"),La("liquidityNet"),J("liquidityGross"),J("feeGrowthOutsideX64A"),J("feeGrowthOutsideX64B"),$(J(),3,"rewardGrowthsOutsideX64"),$(Ut(),13,"")]),pr=F([Tt(8),q("poolId"),Mt("startTickIndex"),$(Rc,Et,"ticks"),V("initializedTickCount"),$(V(),115,"")]),xc=F([Tt(329),$(q(),100,"whitelistMints")]),Mc=F([Tt(8),q("poolId"),$($(y(),8),Rn,"positiveTickArrayBitmap"),$($(y(),8),Rn,"negativeTickArrayBitmap")]),oe=class as{static getOutputAmountAndRemainAccounts(t,n,r,i,s,o=!1){const a=r.equals(t.mintA.mint),u=[],{isExist:c,startIndex:l,nextAccountMeta:d}=this.getFirstInitializedTickArray(t,a);if(!c||l===void 0||!d)throw new Error("Invalid tick array");try{const h=this.preInitializedTickArrayStartIndex(t,a);if(h.isExist){const{publicKey:w}=wt(t.programId,t.id,h.nextStartIndex);u.push(w)}}catch{}u.push(d);const{allTrade:f,amountSpecifiedRemaining:m,amountCalculated:p,accounts:g,sqrtPriceX64:k,feeAmount:A}=bi.swapCompute(t.programId,t.id,n,t.tickArrayBitmap,t.exBitmapInfo,a,t.ammConfig.tradeFeeRate,t.liquidity,t.tickCurrent,t.tickSpacing,t.sqrtPriceX64,i,l,s,o);return u.push(...g),{allTrade:f,realTradeAmountIn:i.sub(m),expectedAmountOut:p.mul(Se),remainingAccounts:u,executionPrice:k,feeAmount:A}}static getInputAmountAndRemainAccounts(t,n,r,i,s){const o=r.equals(t.mintB.mint),a=[],{isExist:u,startIndex:c,nextAccountMeta:l}=this.getFirstInitializedTickArray(t,o);if(!u||c===void 0||!l)throw new Error("Invalid tick array");try{const g=this.preInitializedTickArrayStartIndex(t,o);if(g.isExist){const{publicKey:k}=wt(t.programId,t.id,g.nextStartIndex);a.push(k)}}catch{}a.push(l);const{amountCalculated:d,accounts:f,sqrtPriceX64:m,feeAmount:p}=bi.swapCompute(t.programId,t.id,n,t.tickArrayBitmap,t.exBitmapInfo,o,t.ammConfig.tradeFeeRate,t.liquidity,t.tickCurrent,t.tickSpacing,t.sqrtPriceX64,i.mul(Se),c,s);return a.push(...f),{expectedAmountIn:d,remainingAccounts:a,executionPrice:m,feeAmount:p}}static getFirstInitializedTickArray(t,n){const{isInitialized:r,startIndex:i}=as.isOverflowDefaultTickarrayBitmap(t.tickSpacing,[t.tickCurrent])?yi.checkTickArrayIsInit(dt.getArrayStartIndex(t.tickCurrent,t.tickSpacing),t.tickSpacing,t.exBitmapInfo):st.checkTickArrayIsInitialized(st.mergeTickArrayBitmap(t.tickArrayBitmap),t.tickCurrent,t.tickSpacing);if(r){const{publicKey:a}=wt(t.programId,t.id,i);return{isExist:!0,startIndex:i,nextAccountMeta:a}}const{isExist:s,nextStartIndex:o}=this.nextInitializedTickArrayStartIndex(t,dt.getArrayStartIndex(t.tickCurrent,t.tickSpacing),n);if(s){const{publicKey:a}=wt(t.programId,t.id,o);return{isExist:!0,startIndex:o,nextAccountMeta:a}}return{isExist:!1,nextAccountMeta:void 0,startIndex:void 0}}static preInitializedTickArrayStartIndex(t,n){const r=Math.floor(t.tickCurrent/dt.tickCount(t.tickSpacing)),i=n?st.searchHightBitFromStart(t.tickArrayBitmap,t.exBitmapInfo,r+1,1,t.tickSpacing):st.searchLowBitFromStart(t.tickArrayBitmap,t.exBitmapInfo,r-1,1,t.tickSpacing);return i.length>0?{isExist:!0,nextStartIndex:i[0]}:{isExist:!1,nextStartIndex:0}}static nextInitializedTickArrayStartIndex(t,n,r){for(n=dt.getArrayStartIndex(n,t.tickSpacing);;){const{isInit:i,tickIndex:s}=Ue.nextInitializedTickArrayStartIndex(st.mergeTickArrayBitmap(t.tickArrayBitmap),n,t.tickSpacing,r);if(i)return{isExist:!0,nextStartIndex:s};n=s;const{isInit:o,tickIndex:a}=yi.nextInitializedTickArrayFromOneBitmap(n,t.tickSpacing,r,t.exBitmapInfo);if(o)return{isExist:!0,nextStartIndex:a};if(n=a,n<Vt||n>Xt)return{isExist:!1,nextStartIndex:0}}}static updatePoolRewardInfos(t){return U(this,arguments,function*({connection:n,apiPoolInfo:r,chainTime:i,poolLiquidity:s,rewardInfos:o}){var a,u,c;const l=[];for(let d=0;d<o.length;d++){const f=o[d],m=(c=(a=r.rewardInfos[d])==null?void 0:a.programId)!=null?c:(u=yield n.getAccountInfo(f.tokenMint))==null?void 0:u.owner;if(m===void 0)throw Error("get new reward mint info error");const p=yt(Z({},f),{perSecond:ot.x64ToDecimal(f.emissionsPerSecondX64),remainingRewards:void 0,tokenProgramId:new R(m)});if(p.tokenMint.equals(R.default))continue;if(i<=p.openTime.toNumber()||s.eq(Y)){l.push(p);continue}const g=new I(Math.min(p.endTime.toNumber(),i)),k=g.sub(p.lastUpdateTime),A=ot.mulDivFloor(k,p.emissionsPerSecondX64,s),h=p.rewardGrowthGlobalX64.add(A),w=ot.mulDivFloor(k,p.emissionsPerSecondX64,_e),T=p.rewardTotalEmissioned.add(w);l.push(yt(Z({},p),{rewardGrowthGlobalX64:h,rewardTotalEmissioned:T,lastUpdateTime:g}))}return l})}static isOverflowDefaultTickarrayBitmap(t,n){const{maxTickBoundary:r,minTickBoundary:i}=this.tickRange(t);for(const s of n){const o=st.getTickArrayStartIndexByTick(s,t);if(o>=r||o<i)return!0}return!1}static tickRange(t){let n=Ue.maxTickInTickarrayBitmap(t),r=-n;return n>Xt&&(n=dt.getArrayStartIndex(Xt,t)+dt.tickCount(t)),r<Vt&&(r=dt.getArrayStartIndex(Vt,t)),{maxTickBoundary:n,minTickBoundary:r}}static get_tick_array_offset(t,n){if(!dt.checkIsValidStartIndex(t,n))throw new Error("No enough initialized tickArray");return t/dt.tickCount(n)*on}},ot=class{static mulDivRoundingUp(e,t,n){const r=e.mul(t);let i=r.div(n);return r.mod(n).eq(Y)||(i=i.add(gt)),i}static mulDivFloor(e,t,n){if(n.eq(Y))throw new Error("division by 0");return e.mul(t).div(n)}static mulDivCeil(e,t,n){if(n.eq(Y))throw new Error("division by 0");return e.mul(t).add(n.sub(gt)).div(n)}static x64ToDecimal(e,t){return new j(e.toString()).div(j.pow(2,64)).toDecimalPlaces(t)}static decimalToX64(e){return new I(e.mul(j.pow(2,64)).floor().toFixed())}static wrappingSubU128(e,t){return e.add(mr).sub(t).mod(mr)}};function It(e,t){return gr(e.mul(t),64,256)}function qc(e,t,n){const r=e.toTwos(n).shln(t);return r.imaskn(n+1),r.fromTwos(n)}function gr(e,t,n){const r=e.toTwos(n).shrn(t);return r.imaskn(n-t+1),r.fromTwos(n-t)}var ut=class Tn{static sqrtPriceX64ToPrice(t,n,r){return ot.x64ToDecimal(t).pow(2).mul(j.pow(10,n-r))}static priceToSqrtPriceX64(t,n,r){return ot.decimalToX64(t.mul(j.pow(10,r-n)).sqrt())}static getNextSqrtPriceX64FromInput(t,n,r,i){if(!t.gt(Y))throw new Error("sqrtPriceX64 must greater than 0");if(!n.gt(Y))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountARoundingUp(t,n,r,!0):this.getNextSqrtPriceFromTokenAmountBRoundingDown(t,n,r,!0)}static getNextSqrtPriceX64FromOutput(t,n,r,i){if(!t.gt(Y))throw new Error("sqrtPriceX64 must greater than 0");if(!n.gt(Y))throw new Error("liquidity must greater than 0");return i?this.getNextSqrtPriceFromTokenAmountBRoundingDown(t,n,r,!1):this.getNextSqrtPriceFromTokenAmountARoundingUp(t,n,r,!1)}static getNextSqrtPriceFromTokenAmountARoundingUp(t,n,r,i){if(r.eq(Y))return t;const s=n.shln(En);if(i){const o=s,a=s.add(r.mul(t));return a.gte(o)?ot.mulDivCeil(o,t,a):ot.mulDivRoundingUp(o,gt,o.div(t).add(r))}else{const o=r.mul(t);if(!s.gt(o))throw new Error("getNextSqrtPriceFromTokenAmountARoundingUp,liquidityLeftShift must gt amountMulSqrtPrice");const a=s.sub(o);return ot.mulDivCeil(s,t,a)}}static getNextSqrtPriceFromTokenAmountBRoundingDown(t,n,r,i){const s=r.shln(En);if(i)return t.add(s.div(n));{const o=ot.mulDivRoundingUp(s,gt,n);if(!t.gt(o))throw new Error("getNextSqrtPriceFromTokenAmountBRoundingDown sqrtPriceX64 must gt amountDivLiquidity");return t.sub(o)}}static getSqrtPriceX64FromTick(t){if(!Number.isInteger(t))throw new Error("tick must be integer");if(t<Vt||t>Xt)throw new Error("tick must be in MIN_TICK and MAX_TICK");const n=t<0?t*-1:t;let r=(n&1)!=0?new I("18445821805675395072"):new I("18446744073709551616");return(n&2)!=0&&(r=It(r,new I("18444899583751176192"))),(n&4)!=0&&(r=It(r,new I("18443055278223355904"))),(n&8)!=0&&(r=It(r,new I("18439367220385607680"))),(n&16)!=0&&(r=It(r,new I("18431993317065453568"))),(n&32)!=0&&(r=It(r,new I("18417254355718170624"))),(n&64)!=0&&(r=It(r,new I("18387811781193609216"))),(n&128)!=0&&(r=It(r,new I("18329067761203558400"))),(n&256)!=0&&(r=It(r,new I("18212142134806163456"))),(n&512)!=0&&(r=It(r,new I("17980523815641700352"))),(n&1024)!=0&&(r=It(r,new I("17526086738831433728"))),(n&2048)!=0&&(r=It(r,new I("16651378430235570176"))),(n&4096)!=0&&(r=It(r,new I("15030750278694412288"))),(n&8192)!=0&&(r=It(r,new I("12247334978884435968"))),(n&16384)!=0&&(r=It(r,new I("8131365268886854656"))),(n&32768)!=0&&(r=It(r,new I("3584323654725218816"))),(n&65536)!=0&&(r=It(r,new I("696457651848324352"))),(n&131072)!=0&&(r=It(r,new I("26294789957507116"))),(n&262144)!=0&&(r=It(r,new I("37481735321082"))),t>0&&(r=dc.div(r)),r}static getTickFromPrice(t,n,r){return Tn.getTickFromSqrtPriceX64(Tn.priceToSqrtPriceX64(t,n,r))}static getTickFromSqrtPriceX64(t){if(t.gt(Be)||t.lt(Ie))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const n=t.bitLength()-1,r=new I(n-64),i=qc(r,32,128);let s=new I("8000000000000000","hex"),o=0,a=new I(0),u=n>=64?t.shrn(n-63):t.shln(63-n);for(;s.gt(new I(0))&&o<mc;){u=u.mul(u);const p=u.shrn(127);u=u.shrn(63+p.toNumber()),a=a.add(s.mul(p)),s=s.shrn(1),o+=1}const c=a.shrn(32),d=i.add(c).mul(new I(fc)),f=gr(d.sub(new I(pc)),64,128).toNumber(),m=gr(d.add(new I(gc)),64,128).toNumber();return f==m?f:Tn.getSqrtPriceX64FromTick(m).lte(t)?m:f}},Nc=class cs{static getTickWithPriceAndTickspacing(t,n,r,i){let o=ut.getTickFromSqrtPriceX64(ut.priceToSqrtPriceX64(t,r,i))/n;return o<0?o=Math.floor(o):o=Math.ceil(o),o*n}static roundPriceWithTickspacing(t,n,r,i){const s=cs.getTickWithPriceAndTickspacing(t,n,r,i),o=ut.getSqrtPriceX64FromTick(s);return ut.sqrtPriceX64ToPrice(o,r,i)}},Bt=class jt{static addDelta(t,n){return t.add(n)}static getTokenAmountAFromLiquidity(t,n,r,i){if(t.gt(n)&&([t,n]=[n,t]),!t.gt(Y))throw new Error("sqrtPriceX64A must greater than 0");const s=r.ushln(En),o=n.sub(t);return i?ot.mulDivRoundingUp(ot.mulDivCeil(s,o,n),gt,t):ot.mulDivFloor(s,o,n).div(t)}static getTokenAmountBFromLiquidity(t,n,r,i){if(t.gt(n)&&([t,n]=[n,t]),!t.gt(Y))throw new Error("sqrtPriceX64A must greater than 0");return i?ot.mulDivCeil(r,n.sub(t),_e):ot.mulDivFloor(r,n.sub(t),_e)}static getLiquidityFromTokenAmountA(t,n,r,i){t.gt(n)&&([t,n]=[n,t]);const s=r.mul(t).mul(n),o=n.sub(t),a=s.div(o);return i?ot.mulDivRoundingUp(a,gt,hi):a.shrn(En)}static getLiquidityFromTokenAmountB(t,n,r){return t.gt(n)&&([t,n]=[n,t]),ot.mulDivFloor(r,hi,n.sub(t))}static getLiquidityFromTokenAmounts(t,n,r,i,s){if(n.gt(r)&&([n,r]=[r,n]),t.lte(n))return jt.getLiquidityFromTokenAmountA(n,r,i,!1);if(t.lt(r)){const o=jt.getLiquidityFromTokenAmountA(t,r,i,!1),a=jt.getLiquidityFromTokenAmountB(n,t,s);return o.lt(a)?o:a}else return jt.getLiquidityFromTokenAmountB(n,r,s)}static getAmountsFromLiquidity(t,n,r,i,s){if(n.gt(r)&&([n,r]=[r,n]),t.lte(n))return{amountA:jt.getTokenAmountAFromLiquidity(n,r,i,s),amountB:new I(0)};if(t.lt(r)){const o=jt.getTokenAmountAFromLiquidity(t,r,i,s),a=jt.getTokenAmountBFromLiquidity(n,t,i,s);return{amountA:o,amountB:a}}else return{amountA:new I(0),amountB:jt.getTokenAmountBFromLiquidity(n,r,i,s)}}static getAmountsFromLiquidityWithSlippage(t,n,r,i,s,o,a){const{amountA:u,amountB:c}=jt.getAmountsFromLiquidity(t,n,r,i,o),l=s?1+a:1-a,d=new I(new j(u.toString()).mul(l).toFixed(0)),f=new I(new j(c.toString()).mul(l).toFixed(0));return{amountSlippageA:d,amountSlippageB:f}}},bi=class us{static swapCompute(t,n,r,i,s,o,a,u,c,l,d,f,m,p,g=!1){if(f.eq(Y))throw new Error("amountSpecified must not be 0");if(p||(p=o?Ie.add(gt):Be.sub(gt)),o){if(p.lt(Ie))throw new Error("sqrtPriceX64 must greater than MIN_SQRT_PRICE_X64");if(p.gte(d))throw new Error("sqrtPriceX64 must smaller than current")}else{if(p.gt(Be))throw new Error("sqrtPriceX64 must smaller than MAX_SQRT_PRICE_X64");if(p.lte(d))throw new Error("sqrtPriceX64 must greater than current")}const k=f.gt(Y),A={amountSpecifiedRemaining:f,amountCalculated:Y,sqrtPriceX64:d,tick:c>m?Math.min(m+dt.tickCount(l)-1,c):m,accounts:[],liquidity:u,feeAmount:new I(0)};let h=m,w=r[m],T=!o&&w.startTickIndex===A.tick;for(;!A.amountSpecifiedRemaining.eq(Y)&&!A.sqrtPriceX64.eq(p);){const b={};b.sqrtPriceStartX64=A.sqrtPriceX64;const v=st.nextInitTick(w,A.tick,l,o,T);let S=v||null,P=null;if(!(S!=null&&S.liquidityGross.gtn(0))){const L=oe.nextInitializedTickArrayStartIndex({tickCurrent:A.tick,tickSpacing:l,tickArrayBitmap:i,exBitmapInfo:s},h,o);if(!L.isExist){if(g)return{allTrade:!1,amountSpecifiedRemaining:A.amountSpecifiedRemaining,amountCalculated:A.amountCalculated,feeAmount:A.feeAmount,sqrtPriceX64:A.sqrtPriceX64,liquidity:A.liquidity,tickCurrent:A.tick,accounts:A.accounts};throw Error("swapCompute LiquidityInsufficient")}h=L.nextStartIndex;const{publicKey:_}=wt(t,n,h);P=_,w=r[h];try{S=st.firstInitializedTick(w,o)}catch{throw Error("not found next tick info")}}b.tickNext=S.tick,b.initialized=S.liquidityGross.gtn(0),m!==h&&P&&(A.accounts.push(P),m=h),b.tickNext<Vt?b.tickNext=Vt:b.tickNext>Xt&&(b.tickNext=Xt),b.sqrtPriceNextX64=ut.getSqrtPriceX64FromTick(b.tickNext);let O;if(o&&b.sqrtPriceNextX64.lt(p)||!o&&b.sqrtPriceNextX64.gt(p)?O=p:O=b.sqrtPriceNextX64,[A.sqrtPriceX64,b.amountIn,b.amountOut,b.feeAmount]=us.swapStepCompute(A.sqrtPriceX64,O,A.liquidity,A.amountSpecifiedRemaining,a),A.feeAmount=A.feeAmount.add(b.feeAmount),k?(A.amountSpecifiedRemaining=A.amountSpecifiedRemaining.sub(b.amountIn.add(b.feeAmount)),A.amountCalculated=A.amountCalculated.sub(b.amountOut)):(A.amountSpecifiedRemaining=A.amountSpecifiedRemaining.add(b.amountOut),A.amountCalculated=A.amountCalculated.add(b.amountIn.add(b.feeAmount))),A.sqrtPriceX64.eq(b.sqrtPriceNextX64)){if(b.initialized){let L=S.liquidityNet;o&&(L=L.mul(Se)),A.liquidity=Bt.addDelta(A.liquidity,L)}T=b.tickNext!=A.tick&&!o&&w.startTickIndex===b.tickNext,A.tick=o?b.tickNext-1:b.tickNext}else if(A.sqrtPriceX64!=b.sqrtPriceStartX64){const L=ut.getTickFromSqrtPriceX64(A.sqrtPriceX64);T=L!=A.tick&&!o&&w.startTickIndex===L,A.tick=L}}try{const{nextStartIndex:b,isExist:v}=dt.nextInitializedTickArray(A.tick,l,o,i,s);v&&m!==b&&(A.accounts.push(wt(t,n,b).publicKey),m=b)}catch{}return{allTrade:!0,amountSpecifiedRemaining:Y,amountCalculated:A.amountCalculated,feeAmount:A.feeAmount,sqrtPriceX64:A.sqrtPriceX64,liquidity:A.liquidity,tickCurrent:A.tick,accounts:A.accounts}}static swapStepCompute(t,n,r,i,s){const o={sqrtPriceX64Next:new I(0),amountIn:new I(0),amountOut:new I(0),feeAmount:new I(0)},a=t.gte(n),u=i.gte(Y);if(u){const l=ot.mulDivFloor(i,Hn.sub(new I(s.toString())),Hn);o.amountIn=a?Bt.getTokenAmountAFromLiquidity(n,t,r,!0):Bt.getTokenAmountBFromLiquidity(t,n,r,!0),l.gte(o.amountIn)?o.sqrtPriceX64Next=n:o.sqrtPriceX64Next=ut.getNextSqrtPriceX64FromInput(t,r,l,a)}else o.amountOut=a?Bt.getTokenAmountBFromLiquidity(n,t,r,!1):Bt.getTokenAmountAFromLiquidity(t,n,r,!1),i.mul(Se).gte(o.amountOut)?o.sqrtPriceX64Next=n:o.sqrtPriceX64Next=ut.getNextSqrtPriceX64FromOutput(t,r,i.mul(Se),a);const c=n.eq(o.sqrtPriceX64Next);return a?(c&&u||(o.amountIn=Bt.getTokenAmountAFromLiquidity(o.sqrtPriceX64Next,t,r,!0)),c&&!u||(o.amountOut=Bt.getTokenAmountBFromLiquidity(o.sqrtPriceX64Next,t,r,!1))):(o.amountIn=c&&u?o.amountIn:Bt.getTokenAmountBFromLiquidity(t,o.sqrtPriceX64Next,r,!0),o.amountOut=c&&!u?o.amountOut:Bt.getTokenAmountAFromLiquidity(t,o.sqrtPriceX64Next,r,!1)),!u&&o.amountOut.gt(i.mul(Se))&&(o.amountOut=i.mul(Se)),u&&!o.sqrtPriceX64Next.eq(n)?o.feeAmount=i.sub(o.amountIn):o.feeAmount=ot.mulDivCeil(o.amountIn,new I(s),Hn.sub(new I(s))),[o.sqrtPriceX64Next,o.amountIn,o.amountOut,o.feeAmount]}},Si=class{static getfeeGrowthInside(e,t,n){let r=new I(0),i=new I(0);e.tickCurrent>=t.tick?(r=t.feeGrowthOutsideX64A,i=t.feeGrowthOutsideX64B):(r=e.feeGrowthGlobalX64A.sub(t.feeGrowthOutsideX64A),i=e.feeGrowthGlobalX64B.sub(t.feeGrowthOutsideX64B));let s=new I(0),o=new I(0);e.tickCurrent<n.tick?(s=n.feeGrowthOutsideX64A,o=n.feeGrowthOutsideX64B):(s=e.feeGrowthGlobalX64A.sub(n.feeGrowthOutsideX64A),o=e.feeGrowthGlobalX64B.sub(n.feeGrowthOutsideX64B));const a=ot.wrappingSubU128(ot.wrappingSubU128(e.feeGrowthGlobalX64A,r),s),u=ot.wrappingSubU128(ot.wrappingSubU128(e.feeGrowthGlobalX64B,i),o);return{feeGrowthInsideX64A:a,feeGrowthInsideBX64:u}}static GetPositionFees(e,t,n,r){const{feeGrowthInsideX64A:i,feeGrowthInsideBX64:s}=this.getfeeGrowthInside(e,n,r),o=ot.mulDivFloor(ot.wrappingSubU128(i,t.feeGrowthInsideLastX64A),t.liquidity,_e),a=t.tokenFeesOwedA.add(o),u=ot.mulDivFloor(ot.wrappingSubU128(s,t.feeGrowthInsideLastX64B),t.liquidity,_e),c=t.tokenFeesOwedB.add(u);return{tokenFeeAmountA:a,tokenFeeAmountB:c}}static GetPositionRewards(e,t,n,r){const i=[],s=this.getRewardGrowthInside(e.tickCurrent,n,r,e.rewardInfos);for(let o=0;o<s.length;o++){const a=s[o],u=t.rewardInfos[o],c=ot.wrappingSubU128(a,u.growthInsideLastX64),l=ot.mulDivFloor(c,t.liquidity,_e),d=u.rewardAmountOwed.add(l);i.push(d)}return i}static getRewardGrowthInside(e,t,n,r){const i=[];for(let s=0;s<r.length;s++){let o=new I(0);t.liquidityGross.eqn(0)?o=r[s].rewardGrowthGlobalX64:e<t.tick?o=r[s].rewardGrowthGlobalX64.sub(t.rewardGrowthsOutsideX64[s]):o=t.rewardGrowthsOutsideX64[s];let a=new I(0);n.liquidityGross.eqn(0)||(e<n.tick?a=n.rewardGrowthsOutsideX64[s]:a=r[s].rewardGrowthGlobalX64.sub(n.rewardGrowthsOutsideX64[s])),i.push(ot.wrappingSubU128(ot.wrappingSubU128(r[s].rewardGrowthGlobalX64,o),a))}return i}},ht=_t.from("Clmm"),Cc=class extends Fn{static makeMockPoolInfo({programId:e,mint1:t,mint2:n,ammConfig:r,createPoolInstructionSimpleAddress:i,initialPrice:s,startTime:o,owner:a}){const[u,c,l]=new I(t.mint.toBuffer()).gt(new I(n.mint.toBuffer()))?[n,t,new j(1).div(s)]:[t,n,s],d=ut.priceToSqrtPriceX64(l,u.decimals,c.decimals);return{id:i.poolId,mintA:{programId:i.mintProgramIdA,mint:i.mintA,vault:i.mintAVault,decimals:u.decimals},mintB:{programId:i.mintProgramIdB,mint:i.mintB,vault:i.mintBVault,decimals:c.decimals},ammConfig:r,observationId:i.observationId,creator:a,programId:e,version:6,tickSpacing:r.tickSpacing,liquidity:Y,sqrtPriceX64:d,currentPrice:l,tickCurrent:0,observationIndex:0,observationUpdateDuration:0,feeGrowthGlobalX64A:Y,feeGrowthGlobalX64B:Y,protocolFeesTokenA:Y,protocolFeesTokenB:Y,swapInAmountTokenA:Y,swapOutAmountTokenB:Y,swapInAmountTokenB:Y,swapOutAmountTokenA:Y,tickArrayBitmap:[],rewardInfos:[],day:{volume:0,volumeFee:0,feeA:0,feeB:0,feeApr:0,rewardApr:{A:0,B:0,C:0},apr:0,priceMax:0,priceMin:0},week:{volume:0,volumeFee:0,feeA:0,feeB:0,feeApr:0,rewardApr:{A:0,B:0,C:0},apr:0,priceMax:0,priceMin:0},month:{volume:0,volumeFee:0,feeA:0,feeB:0,feeApr:0,rewardApr:{A:0,B:0,C:0},apr:0,priceMax:0,priceMin:0},tvl:0,lookupTableAccount:R.default,startTime:o.toNumber(),exBitmapInfo:{poolId:i.poolId,positiveTickArrayBitmap:Array.from({length:Rn},()=>Array.from({length:8},()=>new I(0))),negativeTickArrayBitmap:Array.from({length:Rn},()=>Array.from({length:8},()=>new I(0)))}}}static makeCreatePoolInstructionSimple(e){return U(this,arguments,function*({makeTxVersion:t,connection:n,programId:r,owner:i,payer:s,mint1:o,mint2:a,ammConfig:u,initialPrice:c,startTime:l,computeBudgetConfig:d,lookupTableCache:f}){const[m,p,g]=new I(o.mint.toBuffer()).gt(new I(a.mint.toBuffer()))?[a,o,new j(1).div(c)]:[o,a,c],k=ut.priceToSqrtPriceX64(g,m.decimals,p.decimals),A=yield this.makeCreatePoolInstructions({connection:n,programId:r,owner:i,mintA:m,mintB:p,ammConfigId:u.id,initialPriceX64:k,startTime:l});return{address:yt(Z({},A.address),{mintA:m.mint,mintB:p.mint,mintProgramIdA:m.programId,mintProgramIdB:p.programId}),innerTransactions:yield at({connection:n,makeTxVersion:t,computeBudgetConfig:d,payer:s,innerTransaction:[A.innerTransaction],lookupTableCache:f})}})}static makeOpenPositionFromLiquidityInstructionSimple(e){return U(this,arguments,function*({makeTxVersion:t,connection:n,poolInfo:r,ownerInfo:i,amountMaxA:s,amountMaxB:o,tickLower:a,tickUpper:u,liquidity:c,associatedOnly:l=!0,checkCreateATAOwner:d=!1,withMetadata:f="create",getEphemeralSigners:m,computeBudgetConfig:p,lookupTableCache:g}){const k=[],A=[],h=[],w=[],T=[],b=i.useSOLBalance&&r.mintA.mint.equals(C.WSOL.mint),v=i.useSOLBalance&&r.mintB.mint.equals(C.WSOL.mint),S=yield this._selectOrCreateTokenAccount({programId:r.mintA.programId,mint:r.mintA.mint,tokenAccounts:b?[]:i.tokenAccounts,owner:i.wallet,createInfo:b||s.eq(Y)?{connection:n,payer:i.feePayer,amount:s,frontInstructions:k,endInstructions:A,frontInstructionsType:h,endInstructionsType:w,signers:T}:void 0,associatedOnly:b?!1:l,checkCreateATAOwner:d}),P=yield this._selectOrCreateTokenAccount({programId:r.mintB.programId,mint:r.mintB.mint,tokenAccounts:v?[]:i.tokenAccounts,owner:i.wallet,createInfo:v||o.eq(Y)?{connection:n,payer:i.feePayer,amount:o,frontInstructions:k,endInstructions:A,frontInstructionsType:h,endInstructionsType:w,signers:T}:void 0,associatedOnly:v?!1:l,checkCreateATAOwner:d});ht.assertArgument(S!==void 0&&P!==void 0,"cannot found target token accounts","tokenAccounts",i.tokenAccounts);const O=yield this.makeOpenPositionFromLiquidityInstructions({poolInfo:r,ownerInfo:yt(Z({},i),{tokenAccountA:S,tokenAccountB:P}),tickLower:a,tickUpper:u,liquidity:c,amountMaxA:s,amountMaxB:o,withMetadata:f,getEphemeralSigners:m});return{address:O.address,innerTransactions:yield at({connection:n,makeTxVersion:t,computeBudgetConfig:p,payer:i.feePayer,innerTransaction:[{instructionTypes:h,instructions:k,signers:T},O.innerTransaction,{instructionTypes:w,instructions:A,signers:[]}],lookupTableCache:g})}})}static makeOpenPositionFromBaseInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,tickLower:i,tickUpper:s,base:o,baseAmount:a,otherAmountMax:u,associatedOnly:c=!0,checkCreateATAOwner:l=!1,computeBudgetConfig:d,withMetadata:f="create",makeTxVersion:m,lookupTableCache:p,getEphemeralSigners:g}){const k=[],A=[],h=[],w=[],T=[],b=r.useSOLBalance&&n.mintA.mint.equals(C.WSOL.mint),v=r.useSOLBalance&&n.mintB.mint.equals(C.WSOL.mint),S=yield this._selectOrCreateTokenAccount({programId:n.mintA.programId,mint:n.mintA.mint,tokenAccounts:b?[]:r.tokenAccounts,owner:r.wallet,createInfo:b?{connection:t,payer:r.feePayer,amount:o==="MintA"?a:u,frontInstructions:k,endInstructions:A,frontInstructionsType:h,endInstructionsType:w,signers:T}:void 0,associatedOnly:b?!1:c,checkCreateATAOwner:l}),P=yield this._selectOrCreateTokenAccount({programId:n.mintB.programId,mint:n.mintB.mint,tokenAccounts:v?[]:r.tokenAccounts,owner:r.wallet,createInfo:v?{connection:t,payer:r.feePayer,amount:o==="MintA"?u:a,frontInstructions:k,endInstructions:A,frontInstructionsType:h,endInstructionsType:w,signers:T}:void 0,associatedOnly:v?!1:c,checkCreateATAOwner:l});ht.assertArgument(S!==void 0&&P!==void 0,"cannot found target token accounts","tokenAccounts",r.tokenAccounts);const O=yield this.makeOpenPositionFromBaseInstructions({poolInfo:n,ownerInfo:yt(Z({},r),{tokenAccountA:S,tokenAccountB:P}),tickLower:i,tickUpper:s,base:o,baseAmount:a,otherAmountMax:u,withMetadata:f,getEphemeralSigners:g});return{address:O.address,innerTransactions:yield at({connection:t,makeTxVersion:m,computeBudgetConfig:d,payer:r.feePayer,innerTransaction:[{instructionTypes:h,instructions:k,signers:T},O.innerTransaction,{instructionTypes:w,instructions:A,signers:[]}],lookupTableCache:p})}})}static makeIncreasePositionFromLiquidityInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerPosition:r,ownerInfo:i,amountMaxA:s,amountMaxB:o,liquidity:a,associatedOnly:u=!0,checkCreateATAOwner:c=!1,computeBudgetConfig:l,makeTxVersion:d,lookupTableCache:f}){const m=[],p=[],g=[],k=[],A=[],h=i.useSOLBalance&&n.mintA.mint.equals(C.WSOL.mint),w=i.useSOLBalance&&n.mintB.mint.equals(C.WSOL.mint),T=yield this._selectOrCreateTokenAccount({programId:n.mintA.programId,mint:n.mintA.mint,tokenAccounts:h?[]:i.tokenAccounts,owner:i.wallet,createInfo:h?{connection:t,payer:i.feePayer,amount:s,frontInstructions:m,endInstructions:p,frontInstructionsType:g,endInstructionsType:k,signers:A}:void 0,associatedOnly:h?!1:u,checkCreateATAOwner:c}),b=yield this._selectOrCreateTokenAccount({programId:n.mintB.programId,mint:n.mintB.mint,tokenAccounts:w?[]:i.tokenAccounts,owner:i.wallet,createInfo:w?{connection:t,payer:i.feePayer,amount:o,frontInstructions:m,endInstructions:p,frontInstructionsType:g,endInstructionsType:k,signers:A}:void 0,associatedOnly:w?!1:u,checkCreateATAOwner:c});ht.assertArgument(!!T||!!b,"cannot found target token accounts","tokenAccounts",i.tokenAccounts);const v=this.makeIncreasePositionFromLiquidityInstructions({poolInfo:n,ownerPosition:r,ownerInfo:{wallet:i.wallet,tokenAccountA:T,tokenAccountB:b},liquidity:a,amountMaxA:s,amountMaxB:o});return{address:v.address,innerTransactions:yield at({connection:t,makeTxVersion:d,computeBudgetConfig:l,payer:i.feePayer,innerTransaction:[{instructionTypes:g,instructions:m,signers:A},v.innerTransaction,{instructionTypes:k,instructions:p,signers:[]}],lookupTableCache:f})}})}static makeIncreasePositionFromBaseInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerPosition:r,ownerInfo:i,base:s,baseAmount:o,otherAmountMax:a,associatedOnly:u=!0,checkCreateATAOwner:c=!1,computeBudgetConfig:l,makeTxVersion:d,lookupTableCache:f}){const m=[],p=[],g=[],k=[],A=[],h=i.useSOLBalance&&n.mintA.mint.equals(C.WSOL.mint),w=i.useSOLBalance&&n.mintB.mint.equals(C.WSOL.mint),T=yield this._selectOrCreateTokenAccount({programId:n.mintA.programId,mint:n.mintA.mint,tokenAccounts:h?[]:i.tokenAccounts,owner:i.wallet,createInfo:h?{connection:t,payer:i.feePayer,amount:s==="MintA"?o:a,frontInstructions:m,endInstructions:p,frontInstructionsType:g,endInstructionsType:k,signers:A}:void 0,associatedOnly:h?!1:u,checkCreateATAOwner:c}),b=yield this._selectOrCreateTokenAccount({programId:n.mintB.programId,mint:n.mintB.mint,tokenAccounts:w?[]:i.tokenAccounts,owner:i.wallet,createInfo:w?{connection:t,payer:i.feePayer,amount:s==="MintA"?a:o,frontInstructions:m,endInstructions:p,frontInstructionsType:g,endInstructionsType:k,signers:A}:void 0,associatedOnly:w?!1:u,checkCreateATAOwner:c});ht.assertArgument(!!T||!!b,"cannot found target token accounts","tokenAccounts",i.tokenAccounts);const v=this.makeIncreasePositionFromBaseInstructions({poolInfo:n,ownerPosition:r,ownerInfo:{wallet:i.wallet,tokenAccountA:T,tokenAccountB:b},base:s,baseAmount:o,otherAmountMax:a});return{address:v.address,innerTransactions:yield at({connection:t,makeTxVersion:d,computeBudgetConfig:l,payer:i.feePayer,innerTransaction:[{instructionTypes:g,instructions:m,signers:A},v.innerTransaction,{instructionTypes:k,instructions:p,signers:[]}],lookupTableCache:f})}})}static makeDecreaseLiquidityInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerPosition:r,ownerInfo:i,liquidity:s,amountMinA:o,amountMinB:a,associatedOnly:u=!0,checkCreateATAOwner:c=!1,computeBudgetConfig:l,makeTxVersion:d,lookupTableCache:f}){const m=[],p=[],g=[],k=[],A=[],h=i.useSOLBalance&&n.mintA.mint.equals(C.WSOL.mint),w=i.useSOLBalance&&n.mintB.mint.equals(C.WSOL.mint),T=yield this._selectOrCreateTokenAccount({programId:n.mintA.programId,mint:n.mintA.mint,tokenAccounts:h?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:t,payer:i.feePayer,amount:0,frontInstructions:m,frontInstructionsType:g,endInstructions:h?p:[],endInstructionsType:h?k:[],signers:A},associatedOnly:h?!1:u,checkCreateATAOwner:c}),b=yield this._selectOrCreateTokenAccount({programId:n.mintB.programId,mint:n.mintB.mint,tokenAccounts:w?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:t,payer:i.feePayer,amount:0,frontInstructions:m,frontInstructionsType:g,endInstructions:w?p:[],endInstructionsType:w?k:[],signers:A},associatedOnly:w?!1:u,checkCreateATAOwner:c}),v=[];for(const O of n.rewardInfos){const L=i.useSOLBalance&&O.tokenMint.equals(C.WSOL.mint),_=O.tokenMint.equals(n.mintA.mint)?T:O.tokenMint.equals(n.mintB.mint)?b:yield this._selectOrCreateTokenAccount({programId:O.tokenProgramId,mint:O.tokenMint,tokenAccounts:L?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:t,payer:i.feePayer,amount:0,frontInstructions:m,frontInstructionsType:g,endInstructions:L?p:[],endInstructionsType:L?k:[],signers:A},associatedOnly:L?!1:u,checkCreateATAOwner:c});v.push(_)}ht.assertArgument(!!T||!!b,"cannot found target token accounts","tokenAccounts",i.tokenAccounts);const S=this.makeDecreaseLiquidityInstructions({poolInfo:n,ownerPosition:r,ownerInfo:{wallet:i.wallet,tokenAccountA:T,tokenAccountB:b,rewardAccounts:v},liquidity:s,amountMinA:o,amountMinB:a}),P=i.closePosition?this.makeClosePositionInstructions({poolInfo:n,ownerInfo:i,ownerPosition:r}):{innerTransaction:{instructions:[],signers:[],instructionTypes:[]}};return{address:S.address,innerTransactions:yield at({connection:t,makeTxVersion:d,computeBudgetConfig:l,payer:i.feePayer,innerTransaction:[{instructionTypes:g,instructions:m,signers:A},S.innerTransaction,{instructionTypes:k,instructions:p,signers:[]},P.innerTransaction],lookupTableCache:f})}})}static makeSwapBaseInInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,inputMint:i,amountIn:s,amountOutMin:o,priceLimit:a,remainingAccounts:u,associatedOnly:c=!0,checkCreateATAOwner:l=!1,computeBudgetConfig:d,makeTxVersion:f,lookupTableCache:m}){const p=[],g=[],k=[],A=[],h=[];let w;!a||a.equals(new j(0))?w=i.equals(n.mintA.mint)?Ie.add(gt):Be.sub(gt):w=ut.priceToSqrtPriceX64(a,n.mintA.decimals,n.mintB.decimals);const T=n.mintA.mint.equals(i),b=r.useSOLBalance&&n.mintA.mint.equals(C.WSOL.mint),v=r.useSOLBalance&&n.mintB.mint.equals(C.WSOL.mint),S=yield this._selectOrCreateTokenAccount({programId:n.mintA.programId,mint:n.mintA.mint,tokenAccounts:b?[]:r.tokenAccounts,owner:r.wallet,createInfo:b||!T?{connection:t,payer:r.feePayer,amount:T?s:0,frontInstructions:p,endInstructions:g,frontInstructionsType:k,endInstructionsType:A,signers:h}:void 0,associatedOnly:b?!1:c,checkCreateATAOwner:l}),P=yield this._selectOrCreateTokenAccount({programId:n.mintB.programId,mint:n.mintB.mint,tokenAccounts:v?[]:r.tokenAccounts,owner:r.wallet,createInfo:v||T?{connection:t,payer:r.feePayer,amount:T?0:s,frontInstructions:p,endInstructions:g,frontInstructionsType:k,endInstructionsType:A,signers:h}:void 0,associatedOnly:v?!1:c,checkCreateATAOwner:l});ht.assertArgument(!!S||!!P,"cannot found target token accounts","tokenAccounts",r.tokenAccounts);const O=this.makeSwapBaseInInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccountA:S,tokenAccountB:P},inputMint:i,amountIn:s,amountOutMin:o,sqrtPriceLimitX64:w,remainingAccounts:u});return{address:O.address,innerTransactions:yield at({connection:t,makeTxVersion:f,computeBudgetConfig:d,payer:r.feePayer,innerTransaction:[{instructionTypes:k,instructions:p,signers:h},O.innerTransaction,{instructionTypes:A,instructions:g,signers:[]}],lookupTableCache:m})}})}static makeSwapBaseOutInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,outputMint:i,amountOut:s,amountInMax:o,priceLimit:a,remainingAccounts:u,associatedOnly:c=!0,checkCreateATAOwner:l=!1,computeBudgetConfig:d,makeTxVersion:f,lookupTableCache:m}){const p=[],g=[],k=[],A=[],h=[];let w;!a||a.equals(new j(0))?w=i.equals(n.mintB.mint)?Ie.add(gt):Be.sub(gt):w=ut.priceToSqrtPriceX64(a,n.mintA.decimals,n.mintB.decimals);const T=n.mintA.mint.equals(i),b=r.useSOLBalance&&n.mintA.mint.equals(C.WSOL.mint),v=r.useSOLBalance&&n.mintB.mint.equals(C.WSOL.mint),S=yield this._selectOrCreateTokenAccount({programId:n.mintA.programId,mint:n.mintA.mint,tokenAccounts:b?[]:r.tokenAccounts,owner:r.wallet,createInfo:b||!T?{connection:t,payer:r.feePayer,amount:T?o:0,frontInstructions:p,endInstructions:g,frontInstructionsType:k,endInstructionsType:A,signers:h}:void 0,associatedOnly:b?!1:c,checkCreateATAOwner:l}),P=yield this._selectOrCreateTokenAccount({programId:n.mintB.programId,mint:n.mintB.mint,tokenAccounts:v?[]:r.tokenAccounts,owner:r.wallet,createInfo:v||T?{connection:t,payer:r.feePayer,amount:T?0:o,frontInstructions:p,endInstructions:g,frontInstructionsType:k,endInstructionsType:A,signers:h}:void 0,associatedOnly:v?!1:c,checkCreateATAOwner:l});ht.assertArgument(!!S||!!P,"cannot found target token accounts","tokenAccounts",r.tokenAccounts);const O=this.makeSwapBaseOutInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccountA:S,tokenAccountB:P},outputMint:i,amountOut:s,amountInMax:o,sqrtPriceLimitX64:w,remainingAccounts:u});return{address:O.address,innerTransactions:yield at({connection:t,makeTxVersion:f,computeBudgetConfig:d,payer:r.feePayer,innerTransaction:[{instructionTypes:k,instructions:p,signers:h},O.innerTransaction,{instructionTypes:A,instructions:g,signers:[]}],lookupTableCache:m})}})}static makeCLosePositionInstructionSimple(e){return U(this,arguments,function*({poolInfo:t,ownerPosition:n,ownerInfo:r,makeTxVersion:i,lookupTableCache:s,connection:o}){const a=this.makeClosePositionInstructions({poolInfo:t,ownerInfo:r,ownerPosition:n});return{address:a.address,innerTransactions:yield at({connection:o,makeTxVersion:i,computeBudgetConfig:void 0,payer:r.feePayer,innerTransaction:[a.innerTransaction],lookupTableCache:s})}})}static makeInitRewardInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,rewardInfo:i,chainTime:s,associatedOnly:o=!0,checkCreateATAOwner:a=!1,makeTxVersion:u,lookupTableCache:c}){ht.assertArgument(i.endTime>i.openTime,"reward time error","rewardInfo",i),ht.assertArgument(i.openTime>s,"reward must be paid later","rewardInfo",i);const l=[],d=[],f=[],m=[],p=[],g=r.useSOLBalance&&i.mint.equals(C.WSOL.mint),k=i.perSecond.mul(i.endTime-i.openTime),A=yield this._selectOrCreateTokenAccount({programId:i.programId,mint:i.mint,tokenAccounts:g?[]:r.tokenAccounts,owner:r.wallet,createInfo:g?{connection:t,payer:r.feePayer,amount:new I(new j(k.toFixed(0)).gte(k)?k.toFixed(0):k.add(1).toFixed(0)),frontInstructions:l,endInstructions:d,frontInstructionsType:f,endInstructionsType:m,signers:p}:void 0,associatedOnly:g?!1:o,checkCreateATAOwner:a});ht.assertArgument(A,"no money","ownerRewardAccount",r.tokenAccounts);const h=this.makeInitRewardInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccount:A},rewardInfo:{programId:i.programId,mint:i.mint,openTime:i.openTime,endTime:i.endTime,emissionsPerSecondX64:ot.decimalToX64(i.perSecond)}});return{address:h.address,innerTransactions:yield at({connection:t,makeTxVersion:u,computeBudgetConfig:void 0,payer:r.feePayer,innerTransaction:[{instructionTypes:f,instructions:l,signers:p},h.innerTransaction,{instructionTypes:m,instructions:d,signers:[]}],lookupTableCache:c})}})}static makeInitRewardsInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,rewardInfos:i,associatedOnly:s=!0,checkCreateATAOwner:o=!1,computeBudgetConfig:a,makeTxVersion:u,lookupTableCache:c}){for(const A of i)ht.assertArgument(A.endTime>A.openTime,"reward time error","rewardInfo",A);const l=[],d=[],f=[],m=[],p=[],g=[];for(const A of i){const h=r.useSOLBalance&&A.mint.equals(C.WSOL.mint),w=A.perSecond.mul(A.endTime-A.openTime),T=yield this._selectOrCreateTokenAccount({programId:A.programId,mint:A.mint,tokenAccounts:h?[]:r.tokenAccounts,owner:r.wallet,createInfo:h?{connection:t,payer:r.feePayer,amount:new I(new j(w.toFixed(0)).gte(w)?w.toFixed(0):w.add(1).toFixed(0)),frontInstructions:l,endInstructions:d,frontInstructionsType:f,endInstructionsType:m,signers:g}:void 0,associatedOnly:h?!1:s,checkCreateATAOwner:o});ht.assertArgument(T,"no money","ownerRewardAccount",r.tokenAccounts),p.push(this.makeInitRewardInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccount:T},rewardInfo:{programId:A.programId,mint:A.mint,openTime:A.openTime,endTime:A.endTime,emissionsPerSecondX64:ot.decimalToX64(A.perSecond)}}))}let k={};for(const A of p)k=Z(Z({},k),A.address);return{address:k,innerTransactions:yield at({connection:t,makeTxVersion:u,computeBudgetConfig:a,payer:r.feePayer,innerTransaction:[{instructionTypes:f,instructions:l,signers:g},...p.map(A=>A.innerTransaction),{instructionTypes:m,instructions:d,signers:[]}],lookupTableCache:c})}})}static makeSetRewardInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,rewardInfo:i,chainTime:s,associatedOnly:o=!0,checkCreateATAOwner:a=!1,makeTxVersion:u,lookupTableCache:c}){ht.assertArgument(i.endTime>i.openTime,"reward time error","rewardInfo",i),ht.assertArgument(i.openTime>s,"reward must be paid later","rewardInfo",i);const l=[],d=[],f=[],m=[],p=[],g=r.useSOLBalance&&i.mint.equals(C.WSOL.mint),k=yield this._selectOrCreateTokenAccount({programId:i.programId,mint:i.mint,tokenAccounts:g?[]:r.tokenAccounts,owner:r.wallet,createInfo:g?{connection:t,payer:r.feePayer,amount:new I(new j(i.perSecond.sub(i.endTime-i.openTime).toFixed(0)).gte(i.perSecond.sub(i.endTime-i.openTime))?i.perSecond.sub(i.endTime-i.openTime).toFixed(0):i.perSecond.sub(i.endTime-i.openTime).add(1).toFixed(0)),frontInstructions:l,endInstructions:d,frontInstructionsType:f,endInstructionsType:m,signers:p}:void 0,associatedOnly:g?!1:o,checkCreateATAOwner:a});ht.assertArgument(k,"no money","ownerRewardAccount",r.tokenAccounts);const A=this.makeSetRewardInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccount:k},rewardInfo:{mint:i.mint,openTime:i.openTime,endTime:i.endTime,emissionsPerSecondX64:ot.decimalToX64(i.perSecond)}});return{address:A.address,innerTransactions:yield at({connection:t,makeTxVersion:u,computeBudgetConfig:void 0,payer:r.feePayer,innerTransaction:[{instructionTypes:f,instructions:l,signers:p},A.innerTransaction,{instructionTypes:m,instructions:d,signers:[]}],lookupTableCache:c})}})}static makeSetRewardsInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,rewardInfos:i,chainTime:s,associatedOnly:o=!0,checkCreateATAOwner:a=!1,computeBudgetConfig:u,makeTxVersion:c,lookupTableCache:l}){const d=[],f=[],m=[],p=[],g=[],k=[];for(const h of i){ht.assertArgument(h.endTime>h.openTime,"reward time error","rewardInfo",h),ht.assertArgument(h.openTime>s,"reward must be paid later","rewardInfo",h);const w=r.useSOLBalance&&h.mint.equals(C.WSOL.mint),T=yield this._selectOrCreateTokenAccount({programId:h.programId,mint:h.mint,tokenAccounts:w?[]:r.tokenAccounts,owner:r.wallet,createInfo:w?{connection:t,payer:r.feePayer,amount:new I(new j(h.perSecond.sub(h.endTime-h.openTime).toFixed(0)).gte(h.perSecond.sub(h.endTime-h.openTime))?h.perSecond.sub(h.endTime-h.openTime).toFixed(0):h.perSecond.sub(h.endTime-h.openTime).add(1).toFixed(0)),frontInstructions:d,endInstructions:f,frontInstructionsType:m,endInstructionsType:p,signers:k}:void 0,associatedOnly:w?!1:o,checkCreateATAOwner:a});ht.assertArgument(T,"no money","ownerRewardAccount",r.tokenAccounts),g.push(this.makeSetRewardInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccount:T},rewardInfo:{mint:h.mint,openTime:h.openTime,endTime:h.endTime,emissionsPerSecondX64:ot.decimalToX64(h.perSecond)}}))}let A={};for(const h of g)A=Z(Z({},A),h.address);return{address:A,innerTransactions:yield at({connection:t,makeTxVersion:c,computeBudgetConfig:u,payer:r.feePayer,innerTransaction:[{instructionTypes:m,instructions:d,signers:k},...g.map(h=>h.innerTransaction),{instructionTypes:p,instructions:f,signers:[]}],lookupTableCache:l})}})}static makeCollectRewardInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,rewardMint:i,associatedOnly:s=!0,checkCreateATAOwner:o=!1,computeBudgetConfig:a,makeTxVersion:u,lookupTableCache:c}){const l=[],d=[],f=[],m=[],p=[],g=n.rewardInfos.find(w=>w.tokenMint.equals(i));if(ht.assertArgument(g!==void 0,"reward mint error","not found reward mint",i),g===void 0)throw Error("reward mint error");const k=r.useSOLBalance&&i.equals(C.WSOL.mint),A=yield this._selectOrCreateTokenAccount({programId:g.tokenProgramId,mint:i,tokenAccounts:k?[]:r.tokenAccounts,owner:r.wallet,createInfo:{connection:t,payer:r.feePayer,amount:0,frontInstructions:l,endInstructions:k?d:[],frontInstructionsType:f,endInstructionsType:m,signers:p},associatedOnly:k?!1:s,checkCreateATAOwner:o});ht.assertArgument(A,"no money","ownerRewardAccount",r.tokenAccounts);const h=this.makeCollectRewardInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccount:A},rewardMint:i});return{address:h.address,innerTransactions:yield at({connection:t,makeTxVersion:u,computeBudgetConfig:a,payer:r.feePayer,innerTransaction:[{instructionTypes:f,instructions:l,signers:p},h.innerTransaction,{instructionTypes:m,instructions:d,signers:[]}],lookupTableCache:c})}})}static makeCollectRewardsInstructionSimple(e){return U(this,arguments,function*({connection:t,poolInfo:n,ownerInfo:r,rewardMints:i,associatedOnly:s=!0,checkCreateATAOwner:o=!1,computeBudgetConfig:a,makeTxVersion:u,lookupTableCache:c}){const l=[],d=[],f=[],m=[],p=[],g=[];for(const A of i){const h=n.rewardInfos.find(b=>b.tokenMint.equals(A));if(ht.assertArgument(h!==void 0,"reward mint error","not found reward mint",A),h===void 0)throw Error("reward mint error");const w=r.useSOLBalance&&A.equals(C.WSOL.mint),T=yield this._selectOrCreateTokenAccount({programId:h.tokenProgramId,mint:A,tokenAccounts:w?[]:r.tokenAccounts,owner:r.wallet,createInfo:{connection:t,payer:r.feePayer,amount:0,frontInstructions:l,endInstructions:w?d:[],signers:g,frontInstructionsType:f,endInstructionsType:m},associatedOnly:w?!1:s,checkCreateATAOwner:o});ht.assertArgument(T,"no money","ownerRewardAccount",r.tokenAccounts),p.push(this.makeCollectRewardInstructions({poolInfo:n,ownerInfo:{wallet:r.wallet,tokenAccount:T},rewardMint:A}))}let k={};for(const A of p)k=Z(Z({},k),A.address);return{address:k,innerTransactions:yield at({connection:t,makeTxVersion:u,computeBudgetConfig:a,payer:r.feePayer,innerTransaction:[{instructionTypes:f,instructions:l,signers:g},...p.map(A=>A.innerTransaction),{instructionTypes:m,instructions:d,signers:[]}],lookupTableCache:c})}})}static makeHarvestAllRewardInstructionSimple(e){return U(this,arguments,function*({connection:t,fetchPoolInfos:n,ownerInfo:r,associatedOnly:i=!0,checkCreateATAOwner:s=!1,makeTxVersion:o,lookupTableCache:a}){var u,c,l;const d={};for(const h of r.tokenAccounts)i?St(r.wallet,h.accountInfo.mint,h.programId).publicKey.equals(h.pubkey)&&(d[h.accountInfo.mint.toString()]=h.pubkey):d[h.accountInfo.mint.toString()]=h.pubkey;const f=[],m=[],p=[],g=[],k=[],A=[];for(const h of Object.values(n)){if(h.positionAccount===void 0||!h.positionAccount.find(O=>!O.tokenFeeAmountA.isZero()||!O.tokenFeeAmountB.isZero()||O.rewardInfos.find(L=>!L.pendingReward.isZero())))continue;const w=h.state,T=r.useSOLBalance&&w.mintA.mint.equals(C.WSOL.mint),b=r.useSOLBalance&&w.mintB.mint.equals(C.WSOL.mint),v=(u=d[w.mintA.mint.toString()])!=null?u:yield this._selectOrCreateTokenAccount({programId:w.mintA.programId,mint:w.mintA.mint,tokenAccounts:T?[]:r.tokenAccounts,owner:r.wallet,createInfo:{connection:t,payer:r.feePayer,amount:0,frontInstructions:f,frontInstructionsType:p,endInstructions:T?m:[],endInstructionsType:T?g:[],signers:A},associatedOnly:T?!1:i,checkCreateATAOwner:s}),S=(c=d[w.mintB.mint.toString()])!=null?c:yield this._selectOrCreateTokenAccount({programId:w.mintB.programId,mint:w.mintB.mint,tokenAccounts:b?[]:r.tokenAccounts,owner:r.wallet,createInfo:{connection:t,payer:r.feePayer,amount:0,frontInstructions:f,frontInstructionsType:p,endInstructions:b?m:[],endInstructionsType:b?g:[],signers:A},associatedOnly:b?!1:i,checkCreateATAOwner:s});d[w.mintA.mint.toString()]=v,d[w.mintB.mint.toString()]=S;const P=[];for(const O of w.rewardInfos){const L=r.useSOLBalance&&O.tokenMint.equals(C.WSOL.mint),_=(l=d[O.tokenMint.toString()])!=null?l:yield this._selectOrCreateTokenAccount({programId:O.tokenProgramId,mint:O.tokenMint,tokenAccounts:L?[]:r.tokenAccounts,owner:r.wallet,createInfo:{connection:t,payer:r.feePayer,amount:0,frontInstructions:f,endInstructions:L?m:[],frontInstructionsType:p,endInstructionsType:g,signers:A},associatedOnly:L?!1:i,checkCreateATAOwner:s});d[O.tokenMint.toString()]=_,P.push(_)}for(const O of h.positionAccount)k.push(this.makeDecreaseLiquidityInstructions({poolInfo:w,ownerPosition:O,ownerInfo:{wallet:r.wallet,tokenAccountA:v,tokenAccountB:S,rewardAccounts:P},liquidity:Y,amountMinA:Y,amountMinB:Y}))}return{address:{},innerTransactions:yield at({connection:t,makeTxVersion:o,computeBudgetConfig:void 0,payer:r.feePayer,innerTransaction:[{instructionTypes:p,instructions:f,signers:A},...k.map(h=>h.innerTransaction),{instructionTypes:g,instructions:m,signers:[]}],lookupTableCache:a})}})}static makeCreatePoolInstructions(e){return U(this,arguments,function*({connection:t,programId:n,owner:r,mintA:i,mintB:s,ammConfigId:o,initialPriceX64:a,startTime:u}){const c=sn({fromPublicKey:r,programId:n}),l=vc(n,o,i.mint,s.mint).publicKey,d=wi(n,l,i.mint).publicKey,f=wi(n,l,s.mint).publicKey,m=[Ee.createAccountWithSeed({fromPubkey:r,basePubkey:r,seed:c.seed,newAccountPubkey:c.publicKey,lamports:yield t.getMinimumBalanceForRentExemption(Ti.span),space:Ti.span,programId:n}),ec(n,l,r,o,c.publicKey,i.mint,d,i.programId,s.mint,f,s.programId,ie(n,l).publicKey,a,u)];return{address:{observationId:c.publicKey,poolId:l,mintAVault:d,mintBVault:f},innerTransaction:{instructions:m,signers:[],instructionTypes:[0,11],lookupTableAddress:[]}}})}static makeOpenPositionFromLiquidityInstructions(e){return U(this,arguments,function*({poolInfo:t,ownerInfo:n,tickLower:r,tickUpper:i,liquidity:s,amountMaxA:o,amountMaxB:a,withMetadata:u,getEphemeralSigners:c}){const l=[];let d;if(c)d=new R((yield c(1))[0]);else{const b=bn.generate();l.push(b),d=b.publicKey}const f=st.getTickArrayStartIndexByTick(r,t.ammConfig.tickSpacing),m=st.getTickArrayStartIndexByTick(i,t.ammConfig.tickSpacing),{publicKey:p}=wt(t.programId,t.id,f),{publicKey:g}=wt(t.programId,t.id,m),{publicKey:k}=St(n.wallet,d,N),{publicKey:A}=ki(d),{publicKey:h}=Te(t.programId,d),{publicKey:w}=He(t.programId,t.id,r,i),T=nc(t.programId,n.feePayer,t.id,n.wallet,d,k,A,w,p,g,h,n.tokenAccountA,n.tokenAccountB,t.mintA.vault,t.mintB.vault,t.mintA.mint,t.mintB.mint,r,i,f,m,s,o,a,u,oe.isOverflowDefaultTickarrayBitmap(t.tickSpacing,[f,m])?ie(t.programId,t.id).publicKey:void 0);return{address:{nftMint:d,tickArrayLower:p,tickArrayUpper:g,positionNftAccount:k,metadataAccount:A,personalPosition:h,protocolPosition:w},innerTransaction:{instructions:[T],signers:l,instructionTypes:[12],lookupTableAddress:[t.lookupTableAccount].filter(b=>b&&!b.equals(R.default))}}})}static makeOpenPositionFromBaseInstructions(e){return U(this,arguments,function*({poolInfo:t,ownerInfo:n,tickLower:r,tickUpper:i,base:s,baseAmount:o,otherAmountMax:a,withMetadata:u,getEphemeralSigners:c}){const l=[];let d;if(c)d=new R((yield c(1))[0]);else{const b=bn.generate();l.push(b),d=b.publicKey}const f=st.getTickArrayStartIndexByTick(r,t.ammConfig.tickSpacing),m=st.getTickArrayStartIndexByTick(i,t.ammConfig.tickSpacing),{publicKey:p}=wt(t.programId,t.id,f),{publicKey:g}=wt(t.programId,t.id,m),{publicKey:k}=St(n.wallet,d,N),{publicKey:A}=ki(d),{publicKey:h}=Te(t.programId,d),{publicKey:w}=He(t.programId,t.id,r,i),T=rc(t.programId,n.feePayer,t.id,n.wallet,d,k,A,w,p,g,h,n.tokenAccountA,n.tokenAccountB,t.mintA.vault,t.mintB.vault,t.mintA.mint,t.mintB.mint,r,i,f,m,u,s,o,a,oe.isOverflowDefaultTickarrayBitmap(t.tickSpacing,[f,m])?ie(t.programId,t.id).publicKey:void 0);return{address:{nftMint:d,tickArrayLower:p,tickArrayUpper:g,positionNftAccount:k,metadataAccount:A,personalPosition:h,protocolPosition:w},innerTransaction:{instructions:[T],signers:l,instructionTypes:[12],lookupTableAddress:[t.lookupTableAccount].filter(b=>b&&!b.equals(R.default))}}})}static makeIncreasePositionFromLiquidityInstructions({poolInfo:e,ownerPosition:t,ownerInfo:n,liquidity:r,amountMaxA:i,amountMaxB:s}){const o=st.getTickArrayStartIndexByTick(t.tickLower,e.ammConfig.tickSpacing),a=st.getTickArrayStartIndexByTick(t.tickUpper,e.ammConfig.tickSpacing),{publicKey:u}=wt(e.programId,e.id,o),{publicKey:c}=wt(e.programId,e.id,a),{publicKey:l}=St(n.wallet,t.nftMint,N),{publicKey:d}=Te(e.programId,t.nftMint),{publicKey:f}=He(e.programId,e.id,t.tickLower,t.tickUpper);return{address:{tickArrayLower:u,tickArrayUpper:c,positionNftAccount:l,personalPosition:d,protocolPosition:f},innerTransaction:{instructions:[sc(e.programId,n.wallet,l,d,e.id,f,u,c,n.tokenAccountA,n.tokenAccountB,e.mintA.vault,e.mintB.vault,e.mintA.mint,e.mintB.mint,r,i,s,oe.isOverflowDefaultTickarrayBitmap(e.tickSpacing,[o,a])?ie(e.programId,e.id).publicKey:void 0)],signers:[],instructionTypes:[13],lookupTableAddress:[e.lookupTableAccount].filter(m=>m&&!m.equals(R.default))}}}static makeIncreasePositionFromBaseInstructions({poolInfo:e,ownerPosition:t,ownerInfo:n,base:r,baseAmount:i,otherAmountMax:s}){const o=st.getTickArrayStartIndexByTick(t.tickLower,e.ammConfig.tickSpacing),a=st.getTickArrayStartIndexByTick(t.tickUpper,e.ammConfig.tickSpacing),{publicKey:u}=wt(e.programId,e.id,o),{publicKey:c}=wt(e.programId,e.id,a),{publicKey:l}=St(n.wallet,t.nftMint,N),{publicKey:d}=Te(e.programId,t.nftMint),{publicKey:f}=He(e.programId,e.id,t.tickLower,t.tickUpper);return{address:{tickArrayLower:u,tickArrayUpper:c,positionNftAccount:l,personalPosition:d,protocolPosition:f},innerTransaction:{instructions:[oc(e.programId,n.wallet,l,d,e.id,f,u,c,n.tokenAccountA,n.tokenAccountB,e.mintA.vault,e.mintB.vault,e.mintA.mint,e.mintB.mint,r,i,s,oe.isOverflowDefaultTickarrayBitmap(e.tickSpacing,[o,a])?ie(e.programId,e.id).publicKey:void 0)],signers:[],instructionTypes:[13],lookupTableAddress:[e.lookupTableAccount].filter(m=>m&&!m.equals(R.default))}}}static makeDecreaseLiquidityInstructions({poolInfo:e,ownerPosition:t,ownerInfo:n,liquidity:r,amountMinA:i,amountMinB:s}){const o=st.getTickArrayStartIndexByTick(t.tickLower,e.ammConfig.tickSpacing),a=st.getTickArrayStartIndexByTick(t.tickUpper,e.ammConfig.tickSpacing),{publicKey:u}=wt(e.programId,e.id,o),{publicKey:c}=wt(e.programId,e.id,a),{publicKey:l}=St(n.wallet,t.nftMint,N),{publicKey:d}=Te(e.programId,t.nftMint),{publicKey:f}=He(e.programId,e.id,t.tickLower,t.tickUpper),m=[];for(let p=0;p<e.rewardInfos.length;p++)m.push({poolRewardVault:e.rewardInfos[p].tokenVault,ownerRewardVault:n.rewardAccounts[p],rewardMint:e.rewardInfos[p].tokenMint});return{address:{tickArrayLower:u,tickArrayUpper:c,positionNftAccount:l,personalPosition:d,protocolPosition:f},innerTransaction:{instructions:[ac(e.programId,n.wallet,l,d,e.id,f,u,c,n.tokenAccountA,n.tokenAccountB,e.mintA.vault,e.mintB.vault,e.mintA.mint,e.mintB.mint,m,r,i,s,oe.isOverflowDefaultTickarrayBitmap(e.tickSpacing,[o,a])?ie(e.programId,e.id).publicKey:void 0)],signers:[],instructionTypes:[14],lookupTableAddress:[e.lookupTableAccount].filter(p=>p&&!p.equals(R.default))}}}static makeClosePositionInstructions({poolInfo:e,ownerInfo:t,ownerPosition:n}){const{publicKey:r}=St(t.wallet,n.nftMint,N),{publicKey:i}=Te(e.programId,n.nftMint);return{address:{positionNftAccount:r,personalPosition:i},innerTransaction:{instructions:[ic(e.programId,t.wallet,n.nftMint,r,i)],signers:[],instructionTypes:[15],lookupTableAddress:[e.lookupTableAccount].filter(s=>s&&!s.equals(R.default))}}}static makeSwapBaseInInstructions({poolInfo:e,ownerInfo:t,inputMint:n,amountIn:r,amountOutMin:i,sqrtPriceLimitX64:s,remainingAccounts:o}){const a=e.mintA.mint.equals(n);return{address:{},innerTransaction:{instructions:[Ai(e.programId,t.wallet,e.id,e.ammConfig.id,a?t.tokenAccountA:t.tokenAccountB,a?t.tokenAccountB:t.tokenAccountA,a?e.mintA.vault:e.mintB.vault,a?e.mintB.vault:e.mintA.vault,a?e.mintA.mint:e.mintB.mint,a?e.mintB.mint:e.mintA.mint,o,e.observationId,r,i,s,!0,ie(e.programId,e.id).publicKey)],signers:[],lookupTableAddress:[e.lookupTableAccount].filter(u=>u&&!u.equals(R.default)),instructionTypes:[16]}}}static makeSwapBaseOutInstructions({poolInfo:e,ownerInfo:t,outputMint:n,amountOut:r,amountInMax:i,sqrtPriceLimitX64:s,remainingAccounts:o}){const a=e.mintA.mint.equals(n);return{address:{},innerTransaction:{instructions:[Ai(e.programId,t.wallet,e.id,e.ammConfig.id,a?t.tokenAccountB:t.tokenAccountA,a?t.tokenAccountA:t.tokenAccountB,a?e.mintB.vault:e.mintA.vault,a?e.mintA.vault:e.mintB.vault,a?e.mintB.mint:e.mintA.mint,a?e.mintA.mint:e.mintB.mint,o,e.observationId,r,i,s,!1,ie(e.programId,e.id).publicKey)],signers:[],lookupTableAddress:[e.lookupTableAccount].filter(u=>u&&!u.equals(R.default)),instructionTypes:[17]}}}static makeInitRewardInstructions({poolInfo:e,ownerInfo:t,rewardInfo:n}){const r=Ic(e.programId,e.id,n.mint).publicKey,i=Zn(e.programId).publicKey;return{address:{poolRewardVault:r,operationId:i},innerTransaction:{instructions:[cc(e.programId,t.wallet,e.id,i,e.ammConfig.id,t.tokenAccount,n.programId,n.mint,r,n.openTime,n.endTime,n.emissionsPerSecondX64)],signers:[],instructionTypes:[18],lookupTableAddress:[e.lookupTableAccount].filter(s=>s&&!s.equals(R.default))}}}static makeSetRewardInstructions({poolInfo:e,ownerInfo:t,rewardInfo:n}){let r,i,s;for(let a=0;a<e.rewardInfos.length;a++)e.rewardInfos[a].tokenMint.equals(n.mint)&&(r=a,i=e.rewardInfos[a].tokenVault,s=e.rewardInfos[a].tokenMint);if(r===void 0||i===void 0||s===void 0)throw Error("reward mint check error");const o=Zn(e.programId).publicKey;return{address:{rewardVault:i,operationId:o},innerTransaction:{instructions:[uc(e.programId,t.wallet,e.id,o,e.ammConfig.id,t.tokenAccount,i,s,r,n.openTime,n.endTime,n.emissionsPerSecondX64)],signers:[],instructionTypes:[18],lookupTableAddress:[e.lookupTableAccount].filter(a=>a&&!a.equals(R.default))}}}static makeCollectRewardInstructions({poolInfo:e,ownerInfo:t,rewardMint:n}){let r,i;for(let s=0;s<e.rewardInfos.length;s++)e.rewardInfos[s].tokenMint.equals(n)&&(r=s,i=e.rewardInfos[s].tokenVault);if(r===void 0||i===void 0)throw Error("reward mint check error");return{address:{rewardVault:i},innerTransaction:{instructions:[lc(e.programId,t.wallet,e.id,t.tokenAccount,i,n,r)],signers:[],instructionTypes:[18],lookupTableAddress:[e.lookupTableAccount].filter(s=>s&&!s.equals(R.default))}}}static getLiquidityAmountOutFromAmountIn({poolInfo:e,inputA:t,tickLower:n,tickUpper:r,amount:i,slippage:s,add:o,token2022Infos:a,epochInfo:u,amountHasFee:c}){var l,d;const f=e.sqrtPriceX64,m=ut.getSqrtPriceX64FromTick(n),p=ut.getSqrtPriceX64FromTick(r),g=o?1-s:1+s,k=qt(i,(l=a[t?e.mintA.mint.toString():e.mintB.mint.toString()])==null?void 0:l.feeConfig,u,!c),A=new I(new j(k.amount.sub((d=k.fee)!=null?d:Y).toString()).mul(g).toFixed(0));let h;if(f.lte(m))h=t?Bt.getLiquidityFromTokenAmountA(m,p,A,!o):new I(0);else if(f.lte(p)){const w=Bt.getLiquidityFromTokenAmountA(f,p,A,!o),T=Bt.getLiquidityFromTokenAmountB(m,f,A);h=t?w:T}else h=t?new I(0):Bt.getLiquidityFromTokenAmountB(m,p,A);return this.getAmountsFromLiquidity({poolInfo:e,tickLower:n,tickUpper:r,liquidity:h,slippage:s,add:o,token2022Infos:a,epochInfo:u,amountAddFee:c})}static getLiquidityFromAmounts({poolInfo:e,tickLower:t,tickUpper:n,amountA:r,amountB:i,slippage:s,add:o,token2022Infos:a,epochInfo:u,amountHasFee:c}){var l,d,f,m;const[p,g,k,A]=t<n?[t,n,r,i]:[n,t,i,r],h=e.sqrtPriceX64,w=ut.getSqrtPriceX64FromTick(p),T=ut.getSqrtPriceX64FromTick(g),[b,v]=[qt(k,(l=a[e.mintA.mint.toString()])==null?void 0:l.feeConfig,u,!c),qt(A,(d=a[e.mintB.mint.toString()])==null?void 0:d.feeConfig,u,!c)],S=Bt.getLiquidityFromTokenAmounts(h,w,T,b.amount.sub((f=b.fee)!=null?f:Y),v.amount.sub((m=v.fee)!=null?m:Y));return this.getAmountsFromLiquidity({poolInfo:e,tickLower:t,tickUpper:n,liquidity:S,slippage:s,add:o,token2022Infos:a,epochInfo:u,amountAddFee:!c})}static getAmountsFromLiquidity({poolInfo:e,tickLower:t,tickUpper:n,liquidity:r,slippage:i,add:s,token2022Infos:o,epochInfo:a,amountAddFee:u}){var c,l,d,f;const m=ut.getSqrtPriceX64FromTick(t),p=ut.getSqrtPriceX64FromTick(n),g=s?1+i:1-i,k=Bt.getAmountsFromLiquidity(e.sqrtPriceX64,m,p,r,s),[A,h]=[qt(k.amountA,(c=o[e.mintA.mint.toString()])==null?void 0:c.feeConfig,a,u),qt(k.amountB,(l=o[e.mintB.mint.toString()])==null?void 0:l.feeConfig,a,u)],[w,T]=[qt(new I(new j(k.amountA.toString()).mul(g).toFixed(0)),(d=o[e.mintA.mint.toString()])==null?void 0:d.feeConfig,a,u),qt(new I(new j(k.amountB.toString()).mul(g).toFixed(0)),(f=o[e.mintB.mint.toString()])==null?void 0:f.feeConfig,a,u)];return{liquidity:r,amountA:A,amountB:h,amountSlippageA:w,amountSlippageB:T,expirationTime:Qn(A.expirationTime,h.expirationTime)}}static getPriceAndTick({poolInfo:e,price:t,baseIn:n}){const r=n?t:new j(1).div(t),i=Nc.getTickWithPriceAndTickspacing(r,e.ammConfig.tickSpacing,e.mintA.decimals,e.mintB.decimals),s=ut.getSqrtPriceX64FromTick(i),o=ut.sqrtPriceX64ToPrice(s,e.mintA.decimals,e.mintB.decimals);return n?{tick:i,price:o}:{tick:i,price:new j(1).div(o)}}static getTickPrice({poolInfo:e,tick:t,baseIn:n}){const r=ut.getSqrtPriceX64FromTick(t),i=ut.sqrtPriceX64ToPrice(r,e.mintA.decimals,e.mintB.decimals);return n?{tick:t,price:i,tickSqrtPriceX64:r}:{tick:t,price:new j(1).div(i),tickSqrtPriceX64:r}}static computeAmountOutFormat({poolInfo:e,tickArrayCache:t,token2022Infos:n,epochInfo:r,amountIn:i,currencyOut:s,slippage:o,catchLiquidityInsufficient:a=!1}){const u=i instanceof ft,c=(u?i.token:C.WSOL).mint,l=i.raw,d=o.numerator.toNumber()/o.denominator.toNumber(),{allTrade:f,realAmountIn:m,amountOut:p,minAmountOut:g,expirationTime:k,currentPrice:A,executionPrice:h,priceImpact:w,fee:T,remainingAccounts:b,executionPriceX64:v}=this.computeAmountOut({poolInfo:e,tickArrayCache:t,baseMint:c,amountIn:l,slippage:d,token2022Infos:n,epochInfo:r,catchLiquidityInsufficient:a}),S=yt(Z({},m),{amount:u?new ft(i.token,m.amount):new xt(rn.SOL,m.amount),fee:m.fee===void 0?void 0:u?new ft(i.token,m.fee):new xt(rn.SOL,m.fee)}),P=yt(Z({},p),{amount:s instanceof C?new ft(s,p.amount):new xt(s,p.amount),fee:p.fee===void 0?void 0:s instanceof C?new ft(s,p.fee):new xt(s,p.fee)}),O=yt(Z({},g),{amount:s instanceof C?new ft(s,g.amount):new xt(s,g.amount),fee:g.fee===void 0?void 0:s instanceof C?new ft(s,g.fee):new xt(s,g.fee)}),L=new $t(u?i.token:i.currency,new I(10).pow(new I(20+(u?i.token:i.currency).decimals)),s instanceof C?s:C.WSOL,A.mul(new j(Fe(10,20+(s instanceof C?s:C.WSOL).decimals))).toFixed(0)),_=new $t(u?i.token:i.currency,new I(10).pow(new I(20+(u?i.token:i.currency).decimals)),s instanceof C?s:C.WSOL,h.mul(new j(Fe(10,20+(s instanceof C?s:C.WSOL).decimals))).toFixed(0)),W=u?new ft(i.token,T):new xt(i.currency,T);return{allTrade:f,realAmountIn:S,amountOut:P,minAmountOut:O,expirationTime:k,currentPrice:L,executionPrice:_,priceImpact:w,fee:W,remainingAccounts:b,executionPriceX64:v}}static computeAmountOutAndCheckToken(e){return U(this,arguments,function*({connection:t,poolInfo:n,tickArrayCache:r,baseMint:i,amountIn:s,slippage:o,priceLimit:a=new j(0),catchLiquidityInsufficient:u=!1}){const c=yield t.getEpochInfo(),l=yield ii({connection:t,mints:[n.mintA,n.mintB].filter(d=>d.programId.equals(ee)).map(d=>d.mint)});return this.computeAmountOut({poolInfo:n,tickArrayCache:r,baseMint:i,amountIn:s,slippage:o,priceLimit:a,token2022Infos:l,epochInfo:c,catchLiquidityInsufficient:u})})}static computeAmountOut({poolInfo:e,tickArrayCache:t,baseMint:n,token2022Infos:r,epochInfo:i,amountIn:s,slippage:o,priceLimit:a=new j(0),catchLiquidityInsufficient:u=!1}){var c,l,d,f,m;let p;a.equals(new j(0))?p=n.equals(e.mintA.mint)?Ie.add(gt):Be.sub(gt):p=ut.priceToSqrtPriceX64(a,e.mintA.decimals,e.mintB.decimals);const g=qt(s,(c=r[n.toString()])==null?void 0:c.feeConfig,i,!1),{allTrade:k,realTradeAmountIn:A,expectedAmountOut:h,remainingAccounts:w,executionPrice:T,feeAmount:b}=oe.getOutputAmountAndRemainAccounts(e,t,n,g.amount.sub((l=g.fee)!=null?l:Y),p,u),v=qt(A,(d=r[n.toString()])==null?void 0:d.feeConfig,i,!0),S=e.mintA.mint.equals(n)?e.mintB.mint:e.mintA.mint,P=qt(h,(f=r[S.toString()])==null?void 0:f.feeConfig,i,!1),O=ut.sqrtPriceX64ToPrice(T,e.mintA.decimals,e.mintB.decimals),L=n.equals(e.mintA.mint)?O:new j(1).div(O),_=h.mul(new I(Math.floor((1-o)*1e10))).div(new I(1e10)),W=qt(_,(m=r[S.toString()])==null?void 0:m.feeConfig,i,!1),D=e.mintA.mint.equals(n)?e.currentPrice:new j(1).div(e.currentPrice),et=new j(L).sub(D).abs(),G=D,H=new Oe(new j(et).mul(Fe(10,15)).toFixed(0),new j(G).mul(Fe(10,15)).toFixed(0));return{allTrade:k,realAmountIn:v,amountOut:P,minAmountOut:W,expirationTime:Qn(v.expirationTime,P.expirationTime),currentPrice:e.currentPrice,executionPrice:L,priceImpact:H,fee:b,remainingAccounts:w,executionPriceX64:T}}static computeAmountInAndCheckToken(e){return U(this,arguments,function*({connection:t,poolInfo:n,tickArrayCache:r,baseMint:i,amountOut:s,slippage:o,priceLimit:a=new j(0)}){const u=yield t.getEpochInfo(),c=yield ii({connection:t,mints:[n.mintA,n.mintB].filter(l=>l.programId.equals(ee)).map(l=>l.mint)});return this.computeAmountIn({poolInfo:n,tickArrayCache:r,baseMint:i,amountOut:s,slippage:o,priceLimit:a,token2022Infos:c,epochInfo:u})})}static computeAmountIn({poolInfo:e,tickArrayCache:t,baseMint:n,token2022Infos:r,epochInfo:i,amountOut:s,slippage:o,priceLimit:a=new j(0)}){var u,c,l,d;let f;a.equals(new j(0))?f=n.equals(e.mintB.mint)?Ie.add(gt):Be.sub(gt):f=ut.priceToSqrtPriceX64(a,e.mintA.decimals,e.mintB.decimals);const m=qt(s,(u=r[n.toString()])==null?void 0:u.feeConfig,i,!0),{expectedAmountIn:p,remainingAccounts:g,executionPrice:k,feeAmount:A}=oe.getInputAmountAndRemainAccounts(e,t,n,m.amount.sub((c=m.fee)!=null?c:Y),f),h=e.mintA.mint.equals(n)?e.mintB.mint:e.mintA.mint,w=qt(p,(l=r[h.toString()])==null?void 0:l.feeConfig,i,!0),T=ut.sqrtPriceX64ToPrice(k,e.mintA.decimals,e.mintB.decimals),b=n.equals(e.mintA.mint)?T:new j(1).div(T),v=p.mul(new I(Math.floor((1+o)*1e10))).div(new I(1e10)),S=qt(v,(d=r[h.toString()])==null?void 0:d.feeConfig,i,!0),P=e.mintA.mint.equals(n)?e.currentPrice:new j(1).div(e.currentPrice),O=new j(b).sub(P).abs(),L=P,_=new Oe(new j(O).mul(Fe(10,15)).toFixed(0),new j(L).mul(Fe(10,15)).toFixed(0));return{amountIn:w,maxAmountIn:S,realAmountOut:m,expirationTime:Qn(w.expirationTime,m.expirationTime),currentPrice:e.currentPrice,executionPrice:b,priceImpact:_,fee:A,remainingAccounts:g}}static estimateAprsForPriceRangeMultiplier({poolInfo:e,aprType:t,positionTickLowerIndex:n,positionTickUpperIndex:r}){const i=e[t],s=this.getTickPrice({poolInfo:e,tick:n,baseIn:!0}).price.toNumber(),o=this.getTickPrice({poolInfo:e,tick:r,baseIn:!0}).price.toNumber(),a=Math.max(s,i.priceMin),c=Math.min(o,i.priceMax)-a,l=o-s,d=i.priceMax-i.priceMin;let f;return c<=0?f=0:l===c?f=d/c:d===c?f=c/l:f=c/d*(c/l),{feeApr:i.feeApr*f,rewardsApr:[i.rewardApr.A*f,i.rewardApr.B*f,i.rewardApr.C*f],apr:i.apr*f}}static estimateAprsForPriceRangeDelta({poolInfo:e,aprType:t,mintPrice:n,rewardMintDecimals:r,liquidity:i,positionTickLowerIndex:s,positionTickUpperIndex:o,chainTime:a}){const u=t==="day"?1:t==="week"?7:t==="month"?30:0,c=e[t],l=n[e.mintA.mint.toString()],d=n[e.mintB.mint.toString()],f=e.mintA.decimals,m=e.mintB.decimals;if(!c||!l||!d)return{feeApr:0,rewardsApr:[0,0,0],apr:0};const p=ut.getSqrtPriceX64FromTick(s),g=ut.getSqrtPriceX64FromTick(o),{amountSlippageA:k,amountSlippageB:A}=Bt.getAmountsFromLiquidityWithSlippage(e.sqrtPriceX64,p,g,e.liquidity,!1,!1,0),{amountSlippageA:h,amountSlippageB:w}=Bt.getAmountsFromLiquidityWithSlippage(e.sqrtPriceX64,p,g,i,!1,!1,0),T=new j(k.toString()).div(new j(10).pow(f)).mul(l.toFixed(f)).add(new j(A.toString()).div(new j(10).pow(m)).mul(d.toFixed(m))),b=new j(h.toString()).div(new j(10).pow(f)).mul(l.toFixed(f)).add(new j(w.toString()).div(new j(10).pow(m)).mul(d.toFixed(m))),v=new j(1).div(T.add(b)),P=new j(c.volumeFee).mul(365).div(u).mul(v).mul(100).toNumber(),O=3600*24*365,L=e.rewardInfos.map(_=>{const W=r[_.tokenMint.toString()],D=n[_.tokenMint.toString()];return a<_.openTime.toNumber()||a>_.endTime.toNumber()||_.perSecond.equals(0)||!D||W===void 0?0:new j(D.toFixed(W)).mul(_.perSecond.mul(O)).div(new j(10).pow(W)).mul(v).mul(100).toNumber()});return{feeApr:P,rewardsApr:L,apr:P+L.reduce((_,W)=>_+W,0)}}static fetchMultiplePoolInfos(e){return U(this,arguments,function*({connection:t,poolKeys:n,ownerInfo:r,chainTime:i,batchRequest:s=!1,updateOwnerRewardAndFee:o=!0}){var a;const u=yield ce(t,n.map(p=>new R(p.id)),{batchRequest:s}),c={};for(let p=0;p<n.length;p++){const g=n[p],k=u[p];k!==null&&(c[g.id]=ie(k.owner,new R(g.id)).publicKey)}const l=yield this.fetchExBitmaps({connection:t,exBitmapAddress:Object.values(c),batchRequest:s}),d=[],f={},m=[];for(let p=0;p<n.length;p++){const g=n[p],k=u[p],A=l[c[g.id].toString()];if(k===null)continue;const h=Lc.decode(k.data);f[g.id]={state:{id:new R(g.id),mintA:{programId:new R(g.mintProgramIdA),mint:h.mintA,vault:h.vaultA,decimals:h.mintDecimalsA},mintB:{programId:new R(g.mintProgramIdB),mint:h.mintB,vault:h.vaultB,decimals:h.mintDecimalsB},observationId:h.observationId,ammConfig:yt(Z({},g.ammConfig),{id:new R(g.ammConfig.id)}),creator:h.creator,programId:k.owner,version:6,tickSpacing:h.tickSpacing,liquidity:h.liquidity,sqrtPriceX64:h.sqrtPriceX64,currentPrice:ut.sqrtPriceX64ToPrice(h.sqrtPriceX64,h.mintDecimalsA,h.mintDecimalsB),tickCurrent:h.tickCurrent,observationIndex:h.observationIndex,observationUpdateDuration:h.observationUpdateDuration,feeGrowthGlobalX64A:h.feeGrowthGlobalX64A,feeGrowthGlobalX64B:h.feeGrowthGlobalX64B,protocolFeesTokenA:h.protocolFeesTokenA,protocolFeesTokenB:h.protocolFeesTokenB,swapInAmountTokenA:h.swapInAmountTokenA,swapOutAmountTokenB:h.swapOutAmountTokenB,swapInAmountTokenB:h.swapInAmountTokenB,swapOutAmountTokenA:h.swapOutAmountTokenA,tickArrayBitmap:h.tickArrayBitmap,rewardInfos:yield oe.updatePoolRewardInfos({connection:t,apiPoolInfo:g,chainTime:i,poolLiquidity:h.liquidity,rewardInfos:h.rewardInfos.filter(w=>!w.tokenMint.equals(R.default))}),day:g.day,week:g.week,month:g.month,tvl:g.tvl,lookupTableAccount:g.lookupTableAccount?new R(g.lookupTableAccount):R.default,startTime:h.startTime.toNumber(),exBitmapInfo:A}},r&&m.push(...f[g.id].state.rewardInfos.filter(w=>w.creator.equals(r.wallet))),d.find(w=>w.equals(k.owner))||d.push(k.owner)}if(r){const p=r.tokenAccounts.filter(h=>h.accountInfo.amount.eq(new I(1))).map(h=>h.accountInfo.mint),g=[];for(const h of p)for(const w of d)g.push(Te(w,h).publicKey);const k=yield ce(t,g,{batchRequest:s}),A={};for(const h of k){if(h===null)continue;const w=Pc.decode(h.data),T=w.poolId.toString(),b=f[T];if(b===void 0)continue;const v=b.state,S=this.getTickPrice({poolInfo:v,tick:w.tickLower,baseIn:!0}),P=this.getTickPrice({poolInfo:v,tick:w.tickUpper,baseIn:!0}),{amountA:O,amountB:L}=Bt.getAmountsFromLiquidity(v.sqrtPriceX64,S.tickSqrtPriceX64,P.tickSqrtPriceX64,w.liquidity,!1),_=1/(1-Math.sqrt(Math.sqrt(S.price.div(P.price).toNumber())));f[T].positionAccount=[...(a=f[T].positionAccount)!=null?a:[],{poolId:w.poolId,nftMint:w.nftMint,priceLower:S.price,priceUpper:P.price,amountA:O,amountB:L,tickLower:w.tickLower,tickUpper:w.tickUpper,liquidity:w.liquidity,feeGrowthInsideLastX64A:w.feeGrowthInsideLastX64A,feeGrowthInsideLastX64B:w.feeGrowthInsideLastX64B,tokenFeesOwedA:w.tokenFeesOwedA,tokenFeesOwedB:w.tokenFeesOwedB,rewardInfos:w.rewardInfos.map(et=>yt(Z({},et),{pendingReward:new I(0)})),leverage:_,tokenFeeAmountA:new I(0),tokenFeeAmountB:new I(0)}];const W=st.getTickArrayAddressByTick(f[T].state.programId,w.poolId,w.tickLower,f[T].state.tickSpacing),D=st.getTickArrayAddressByTick(f[T].state.programId,w.poolId,w.tickUpper,f[T].state.tickSpacing);A[`${f[T].state.programId.toString()}-${w.poolId.toString()}-${w.tickLower}`]=W,A[`${f[T].state.programId.toString()}-${w.poolId.toString()}-${w.tickUpper}`]=D}if(o){const h=Object.values(A),w=yield ce(t,h,{batchRequest:s}),T={};for(let b=0;b<h.length;b++){const v=w[b];if(v===null)continue;const S=h[b];T[S.toString()]=Z({address:S},pr.decode(v.data))}for(const{state:b,positionAccount:v}of Object.values(f))if(v)for(const S of v){const P=`${b.programId.toString()}-${b.id.toString()}-${S.tickLower}`,O=`${b.programId.toString()}-${b.id.toString()}-${S.tickUpper}`,L=T[A[P].toString()],_=T[A[O].toString()],W=L.ticks[st.getTickOffsetInArray(S.tickLower,b.tickSpacing)],D=_.ticks[st.getTickOffsetInArray(S.tickUpper,b.tickSpacing)],{tokenFeeAmountA:et,tokenFeeAmountB:G}=Si.GetPositionFees(b,S,W,D),H=Si.GetPositionRewards(b,S,W,D);S.tokenFeeAmountA=et.gte(Y)&&et.lt(jn)?et:Y,S.tokenFeeAmountB=G.gte(Y)&&et.lt(jn)?G:Y;for(let At=0;At<H.length;At++)S.rewardInfos[At].pendingReward=H[At].gte(Y)&&H[At].lt(jn)?H[At]:Y}}}if(m.length>0){const p=m.map(A=>A.tokenVault),g=yield ce(t,p,{batchRequest:s}),k={};for(let A=0;A<p.length;A++){const h=p[A].toString(),w=g[A];if(w===null)continue;const T=Zt.decode(w.data);k[h]=T.amount}for(const A of m){const h=k[A.tokenVault.toString()];A.remainingRewards=h!==void 0?h.sub(A.rewardTotalEmissioned.sub(A.rewardClaimed)):Y}}return f})}static fetchMultiplePoolTickArrays(e){return U(this,arguments,function*({connection:t,poolKeys:n,batchRequest:r}){const i={},s=[];for(const u of n){const c=st.getTickArrayStartIndexByTick(u.tickCurrent,u.tickSpacing),l=st.getInitializedTickArrayInRange(u.tickArrayBitmap,u.exBitmapInfo,u.tickSpacing,c,7);for(const d of l){const{publicKey:f}=wt(u.programId,u.id,d);s.push({pubkey:f}),i[f.toString()]=u.id}}const o=yield _n(t,s,{batchRequest:r}),a={};for(const u of o){if(!u.accountInfo)continue;const c=i[u.pubkey.toString()];if(!c)continue;a[c.toString()]===void 0&&(a[c.toString()]={});const l=pr.decode(u.accountInfo.data);a[c.toString()][l.startTickIndex]=yt(Z({},l),{address:u.pubkey})}return a})}static fetchExBitmaps(e){return U(this,arguments,function*({connection:t,exBitmapAddress:n,batchRequest:r}){const i=yield _n(t,n.map(o=>({pubkey:o})),{batchRequest:r}),s={};for(const o of i)o.accountInfo!==null&&(s[o.pubkey.toString()]=Mc.decode(o.accountInfo.data));return s})}static getWhiteListMint(e){return U(this,arguments,function*({connection:t,programId:n}){const r=yield t.getAccountInfo(Zn(n).publicKey);return r?xc.decode(r.data).whitelistMints.filter(s=>!s.equals(R.default)):[]})}},ls="9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",Fc=new R(ls),Wc={[ls]:3},Dc={3:Fc},ds=F([Tt(5),Tt(8),q("ownAddress"),y("vaultSignerNonce"),q("baseMint"),q("quoteMint"),q("baseVault"),y("baseDepositsTotal"),y("baseFeesAccrued"),q("quoteVault"),y("quoteDepositsTotal"),y("quoteFeesAccrued"),y("quoteDustThreshold"),q("requestQueue"),q("eventQueue"),q("bids"),q("asks"),y("baseLotSize"),y("quoteLotSize"),y("feeRateBps"),y("referrerRebatesAccrued"),Tt(7)]),Uc={3:ds},An=_t.from("Serum"),vi=class{static getProgramId(e){const t=Dc[e];return An.assertArgument(!!t,"invalid version","version",e),t}static getVersion(e){const t=e.toBase58(),n=Wc[t];return An.assertArgument(!!n,"invalid program id","programId",t),n}static getStateLayout(e){const t=Uc[e];return An.assertArgument(!!t,"invalid version","version",e),t}static getLayouts(e){return{state:this.getStateLayout(e)}}static getAssociatedAuthority({programId:e,marketId:t}){const n=[t.toBuffer()];let r=0,i;for(;r<100;){try{const s=n.concat(M.from([r]),M.alloc(7));i=R.createProgramAddressSync(s,e)}catch(s){if(s instanceof TypeError)throw s;r++;continue}return{publicKey:i,nonce:r}}return An.throwArgumentError("unable to find a viable program address nonce","params",{programId:e,marketId:t})}},Ze=new R("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ce=5e4,Vc=F([y("x"),y("y"),y("price")]),Gc=F([y("accountType"),y("status"),y("multiplier"),y("validDataCount"),$(Vc,Ce,"DataElement")]);function zc(e,t){return[0,Ce-2]}function Xc(e){return[0,Ce-2]}function Yc(e){return[0,Ce-2]}function Qc(e,t,n){const[r,i]=zc();let s=r,o=i,a=0;const u=t*e.multiplier/n;for(;s<=o;){if(a=Math.floor((o+s)/2),a===0||a>=Ce-2)return[a,a,!1];const c=e.DataElement[a].x*e.multiplier/e.DataElement[a].y,l=e.DataElement[a-1].x*e.multiplier/e.DataElement[a-1].y,d=e.DataElement[a+1].x*e.multiplier/e.DataElement[a+1].y;if(u===c)return[a,a,!0];if(u===l)return[a-1,a-1,!0];if(u===d)return[a+1,a+1,!0];if(u<l)o=a-1;else{if(u>l&&u<c)return[a-1,a,!0];if(u>c&&u<d)return[a,a+1,!0];s=a+1}}return[a,a,!1]}function vr(e,t,n){const[r,i,s]=Qc(e,t,n);if(!s)return 0;if(r===i){const o=e.DataElement[r].x;return t*e.multiplier/o}else{const o=e.DataElement[r].x,a=e.DataElement[r].y,u=e.DataElement[i].x,c=e.DataElement[i].y,l=n*(u*a-o*c),d=o*l,f=(u-o)*(t*a-o*n)*c,m=d+f;return t*e.multiplier*l/m}}function Le(e,t,n){return t*e.multiplier/n}function ms(e,t,n){return t*n/e.multiplier}function Hc(e,t){const[n,r]=Xc();let i=n,s=r,o=0;const a=t;for(;i<s;){if(o=Math.floor((s+i)/2),o<=0||o>Ce-2)return[o,o,!1];const u=e.DataElement[o].x,c=e.DataElement[o-1].x,l=e.DataElement[o+1].x;if(a===u)return[o,o,!0];if(a===c)return[o-1,o-1,!0];if(a===l)return[o+1,o+1,!0];if(a<c)s=o-1;else{if(a>c&&a<u)return[o-1,o,!0];if(a>u&&a<l)return[o,o+1,!0];i=o+1}}return[o,o,!1]}function jc(e,t){const[n,r]=Yc();let i=n,s=r,o=0;const a=t;for(;i<=s;){if(o=Math.floor((s+i)/2),o<=0||o>=Ce-2)return[o,o,!1];const u=e.DataElement[o].y,c=e.DataElement[o-1].y,l=e.DataElement[o+1].y;if(a===u)return[o,o,!0];if(a===c)return[o-1,o-1,!0];if(a===l)return[o+1,o+1,!0];if(a<l)i=o+1;else{if(a<c&&a>u)return[o-1,o,!0];if(a<u&&a>l)return[o,o+1,!0];s=o-1}}return[o,o,!1]}function fs(e,t,n,r){const i=r?t+n:t-n,[s,o,a]=Hc(e,i);if(!a)return[0,0,!1,a];if(s===o)return[e.DataElement[o].price,e.DataElement[o].y,!1,a];{const u=e.DataElement[s].x,c=e.DataElement[o].x,l=e.DataElement[s].price,d=e.DataElement[o].price,f=e.DataElement[s].y,m=e.DataElement[o].y;if(t>=u&&t<=c)return r?[d,m,!0,a]:[l,f,!0,a];{let p,g;return r?(p=l+(d-l)*(t-u)/(c-u),g=f-(i-u)*e.multiplier/d):(p=l+(d-l)*(t-u)/(c-u),g=m+(c-i)*e.multiplier/l),[p,g,!1,a]}}}function Zc(e,t,n,r){const i=t+n,[s,o,a]=jc(e,i);if(!a)return[0,0,!1,a];if(s===o)return[e.DataElement[o].price,e.DataElement[o].x,!1,a];{const u=e.DataElement[s].x,c=e.DataElement[o].x,l=e.DataElement[s].price,d=e.DataElement[o].price,f=e.DataElement[s].y,m=e.DataElement[o].y;if(t>=m&&t<=f)return[l,u,!0,a];{let p,g;return p=l+(d-l)*(f-t)/(f-m),g=c-l*(i-m)/e.multiplier,[p,g,!1,a]}}}function $c(e,t){const n=fs(e,t,0,!1);return n[3]?n[0]:0}function Kc(e,t,n,r){const i=vr(e,t,n),s=Le(e,t,i),o=Le(e,n,i),a=Le(e,r,i),u=!0,[c,l,d,f]=fs(e,s,a,u);if(!f)return 0;if(d)return r*e.multiplier/c;{const m=o-l;return ms(e,m,i)}}function Jc(e,t,n,r){const i=vr(e,t,n),s=Le(e,t,i),o=Le(e,n,i),a=Le(e,r,i),[u,c,l,d]=Zc(e,o,a);if(!d)return 0;if(l)return r*u/e.multiplier;{const f=s-c;return ms(e,f,i)}}function tu(e){const t=Gc.decode(e);return{accountType:t.accountType.toNumber(),status:t.status.toNumber(),multiplier:t.multiplier.toNumber(),validDataCount:t.validDataCount.toNumber(),DataElement:t.DataElement.map(n=>({x:n.x.toNumber(),y:n.y.toNumber(),price:n.price.toNumber()}))}}function eu(e,t,n,r){return 1/($c(e,Le(e,t,vr(e,t,n)))/e.multiplier)}var z=_t.from("Liquidity"),en={multiplier:0,validDataCount:0,DataElement:[]};function nu(e){return U(this,null,function*(){if(en.validDataCount===0&&e){const t=yield e.getAccountInfo(Ze);t&&(en=tu(t==null?void 0:t.data))}})}var ps=new I(25),Ar=new I(1e4),$e=class gs extends Fn{static getStateLayout(t){const n=gi[t];return z.assertArgument(!!n,"invalid version","version",t),n}static getLayouts(t){return{state:this.getStateLayout(t)}}static getAssociatedId({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("amm_associated_seed","utf-8")],t);return r}static getAssociatedAuthority({programId:t}){return ct([M.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],t)}static getAssociatedBaseVault({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("coin_vault_associated_seed","utf-8")],t);return r}static getAssociatedQuoteVault({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("pc_vault_associated_seed","utf-8")],t);return r}static getAssociatedLpMint({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("lp_mint_associated_seed","utf-8")],t);return r}static getAssociatedLpVault({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("temp_lp_token_associated_seed","utf-8")],t);return r}static getAssociatedTargetOrders({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("target_associated_seed","utf-8")],t);return r}static getAssociatedWithdrawQueue({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("withdraw_associated_seed","utf-8")],t);return r}static getAssociatedOpenOrders({programId:t,marketId:n}){const{publicKey:r}=ct([t.toBuffer(),n.toBuffer(),M.from("open_order_associated_seed","utf-8")],t);return r}static getAssociatedConfigId({programId:t}){const{publicKey:n}=ct([M.from("amm_config_account_seed","utf-8")],t);return n}static getAssociatedPoolKeys({version:t,marketVersion:n,marketId:r,baseMint:i,quoteMint:s,baseDecimals:o,quoteDecimals:a,programId:u,marketProgramId:c}){const l=this.getAssociatedId({programId:u,marketId:r}),d=this.getAssociatedLpMint({programId:u,marketId:r}),{publicKey:f,nonce:m}=this.getAssociatedAuthority({programId:u}),p=this.getAssociatedBaseVault({programId:u,marketId:r}),g=this.getAssociatedQuoteVault({programId:u,marketId:r}),k=this.getAssociatedLpVault({programId:u,marketId:r}),A=this.getAssociatedOpenOrders({programId:u,marketId:r}),h=this.getAssociatedTargetOrders({programId:u,marketId:r}),w=this.getAssociatedWithdrawQueue({programId:u,marketId:r}),{publicKey:T}=vi.getAssociatedAuthority({programId:c,marketId:r});return{id:l,baseMint:i,quoteMint:s,lpMint:d,baseDecimals:o,quoteDecimals:a,lpDecimals:o,version:t,programId:u,authority:f,nonce:m,baseVault:p,quoteVault:g,lpVault:k,openOrders:A,targetOrders:h,withdrawQueue:w,marketVersion:n,marketProgramId:c,marketId:r,marketAuthority:T,lookupTableAccount:R.default,configId:this.getAssociatedConfigId({programId:u})}}static getCreatePoolFee(t){return U(this,arguments,function*({connection:n,programId:r}){const i=this.getAssociatedConfigId({programId:r}),s=F([y("fee")]),o=yield n.getAccountInfo(i,{dataSlice:{offset:536,length:8}});if(o===null)throw Error("get config account error");return s.decode(o.data).fee})}static makeAddLiquidityInstruction(t){const{poolKeys:n,userKeys:r,baseAmountIn:i,quoteAmountIn:s,fixedSide:o}=t,{version:a}=n;if(a===4||a===5){const u=F([V("instruction"),y("baseAmountIn"),y("quoteAmountIn"),y("fixedSide")]),c=M.alloc(u.span);u.encode({instruction:3,baseAmountIn:X(i),quoteAmountIn:X(s),fixedSide:X(o==="base"?0:1)},c);const l=[E(N,!1),B(n.id,!1),E(n.authority,!1),E(n.openOrders,!1),B(n.targetOrders,!1),B(n.lpMint,!1),B(n.baseVault,!1),B(n.quoteVault,!1)];return a===5&&l.push(B(Ze,!1)),l.push(E(n.marketId,!1),B(r.baseTokenAccount,!1),B(r.quoteTokenAccount,!1),B(r.lpTokenAccount,!1),E(r.owner,!0),E(n.marketEventQueue,!1)),{address:{},innerTransaction:{instructions:[new nt({programId:n.programId,keys:l,data:c})],signers:[],lookupTableAddress:[n.lookupTableAccount].filter(d=>d&&!d.equals(R.default)),instructionTypes:[a===4?22:30]}}}return z.throwArgumentError("invalid version","poolKeys.version",a)}static makeAddLiquidityInstructionSimple(t){return U(this,null,function*(){const{connection:n,poolKeys:r,userKeys:i,amountInA:s,amountInB:o,fixedSide:a,config:u,makeTxVersion:c,lookupTableCache:l,computeBudgetConfig:d}=t,{lpMint:f}=r,{tokenAccounts:m,owner:p,payer:g=p}=i;z.debug("amountInA:",s),z.debug("amountInB:",o),z.assertArgument(!s.isZero()&&!o.isZero(),"amounts must greater than zero","amountInA & amountInB",{amountInA:s.toFixed(),amountInB:o.toFixed()});const{bypassAssociatedCheck:k,checkCreateATAOwner:A}=Z(Z({},{bypassAssociatedCheck:!1,checkCreateATAOwner:!1}),u),h=s instanceof ft?s.token:C.WSOL,w=o instanceof ft?o.token:C.WSOL,T=this._selectTokenAccount({programId:N,tokenAccounts:m,mint:h.mint,owner:p,config:{associatedOnly:!1}}),b=this._selectTokenAccount({programId:N,tokenAccounts:m,mint:w.mint,owner:p,config:{associatedOnly:!1}});z.assertArgument(!!T||!!b,"cannot found target token accounts","tokenAccounts",m);const v=this._selectTokenAccount({programId:N,tokenAccounts:m,mint:f,owner:p}),S=[h,w],P=[T,b],O=[s.raw,o.raw],[L]=this._getAmountsSide(s,o,r);let _="base";if(L==="quote")if(S.reverse(),P.reverse(),O.reverse(),a==="a")_="quote";else if(a==="b")_="base";else return z.throwArgumentError("invalid fixedSide","fixedSide",a);else if(L==="base")if(a==="a")_="base";else if(a==="b")_="quote";else return z.throwArgumentError("invalid fixedSide","fixedSide",a);else return z.throwArgumentError("invalid fixedSide","fixedSide",a);const[W,D]=S,[et,G]=P,[H,At]=O,Gt=[],ue=[],re=[],ye=[],Ct=[],Ye=yield this._handleTokenAccount({programId:N,connection:n,side:"in",amount:H,mint:W.mint,tokenAccount:et,owner:p,payer:g,frontInstructions:Gt,endInstructions:ue,signers:Ct,bypassAssociatedCheck:k,frontInstructionsType:re,endInstructionsType:ye,checkCreateATAOwner:A}),ln=yield this._handleTokenAccount({programId:N,connection:n,side:"in",amount:At,mint:D.mint,tokenAccount:G,owner:p,payer:g,frontInstructions:Gt,endInstructions:ue,signers:Ct,bypassAssociatedCheck:k,frontInstructionsType:re,endInstructionsType:ye,checkCreateATAOwner:A}),Ir=yield this._handleTokenAccount({programId:N,connection:n,side:"out",amount:0,mint:f,tokenAccount:v,owner:p,payer:g,frontInstructions:Gt,endInstructions:ue,signers:Ct,bypassAssociatedCheck:k,frontInstructionsType:re,endInstructionsType:ye,checkCreateATAOwner:A}),As=this.makeAddLiquidityInstruction({poolKeys:r,userKeys:{baseTokenAccount:Ye,quoteTokenAccount:ln,lpTokenAccount:Ir,owner:p},baseAmountIn:H,quoteAmountIn:At,fixedSide:_});return{address:{lpTokenAccount:Ir},innerTransactions:yield at({connection:n,makeTxVersion:c,computeBudgetConfig:d,payer:g,innerTransaction:[{instructionTypes:re,instructions:Gt,signers:Ct},As.innerTransaction,{instructionTypes:ye,instructions:ue,signers:[]}],lookupTableCache:l})}})}static makeRemoveLiquidityInstruction(t){const{poolKeys:n,userKeys:r,amountIn:i}=t,{version:s}=n;if(s===4||s===5){const o=F([V("instruction"),y("amountIn")]),a=M.alloc(o.span);o.encode({instruction:4,amountIn:X(i)},a);const u=[E(N,!1),B(n.id,!1),E(n.authority,!1),B(n.openOrders,!1),B(n.targetOrders,!1),B(n.lpMint,!1),B(n.baseVault,!1),B(n.quoteVault,!1)];return s===5?u.push(B(Ze,!1)):(u.push(B(n.withdrawQueue,!1)),u.push(B(n.lpVault,!1))),u.push(E(n.marketProgramId,!1),B(n.marketId,!1),B(n.marketBaseVault,!1),B(n.marketQuoteVault,!1),E(n.marketAuthority,!1),B(r.lpTokenAccount,!1),B(r.baseTokenAccount,!1),B(r.quoteTokenAccount,!1),E(r.owner,!0),B(n.marketEventQueue,!1),B(n.marketBids,!1),B(n.marketAsks,!1)),{address:{},innerTransaction:{instructions:[new nt({programId:n.programId,keys:u,data:a})],signers:[],lookupTableAddress:[n.lookupTableAccount].filter(c=>c&&!c.equals(R.default)),instructionTypes:[s===4?23:31]}}}return z.throwArgumentError("invalid version","poolKeys.version",s)}static makeRemoveLiquidityInstructionSimple(t){return U(this,null,function*(){const{connection:n,poolKeys:r,userKeys:i,amountIn:s,config:o,makeTxVersion:a,lookupTableCache:u,computeBudgetConfig:c}=t,{baseMint:l,quoteMint:d,lpMint:f}=r,{tokenAccounts:m,owner:p,payer:g=p}=i;z.debug("amountIn:",s),z.assertArgument(!s.isZero(),"amount must greater than zero","amountIn",s.toFixed()),z.assertArgument(s instanceof ft&&s.token.mint.equals(f),"amountIn's token not match lpMint","amountIn",s);const k=this._selectTokenAccount({programId:N,tokenAccounts:m,mint:f,owner:p,config:{associatedOnly:!1}});if(!k)return z.throwArgumentError("cannot found lpTokenAccount","tokenAccounts",m);const A=this._selectTokenAccount({programId:N,tokenAccounts:m,mint:l,owner:p}),h=this._selectTokenAccount({programId:N,tokenAccounts:m,mint:d,owner:p}),{bypassAssociatedCheck:w,checkCreateATAOwner:T}=Z(Z({},{bypassAssociatedCheck:!1,checkCreateATAOwner:!1}),o),b=[],v=[],S=[],P=[],O=[],L=k,_=yield this._handleTokenAccount({programId:N,connection:n,side:"out",amount:0,mint:l,tokenAccount:A,owner:p,payer:g,frontInstructions:b,endInstructions:v,signers:O,bypassAssociatedCheck:w,frontInstructionsType:S,checkCreateATAOwner:T}),W=yield this._handleTokenAccount({programId:N,connection:n,side:"out",amount:0,mint:d,tokenAccount:h,owner:p,payer:g,frontInstructions:b,endInstructions:v,signers:O,bypassAssociatedCheck:w,frontInstructionsType:S,checkCreateATAOwner:T}),D=this.makeRemoveLiquidityInstruction({poolKeys:r,userKeys:{lpTokenAccount:L,baseTokenAccount:_,quoteTokenAccount:W,owner:p},amountIn:s.raw});return{address:{lpTokenAccount:L},innerTransactions:yield at({connection:n,makeTxVersion:a,computeBudgetConfig:c,payer:g,innerTransaction:[{instructionTypes:S,instructions:b,signers:O},D.innerTransaction,{instructionTypes:P,instructions:v,signers:[]}],lookupTableCache:u})}})}static makeSwapInstruction(t){const{poolKeys:n,userKeys:r,amountIn:i,amountOut:s,fixedSide:o}=t,{version:a}=n;return a===4||a===5?o==="in"?this.makeSwapFixedInInstruction({poolKeys:n,userKeys:r,amountIn:i,minAmountOut:s},a):o==="out"?this.makeSwapFixedOutInstruction({poolKeys:n,userKeys:r,maxAmountIn:i,amountOut:s},a):z.throwArgumentError("invalid params","params",t):z.throwArgumentError("invalid version","poolKeys.version",a)}static makeSwapFixedInInstruction({poolKeys:t,userKeys:n,amountIn:r,minAmountOut:i},s){const o=F([V("instruction"),y("amountIn"),y("minAmountOut")]),a=M.alloc(o.span);o.encode({instruction:9,amountIn:X(r),minAmountOut:X(i)},a);const u=[E(N,!1),B(t.id,!1),E(t.authority,!1),B(t.openOrders,!1)];return s===4&&u.push(B(t.targetOrders,!1)),u.push(B(t.baseVault,!1),B(t.quoteVault,!1)),s===5&&u.push(B(Ze,!1)),u.push(E(t.marketProgramId,!1),B(t.marketId,!1),B(t.marketBids,!1),B(t.marketAsks,!1),B(t.marketEventQueue,!1),B(t.marketBaseVault,!1),B(t.marketQuoteVault,!1),E(t.marketAuthority,!1),B(n.tokenAccountIn,!1),B(n.tokenAccountOut,!1),E(n.owner,!0)),{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:u,data:a})],signers:[],lookupTableAddress:[t.lookupTableAccount].filter(c=>c&&!c.equals(R.default)),instructionTypes:[s===4?25:33]}}}static makeSwapFixedOutInstruction({poolKeys:t,userKeys:n,maxAmountIn:r,amountOut:i},s){const o=F([V("instruction"),y("maxAmountIn"),y("amountOut")]),a=M.alloc(o.span);o.encode({instruction:11,maxAmountIn:X(r),amountOut:X(i)},a);const u=[E(N,!1),B(t.id,!1),E(t.authority,!1),B(t.openOrders,!1),B(t.targetOrders,!1),B(t.baseVault,!1),B(t.quoteVault,!1)];return s===5&&u.push(B(Ze,!1)),u.push(E(t.marketProgramId,!1),B(t.marketId,!1),B(t.marketBids,!1),B(t.marketAsks,!1),B(t.marketEventQueue,!1),B(t.marketBaseVault,!1),B(t.marketQuoteVault,!1),E(t.marketAuthority,!1),B(n.tokenAccountIn,!1),B(n.tokenAccountOut,!1),E(n.owner,!0)),{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:u,data:a})],signers:[],lookupTableAddress:[t.lookupTableAccount].filter(c=>c&&!c.equals(R.default)),instructionTypes:[s===4?26:34]}}}static makeSwapInstructionSimple(t){return U(this,null,function*(){const{connection:n,poolKeys:r,userKeys:i,amountIn:s,amountOut:o,fixedSide:a,config:u,makeTxVersion:c,lookupTableCache:l,computeBudgetConfig:d}=t,{tokenAccounts:f,owner:m,payer:p=m}=i;z.debug("amountIn:",s),z.debug("amountOut:",o),z.assertArgument(!s.isZero()&&!o.isZero(),"amounts must greater than zero","currencyAmounts",{amountIn:s.toFixed(),amountOut:o.toFixed()});const{bypassAssociatedCheck:g,checkCreateATAOwner:k}=Z(Z({},{bypassAssociatedCheck:!1,checkCreateATAOwner:!1}),u),A=s instanceof ft?s.token:C.WSOL,h=o instanceof ft?o.token:C.WSOL,w=this._selectTokenAccount({programId:N,tokenAccounts:f,mint:A.mint,owner:m,config:{associatedOnly:!1}}),T=this._selectTokenAccount({programId:N,tokenAccounts:f,mint:h.mint,owner:m}),[b,v]=[s.raw,o.raw],S=[],P=[],O=[],L=[],_=[],W=yield this._handleTokenAccount({programId:N,connection:n,side:"in",amount:b,mint:A.mint,tokenAccount:w,owner:m,payer:p,frontInstructions:S,endInstructions:P,signers:_,bypassAssociatedCheck:g,frontInstructionsType:O,checkCreateATAOwner:k}),D=yield this._handleTokenAccount({programId:N,connection:n,side:"out",amount:0,mint:h.mint,tokenAccount:T,owner:m,payer:p,frontInstructions:S,endInstructions:P,signers:_,bypassAssociatedCheck:g,frontInstructionsType:O,checkCreateATAOwner:k}),et=this.makeSwapInstruction({poolKeys:r,userKeys:{tokenAccountIn:W,tokenAccountOut:D,owner:m},amountIn:b,amountOut:v,fixedSide:a});return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:c,computeBudgetConfig:d,payer:p,innerTransaction:[{instructionTypes:O,instructions:S,signers:_},et.innerTransaction,{instructionTypes:L,instructions:P,signers:[]}],lookupTableCache:l})}})}static makeSimulatePoolInfoInstruction({poolKeys:t}){const n=F([V("instruction"),V("simulateType")]),r=M.alloc(n.span);n.encode({instruction:12,simulateType:0},r);const i=[E(t.id,!1),E(t.authority,!1),E(t.openOrders,!1),E(t.baseVault,!1),E(t.quoteVault,!1),E(t.lpMint,!1),E(t.marketId,!1),E(t.marketEventQueue,!1)];return{address:{},innerTransaction:{instructions:[new nt({programId:t.programId,keys:i,data:r})],signers:[],lookupTableAddress:[t.lookupTableAccount].filter(s=>s&&!s.equals(R.default)),instructionTypes:[t.version===4?24:32]}}}static isV4(t){return t.withdrawQueue!==void 0}static makeCreatePoolV4InstructionV2Simple(t){return U(this,arguments,function*({connection:n,programId:r,marketInfo:i,baseMintInfo:s,quoteMintInfo:o,baseAmount:a,quoteAmount:u,startTime:c,ownerInfo:l,associatedOnly:d=!1,computeBudgetConfig:f,checkCreateATAOwner:m=!1,makeTxVersion:p,lookupTableCache:g,feeDestinationId:k}){const A=[],h=[],w=[],T=[],b=[],v=l.useSOLBalance&&s.mint.equals(C.WSOL.mint),S=l.useSOLBalance&&o.mint.equals(C.WSOL.mint),P=yield this._selectOrCreateTokenAccount({programId:N,mint:s.mint,tokenAccounts:v?[]:l.tokenAccounts,owner:l.wallet,createInfo:v?{connection:n,payer:l.feePayer,amount:a,frontInstructions:A,frontInstructionsType:w,endInstructions:v?h:[],endInstructionsType:v?T:[],signers:b}:void 0,associatedOnly:v?!1:d,checkCreateATAOwner:m}),O=yield this._selectOrCreateTokenAccount({programId:N,mint:o.mint,tokenAccounts:S?[]:l.tokenAccounts,owner:l.wallet,createInfo:S?{connection:n,payer:l.feePayer,amount:u,frontInstructions:A,frontInstructionsType:w,endInstructions:S?h:[],endInstructionsType:S?T:[],signers:b}:void 0,associatedOnly:S?!1:d,checkCreateATAOwner:m});if(P===void 0||O===void 0)throw Error("you don't has some token account");const L=gs.getAssociatedPoolKeys({version:4,marketVersion:3,marketId:i.marketId,baseMint:s.mint,quoteMint:o.mint,baseDecimals:s.decimals,quoteDecimals:o.decimals,programId:r,marketProgramId:i.programId}),_=this.makeCreatePoolV4InstructionV2({programId:r,ammId:L.id,ammAuthority:L.authority,ammOpenOrders:L.openOrders,lpMint:L.lpMint,coinMint:L.baseMint,pcMint:L.quoteMint,coinVault:L.baseVault,pcVault:L.quoteVault,ammTargetOrders:L.targetOrders,marketProgramId:L.marketProgramId,marketId:L.marketId,userWallet:l.wallet,userCoinVault:P,userPcVault:O,userLpVault:St(l.wallet,L.lpMint,N).publicKey,ammConfigId:L.configId,feeDestinationId:k,nonce:L.nonce,openTime:c,coinAmount:a,pcAmount:u}).innerTransaction;return{address:{programId:r,ammId:L.id,ammAuthority:L.authority,ammOpenOrders:L.openOrders,lpMint:L.lpMint,coinMint:L.baseMint,pcMint:L.quoteMint,coinVault:L.baseVault,pcVault:L.quoteVault,withdrawQueue:L.withdrawQueue,ammTargetOrders:L.targetOrders,poolTempLp:L.lpVault,marketProgramId:L.marketProgramId,marketId:L.marketId},innerTransactions:yield at({connection:n,makeTxVersion:p,computeBudgetConfig:f,payer:l.feePayer,innerTransaction:[{instructionTypes:w,instructions:A,signers:b},_,{instructionTypes:T,instructions:h,signers:[]}],lookupTableCache:g})}})}static makeCreatePoolV4InstructionV2({programId:t,ammId:n,ammAuthority:r,ammOpenOrders:i,lpMint:s,coinMint:o,pcMint:a,coinVault:u,pcVault:c,ammTargetOrders:l,marketProgramId:d,marketId:f,userWallet:m,userCoinVault:p,userPcVault:g,userLpVault:k,nonce:A,openTime:h,coinAmount:w,pcAmount:T,lookupTableAddress:b,ammConfigId:v,feeDestinationId:S}){const P=F([V("instruction"),V("nonce"),y("openTime"),y("pcAmount"),y("coinAmount")]),O=[{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:Xe,isSigner:!1,isWritable:!1},{pubkey:Pt,isSigner:!1,isWritable:!1},{pubkey:Ne,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!0,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0}],L=M.alloc(P.span);P.encode({instruction:1,nonce:A,openTime:h,coinAmount:w,pcAmount:T},L);const _=new nt({keys:O,programId:t,data:L});return{address:{},innerTransaction:{instructions:[_],signers:[],lookupTableAddress:b?[b]:void 0,instructionTypes:[29]}}}static makeRemoveAllLpAndCreateClmmPosition(t){return U(this,arguments,function*({connection:n,poolKeys:r,removeLpAmount:i,userKeys:s,clmmPoolKeys:o,createPositionInfo:a,farmInfo:u,computeBudgetConfig:c,checkCreateATAOwner:l=!1,getEphemeralSigners:d,makeTxVersion:f,lookupTableCache:m}){var p,g,k,A,h,w,T;if(!(r.baseMint.equals(o.mintA.mint)||r.baseMint.equals(o.mintB.mint))||!(r.quoteMint.equals(o.mintA.mint)||r.quoteMint.equals(o.mintB.mint)))throw Error("mint check error");const b=[],v=[],S=[],P=[],O=[],L={};for(const Ct of s.tokenAccounts)(L[Ct.accountInfo.mint.toString()]===void 0||St(s.owner,Ct.accountInfo.mint,N).publicKey.equals(Ct.pubkey))&&(L[Ct.accountInfo.mint.toString()]=Ct.pubkey);const _=L[r.lpMint.toString()];if(_===void 0)throw Error("find lp account error in trade accounts");const W=i.add((p=u==null?void 0:u.amount)!=null?p:new I(0)),D=r.baseMint.equals(C.WSOL.mint),et=r.quoteMint.equals(C.WSOL.mint),G=yield this._selectOrCreateTokenAccount({programId:N,mint:r.baseMint,tokenAccounts:s.tokenAccounts,owner:s.owner,createInfo:{connection:n,payer:(g=s.payer)!=null?g:s.owner,frontInstructions:b,frontInstructionsType:S,endInstructions:D?v:[],endInstructionsType:D?P:[],signers:O},associatedOnly:!0,checkCreateATAOwner:l}),H=yield this._selectOrCreateTokenAccount({programId:N,mint:r.quoteMint,tokenAccounts:s.tokenAccounts,owner:s.owner,createInfo:{connection:n,payer:(k=s.payer)!=null?k:s.owner,amount:0,frontInstructions:b,frontInstructionsType:S,endInstructions:et?v:[],endInstructionsType:et?P:[],signers:O},associatedOnly:!0,checkCreateATAOwner:l});L[r.baseMint.toString()]=G,L[r.quoteMint.toString()]=H;const At=this.makeRemoveLiquidityInstruction({poolKeys:r,userKeys:{lpTokenAccount:_,baseTokenAccount:G,quoteTokenAccount:H,owner:s.owner},amountIn:W}),[Gt,ue]=r.baseMint.equals(o.mintA.mint)?[G,H]:[H,G],re=yield Cc.makeOpenPositionFromLiquidityInstructions(yt(Z({poolInfo:o,ownerInfo:{feePayer:(A=s.payer)!=null?A:s.owner,wallet:s.owner,tokenAccountA:Gt,tokenAccountB:ue},withMetadata:"create"},a),{getEphemeralSigners:d}));let ye={instructions:[],signers:[],instructionTypes:[]};if(u!==void 0){const Ct=[];for(const Ye of u.poolKeys.rewardInfos){const ln=Ye.rewardMint.equals(C.WSOL.mint);Ct.push((w=L[Ye.rewardMint.toString()])!=null?w:yield this._selectOrCreateTokenAccount({programId:N,mint:Ye.rewardMint,tokenAccounts:s.tokenAccounts,owner:s.owner,createInfo:{connection:n,payer:(h=s.payer)!=null?h:s.owner,frontInstructions:b,frontInstructionsType:S,endInstructions:ln?v:[],endInstructionsType:ln?P:[],signers:O},associatedOnly:!0,checkCreateATAOwner:l}))}ye=fi.makeWithdrawInstruction({poolKeys:u.poolKeys,amount:u.amount,userKeys:{ledger:fi.getAssociatedLedgerAccount({programId:u.poolKeys.programId,poolId:u.poolKeys.id,owner:s.owner,version:u.poolKeys.version}),lpTokenAccount:_,rewardTokenAccounts:Ct,owner:s.owner}}).innerTransaction}return{address:Z(Z({},At.address),re.address),innerTransactions:yield at({connection:n,makeTxVersion:f,computeBudgetConfig:c,payer:(T=s.payer)!=null?T:s.owner,innerTransaction:[{instructionTypes:S,instructions:b,signers:O},ye,At.innerTransaction,re.innerTransaction,{instructionTypes:P,instructions:v,signers:[]}],lookupTableCache:m})}})}static fetchAllPoolKeys(t,n,r){return U(this,null,function*(){const i=(yield Promise.all(Object.entries(gi).map(([c,l])=>{try{return t.getProgramAccounts(n[Number(c)],{filters:[{dataSize:l.span}]}).then(d=>d.map(f=>Z({id:f.pubkey,version:Number(c),programId:n[Number(c)]},l.decode(f.account.data))))}catch(d){if(d instanceof Error)return z.throwError("failed to fetch pool info",_t.errors.RPC_ERROR,{message:d.message})}}))).flat(),s=i.map(c=>c.marketId),o={};try{const c=yield ce(t,s,r);for(const l of c){if(l===null)continue;const d=Z({programId:l.owner},ds.decode(l.data));o[d.ownAddress.toString()]=d}}catch(c){if(c instanceof Error)return z.throwError("failed to fetch markets",_t.errors.RPC_ERROR,{message:c.message})}const a={};for(const[c,l]of Object.entries(n))a[c]=this.getAssociatedAuthority({programId:l}).publicKey;const u=[];for(const c of i){if(c===void 0||c.baseMint.equals(R.default))continue;const l=o[c.marketId.toString()],d=l.programId;u.push(yt(Z({id:c.id,baseMint:c.baseMint,quoteMint:c.quoteMint,lpMint:c.lpMint,baseDecimals:c.baseDecimal.toNumber(),quoteDecimals:c.quoteDecimal.toNumber(),lpDecimals:c.id.toString()==="6kmMMacvoCKBkBrqssLEdFuEZu2wqtLdNQxh9VjtzfwT"?5:c.baseDecimal.toNumber(),version:c.version,programId:c.programId,authority:a[c.version],openOrders:c.openOrders,targetOrders:c.targetOrders,baseVault:c.baseVault,quoteVault:c.quoteVault,marketVersion:3,marketProgramId:d,marketId:l.ownAddress,marketAuthority:vi.getAssociatedAuthority({programId:d,marketId:l.ownAddress}).publicKey,marketBaseVault:l.baseVault,marketQuoteVault:l.quoteVault,marketBids:l.bids,marketAsks:l.asks,marketEventQueue:l.eventQueue},c.version===5?{modelDataAccount:c.modelDataAccount,withdrawQueue:R.default,lpVault:R.default}:{withdrawQueue:c.withdrawQueue,lpVault:c.lpVault}),{lookupTableAccount:R.default}))}return u})}static fetchInfo(t){return U(this,arguments,function*({connection:n,poolKeys:r}){const i=yield this.fetchMultipleInfo({connection:n,pools:[r]});return z.assertArgument(i.length===1,`fetchInfo failed, ${i.length} pools found`,"poolKeys.id",r.id),i[0]})}static fetchMultipleInfo(t){return U(this,arguments,function*({connection:n,pools:r,config:i}){yield nu(n);const s=r.map(u=>this.makeSimulatePoolInfoInstruction({poolKeys:u}));return(yield ma(n,s.map(u=>u.innerTransaction.instructions).flat(),"GetPoolData")).map(u=>{const c=fa(u,"GetPoolData"),l=new I(me(c,"status")),d=Number(me(c,"coin_decimals")),f=Number(me(c,"pc_decimals")),m=Number(me(c,"lp_decimals")),p=new I(me(c,"pool_coin_amount")),g=new I(me(c,"pool_pc_amount")),k=new I(me(c,"pool_lp_supply"));let A="0";try{A=me(c,"pool_open_time")}catch{}return{status:l,baseDecimals:d,quoteDecimals:f,lpDecimals:m,baseReserve:p,quoteReserve:g,lpSupply:k,startTime:new I(A)}})})}static getEnabledFeatures(t){const{status:n}=t,r=n.toNumber();if(r===0)return{swap:!1,addLiquidity:!1,removeLiquidity:!1};if(r===1)return{swap:!0,addLiquidity:!0,removeLiquidity:!0};if(r===2)return{swap:!1,addLiquidity:!1,removeLiquidity:!1};if(r===3)return{swap:!1,addLiquidity:!1,removeLiquidity:!0};if(r===4)return{swap:!1,addLiquidity:!0,removeLiquidity:!0};if(r===5)return{swap:!1,addLiquidity:!0,removeLiquidity:!0};if(r===6)return{swap:!0,addLiquidity:!0,removeLiquidity:!0};if(r===7){const{startTime:i}=t;return Date.now()/1e3<i.toNumber()?{swap:!1,addLiquidity:!0,removeLiquidity:!0}:{swap:!0,addLiquidity:!0,removeLiquidity:!0}}else return{swap:!1,addLiquidity:!1,removeLiquidity:!1}}static includesToken(t,n){const{baseMint:r,quoteMint:i}=n;return t.mint.equals(r)||t.mint.equals(i)}static _getTokenSide(t,n){const{baseMint:r,quoteMint:i}=n;return t.mint.equals(r)?"base":t.mint.equals(i)?"quote":z.throwArgumentError("token not match with pool","params",{token:t.mint,baseMint:r,quoteMint:i})}static _getTokensSide(t,n,r){const{baseMint:i,quoteMint:s}=r,o=this._getTokenSide(t,r),a=this._getTokenSide(n,r);return z.assertArgument(o!==a,"tokens not match with pool","params",{tokenA:t.mint,tokenB:n.mint,baseMint:i,quoteMint:s}),[o,a]}static _getAmountSide(t,n){const r=t instanceof ft?t.token:C.WSOL;return this._getTokenSide(r,n)}static _getAmountsSide(t,n,r){const i=t instanceof ft?t.token:C.WSOL,s=n instanceof ft?n.token:C.WSOL;return this._getTokensSide(i,s,r)}static computeAnotherAmount({poolKeys:t,poolInfo:n,amount:r,anotherCurrency:i,slippage:s}){const{baseReserve:o,quoteReserve:a}=n;z.debug("baseReserve:",o.toString()),z.debug("quoteReserve:",a.toString());const u=r instanceof ft?r.token:r.currency;z.debug("currencyIn:",u),z.debug("amount:",r.toFixed()),z.debug("anotherCurrency:",i),z.debug("slippage:",`${s.toSignificant()}%`);const c=this._getAmountSide(r,t);z.debug("input side:",c);let l=Y;r.isZero()||(l=c==="base"?Yn(r.raw.mul(a),o):Yn(r.raw.mul(o),a));const d=Yn(r.raw.mul(n.lpSupply),c==="base"?n.baseReserve:n.quoteReserve),m=new Oe(gt).add(s).mul(l).quotient,p=i instanceof C?new ft(i,l):new xt(i,l),g=i instanceof C?new ft(i,m):new xt(i,m);return z.debug("anotheAmount:",p.toFixed()),z.debug("maxAnotheAmount:",g.toFixed()),{anotherAmount:p,maxAnotherAmount:g,liquidity:d}}static _computePriceImpact(t,n,r){const i=t.raw.mul(n),s=i.sub(r).div(i);return new Oe(s.numerator,s.denominator)}static getRate(t){const{baseReserve:n,quoteReserve:r,baseDecimals:i,quoteDecimals:s}=t;return new $t(new rn(i),n,new rn(s),r)}static computeAmountIn({poolKeys:t,poolInfo:n,amountOut:r,currencyIn:i,slippage:s}){const{baseReserve:o,quoteReserve:a}=n;z.debug("baseReserve:",o.toString()),z.debug("quoteReserve:",a.toString());const u=r instanceof ft?r.token:r.currency;z.debug("currencyOut:",u),z.debug("amountOut:",r.toFixed()),z.debug("currencyIn:",i),z.debug("slippage:",`${s.toSignificant()}%`);const c=[o,a],l=this._getAmountSide(r,t);l==="base"&&c.reverse(),z.debug("output side:",l);const[d,f]=c,m=new $t(i,d,u,f);z.debug("currentPrice:",`1 ${i.symbol}  ${m.toFixed()} ${u.symbol}`),z.debug("currentPrice invert:",`1 ${u.symbol}  ${m.invert().toFixed()} ${i.symbol}`);let p=Y,g=r.raw;if(!g.isZero()){g.gt(f)&&(g=f.sub(gt));const v=f.sub(g);p=d.mul(g).div(v).mul(Ar).div(Ar.sub(ps))}const A=new Oe(gt).add(s).mul(p).quotient,h=i instanceof C?new ft(i,p):new xt(i,p),w=i instanceof C?new ft(i,A):new xt(i,A);z.debug("amountIn:",h.toFixed()),z.debug("maxAmountIn:",w.toFixed());let T=null;!p.isZero()&&!g.isZero()&&(T=new $t(i,p,u,g),z.debug("executionPrice:",`1 ${i.symbol}  ${T.toFixed()} ${u.symbol}`),z.debug("executionPrice invert:",`1 ${u.symbol}  ${T.invert().toFixed()} ${i.symbol}`));const b=this._computePriceImpact(m,p,g);return z.debug("priceImpact:",`${b.toSignificant()}%`),{amountIn:h,maxAmountIn:w,currentPrice:m,executionPrice:T,priceImpact:b}}};$e.computeAmountOut=({poolKeys:e,poolInfo:t,amountIn:n,currencyOut:r,slippage:i})=>{const s=n instanceof ft?n.token:C.WSOL,o=r instanceof C?r:C.WSOL;z.assertArgument($e.includesToken(s,e)&&$e.includesToken(o,e),"token not match with pool","poolKeys",{poolKeys:e,tokenIn:s,tokenOut:o});const{baseReserve:a,quoteReserve:u}=t;z.debug("baseReserve:",a.toString()),z.debug("quoteReserve:",u.toString());const c=n instanceof ft?n.token:n.currency;z.debug("currencyIn:",c),z.debug("amountIn:",n.toFixed()),z.debug("currencyOut:",r),z.debug("slippage:",`${i.toSignificant()}%`);const l=[a,u],d=$e._getAmountSide(n,e);d==="quote"&&l.reverse(),z.debug("input side:",d);const[f,m]=l;let p;if(e.version===4)p=new $t(c,f,r,m);else{const _=eu(en,a.toNumber(),u.toNumber());d==="quote"?p=new $t(c,new I(_*1e6),r,new I(1e6)):p=new $t(c,new I(1e6),r,new I(_*1e6))}z.debug("currentPrice:",`1 ${c.symbol}  ${p.toFixed()} ${r.symbol}`),z.debug("currentPrice invert:",`1 ${r.symbol}  ${p.invert().toFixed()} ${c.symbol}`);const g=n.raw;let k=Y,A=Y;if(!g.isZero())if(e.version===4){A=kn(g.mul(ps),Ar);const _=g.sub(A),W=f.add(_);k=m.mul(_).div(W)}else{A=g.mul(new I(2)).div(new I(1e4));const _=g.sub(A);d==="quote"?k=new I(Kc(en,u.toNumber(),a.toNumber(),_.toNumber())):k=new I(Jc(en,u.toNumber(),a.toNumber(),_.toNumber()))}const w=new Oe(gt).add(i).invert().mul(k).quotient,T=r instanceof C?new ft(r,k):new xt(r,k),b=r instanceof C?new ft(r,w):new xt(r,w);z.debug("amountOut:",T.toFixed()),z.debug("minAmountOut:",b.toFixed());let v=new $t(c,g.sub(A),r,k);!g.isZero()&&!k.isZero()&&(v=new $t(c,g.sub(A),r,k),z.debug("executionPrice:",`1 ${c.symbol}  ${v.toFixed()} ${r.symbol}`),z.debug("executionPrice invert:",`1 ${r.symbol}  ${v.invert().toFixed()} ${c.symbol}`));const S=v.denominator.mul(p.numerator),P=v.numerator.mul(p.denominator).sub(S).abs(),O=new Oe(P,S);z.debug("priceImpact:",`${O.toSignificant()}%`);const L=c instanceof C?new ft(c,A):new xt(c,A);return{amountOut:T,minAmountOut:b,currentPrice:p,executionPrice:v,priceImpact:O,fee:L}};var cu=$e;new R("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),new R("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),new R("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),new R("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),new R("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),new R("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),new R("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),new R("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),new R("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),new R("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS");R.default,new R("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),R.default,new R("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),new R("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),new R("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),new R("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),new R("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),new R("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),new R("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU");function ru(e="accountFlags"){const t=new Oa(e);return t.addBoolean("initialized"),t.addBoolean("market"),t.addBoolean("openOrders"),t.addBoolean("requestQueue"),t.addBoolean("eventQueue"),t.addBoolean("bids"),t.addBoolean("asks"),t}F([Tt(5),ru("accountFlags"),q("ownAddress"),y("vaultSignerNonce"),q("baseMint"),q("quoteMint"),q("baseVault"),y("baseDepositsTotal"),y("baseFeesAccrued"),q("quoteVault"),y("quoteDepositsTotal"),y("quoteFeesAccrued"),y("quoteDustThreshold"),q("requestQueue"),q("eventQueue"),q("bids"),q("asks"),y("baseLotSize"),y("quoteLotSize"),y("feeRateBps"),y("referrerRebatesAccrued"),Tt(7)]);var we=class extends Fn{static getPdaPoolId(t,n){return ct([this.SEED_CONFIG.pool.id,n.toBuffer()],t)}static getPdaOwnerId(t,n,r,i){return ct([this.SEED_CONFIG.owner.id,n.toBuffer(),r.toBuffer(),M.from(new I(i).toArray())],t)}static getAllInfo(t){return U(this,arguments,function*({connection:n,programId:r,poolIds:i,wallet:s,chainTime:o}){if(i.length===0)return[];const a=i.map(d=>this.getPdaPoolId(r,d).publicKey),u=[];for(let d=0;d<this.VERSION_PROJECT.length;d++)u.push(...a.map(f=>this.getPdaOwnerId(r,f,s,d).publicKey));const c=yield ce(n,[...a,...u]),l=[];for(let d=0;d<c.length;d++){const f=Math.floor(d/i.length),m=d%i.length,p=a[m],g=u[d],k=c[m],A=c[i.length+d];if(!(k&&A)||k.data.length!==this.POOL_LAYOUT.span||A.data.length!==this.OWNER_LAYOUT.span)continue;const h=this.POOL_LAYOUT.decode(k.data),w=this.OWNER_LAYOUT.decode(A.data),T=h.openTime.toNumber(),b=h.endTime.toNumber(),v=w.tokenInfo.map(O=>O.debtAmount.gt(new I(0))).filter(O=>!O).length!==3,S=o>T&&o<b&&h.status===1,P=v&&S;l.push({programId:r,poolId:p,ammId:h.ammId,ownerAccountId:g,snapshotLpAmount:w.lpAmount,project:this.VERSION_PROJECT[f],openTime:T,endTime:b,canClaim:P,canClaimErrorType:v?S?void 0:"outOfOperationalTime":"alreadyClaimIt",tokenInfo:h.tokenInfo.map((O,L)=>({programId:N,mintAddress:O.mintAddress,mintVault:O.mintVault,mintDecimals:O.mintDecimals,perLpLoss:O.perLpLoss,debtAmount:w.tokenInfo[L].debtAmount.add(w.tokenInfo[L].claimedAmount)}))})}return l})}static makeClaimInstructionSimple(t){return U(this,arguments,function*({connection:n,poolInfo:r,ownerInfo:i,makeTxVersion:s,lookupTableCache:o}){const a=[],u=[],c=[],l=[],d=[],f=[],m=[],p=[];for(const g of r.tokenInfo)p.push(yield this._selectOrCreateTokenAccount({programId:g.programId,mint:g.mintAddress,tokenAccounts:g.mintAddress.equals(C.WSOL.mint)?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:n,payer:i.wallet,amount:0,frontInstructions:a,endInstructions:g.mintAddress.equals(C.WSOL.mint)?c:[],frontInstructionsType:u,endInstructionsType:l,signers:m},associatedOnly:g.mintAddress.equals(C.WSOL.mint)?!1:i.associatedOnly,checkCreateATAOwner:i.checkCreateATAOwner}));return d.push(this.makeClaimInstruction({programId:r.programId,poolInfo:r,ownerInfo:{wallet:i.wallet,ownerPda:r.ownerAccountId,claimAddress:p}})),f.push(8),{address:{},innerTransactions:yield at({connection:n,makeTxVersion:s,computeBudgetConfig:void 0,payer:i.wallet,innerTransaction:[{instructionTypes:u,instructions:a,signers:m},{instructionTypes:f,instructions:d,signers:[]},{instructionTypes:l,instructions:c,signers:[]}],lookupTableCache:o})}})}static makeClaimAllInstructionSimple(t){return U(this,arguments,function*({connection:n,poolInfos:r,ownerInfo:i,makeTxVersion:s,lookupTableCache:o}){var a;const u=[],c=[],l=[],d=[],f=[],m=[],p=[],g={};for(const k of r){const A=[];for(const h of k.tokenInfo){const w=(a=g[h.mintAddress.toString()])!=null?a:yield this._selectOrCreateTokenAccount({programId:h.programId,mint:h.mintAddress,tokenAccounts:h.mintAddress.equals(C.WSOL.mint)?[]:i.tokenAccounts,owner:i.wallet,createInfo:{connection:n,payer:i.wallet,amount:0,frontInstructions:u,endInstructions:h.mintAddress.equals(C.WSOL.mint)?l:[],frontInstructionsType:c,endInstructionsType:d,signers:p},associatedOnly:h.mintAddress.equals(C.WSOL.mint)?!1:i.associatedOnly,checkCreateATAOwner:i.checkCreateATAOwner});g[h.mintAddress.toString()]=w,A.push(w)}f.push(this.makeClaimInstruction({programId:k.programId,poolInfo:k,ownerInfo:{wallet:i.wallet,ownerPda:k.ownerAccountId,claimAddress:A}})),m.push(8)}return{address:{},innerTransactions:yield at({connection:n,makeTxVersion:s,computeBudgetConfig:void 0,payer:i.wallet,innerTransaction:[{instructionTypes:c,instructions:u,signers:p},{instructionTypes:m,instructions:f,signers:[]},{instructionTypes:d,instructions:l,signers:[]}],lookupTableCache:o})}})}static makeClaimInstruction({programId:t,poolInfo:n,ownerInfo:r}){const i=F([]),s=[{pubkey:r.wallet,isSigner:!0,isWritable:!0},{pubkey:n.poolId,isSigner:!1,isWritable:!0},{pubkey:r.ownerPda,isSigner:!1,isWritable:!0},...r.claimAddress.map(u=>({pubkey:u,isSigner:!1,isWritable:!0})),...n.tokenInfo.map(({mintVault:u})=>({pubkey:u,isSigner:!1,isWritable:!0})),{pubkey:N,isSigner:!1,isWritable:!1}],o=M.alloc(i.span);i.encode({},o);const a=M.from([10,66,208,184,161,6,191,98,...o]);return new nt({keys:s,programId:t,data:a})}};we.CLAIMED_NUM=3;we.POOL_LAYOUT=F([Tt(8),V("bump"),V("status"),y("openTime"),y("endTime"),q("ammId"),$(F([V("mintDecimals"),q("mintAddress"),q("mintVault"),y("perLpLoss"),y("totalClaimedAmount")]),we.CLAIMED_NUM,"tokenInfo"),$(y(),10,"padding")]);we.OWNER_LAYOUT=F([Tt(8),V("bump"),V("version"),q("poolId"),q("owner"),y("lpAmount"),$(F([q("mintAddress"),y("debtAmount"),y("claimedAmount")]),we.CLAIMED_NUM,"tokenInfo"),$(y(),4,"padding")]);we.DEFAULT_POOL_ID=["58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","AceAyRTWt4PyB2pHqf2qhDgNZDtKVNaxgL8Ru3V4aN1P","6tmFJbMk5yVHFcFy7X2K8RwHjKLr6KVFLYXpgpBNeAxB"].map(e=>new R(e));we.SEED_CONFIG={pool:{id:M.from("pool_seed","utf8")},owner:{id:M.from("user_claim_seed","utf8")}};we.VERSION_PROJECT=[void 0,"Francium","Tulip","Larix"];/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/export{Xe as ASSOCIATED_TOKEN_PROGRAM_ID,B as AccountMeta,E as AccountMetaReadonly,mc as BIT_PRECISION,kn as BNDivCeil,cn as BNLayout,Fn as Base,Cc as Clmm,rn as Currency,xt as CurrencyAmount,Vc as DataElement,Rn as EXTENSION_TICKARRAY_BITMAP_SIZE,Hi as ErrorCode,si as FARM_LEDGER_LAYOUT_V3_1,yn as FARM_LEDGER_LAYOUT_V3_2,oi as FARM_LEDGER_LAYOUT_V5_1,ns as FARM_LEDGER_LAYOUT_V5_2,Xa as FARM_LEDGER_LAYOUT_V6_1,Ga as FARM_STATE_LAYOUT_V3,za as FARM_STATE_LAYOUT_V5,je as FARM_STATE_LAYOUT_V6,Qa as FARM_VERSION_TO_LEDGER_LAYOUT,Ya as FARM_VERSION_TO_STATE_LAYOUT,Hn as FEE_RATE_DENOMINATOR,Bc as FETCH_TICKARRAY_COUNT,fi as Farm,Ge as Fraction,Tr as INSTRUCTION_PROGRAM_ID,Ar as LIQUIDITY_FEES_DENOMINATOR,ps as LIQUIDITY_FEES_NUMERATOR,Ja as LIQUIDITY_STATE_LAYOUT_V4,tc as LIQUIDITY_STATE_LAYOUT_V5,gi as LIQUIDITY_VERSION_TO_STATE_LAYOUT,fc as LOG_B_2_X32,pc as LOG_B_P_ERR_MARGIN_LOWER_X64,gc as LOG_B_P_ERR_MARGIN_UPPER_X64,Sr as Layout,cu as Liquidity,Bt as LiquidityMath,Qi as LogLevel,_t as Logger,Jr as MAINNET_SPL_TOKENS,ds as MARKET_STATE_LAYOUT_V3,Uc as MARKET_VERSION_TO_STATE_LAYOUT,$i as MAX_BASE64_SIZE,Be as MAX_SQRT_PRICE_X64,Xt as MAX_TICK,yr as MEMO_PROGRAM_ID,On as METADATA_PROGRAM_ID,Ie as MIN_SQRT_PRICE_X64,Vt as MIN_TICK,vi as Market,ot as MathUtil,hi as MaxU64,dc as MaxUint128,Gc as ModelDataInfo,Ze as ModelDataPubkey,Se as NEGATIVE_ONE,gt as ONE,bc as OPERATION_SEED,Ti as ObservationInfoLayout,Oc as ObservationLayout,xc as OperationLayout,yc as POOL_REWARD_VAULT_SEED,wc as POOL_SEED,Sc as POOL_TICK_ARRAY_BITMAP_SEED,kc as POOL_VAULT_SEED,ss as POSITION_SEED,Oe as Percent,Lc as PoolInfoLayout,oe as PoolUtils,Pc as PositionInfoLayout,Ec as PositionRewardInfoLayout,Si as PositionUtils,$t as Price,mr as Q128,_e as Q64,ts as REAL_FARM_STATE_LAYOUT_V3,es as REAL_FARM_STATE_LAYOUT_V5,Va as REAL_FARM_STATE_LAYOUT_V6,Ne as RENT_PROGRAM_ID,_c as RewardInfo,Wc as SERUM_PROGRAMID_TO_VERSION,Fc as SERUM_PROGRAM_ID_V3,Dc as SERUM_VERSION_TO_PROGRAMID,Ke as SOL,Zt as SPL_ACCOUNT_LAYOUT,au as SPL_MINT_LAYOUT,Pt as SYSTEM_PROGRAM_ID,dn as SYSVAR_CLOCK_PUBKEY,pe as SYSVAR_RENT_PUBKEY,mt as Spl,ut as SqrtPriceMath,Ra as Structure,bi as SwapMath,Ln as TEN,on as TICK_ARRAY_BITMAP_SIZE,Tc as TICK_ARRAY_SEED,Et as TICK_ARRAY_SIZE,N as TOKEN_PROGRAM_ID,Ue as TickArrayBitmap,yi as TickArrayBitmapExtension,Mc as TickArrayBitmapExtensionLayout,pr as TickArrayLayout,Rc as TickLayout,Nc as TickMath,dt as TickQuery,st as TickUtils,C as Token,ft as TokenAmount,xa as TxVersion,En as U64Resolution,jn as U64_IGNORE_RANGE,Ki as UInt,Ka as Voter,$a as VoterDepositEntry,Za as VoterLockup,ja as VoterRegistrar,Ha as VoterVotingMintConfig,Wt as WSOL,Oa as WideBits,Ji as WrappedLayout,Y as ZERO,wa as _100,ei as _100_PERCENT,ls as _SERUM_PROGRAM_ID_V3,ri as bits,Tt as blob,Yt as bool,Zr as chunkArray,ic as closePositionInstruction,lc as collectRewardInstruction,ec as createPoolInstruction,ve as currencyEquals,Ea as decodeBool,ac as decreaseLiquidityInstruction,Yn as divCeil,Pa as encodeBool,ii as fetchMultipleMintInfos,ct as findProgramAddress,Zi as forecastTransactionSize,tu as formatLayout,sn as generatePubKey,Jc as getDxByDyBaseIn,Kc as getDyByDxBaseIn,ce as getMultipleAccountsInfo,_n as getMultipleAccountsInfoWithCustomFlags,ha as getMultipleLookupTableInfo,ie as getPdaExBitmapAccount,ki as getPdaMetadataKey,Zn as getPdaOperationAccount,Te as getPdaPersonalPositionAddress,vc as getPdaPoolId,Ic as getPdaPoolRewardVaulId,wi as getPdaPoolVaultId,He as getPdaProtocolPositionAddress,wt as getPdaTickArrayAddress,eu as getStablePrice,qt as getTransferAmountFee,La as i128,fr as i32ToBytes,dr as i64,_a as i8,oc as increasePositionFromBaseInstruction,sc as increasePositionFromLiquidityInstruction,cc as initRewardInstruction,nu as initStableModelLayout,Pn as isZero,rs as leadingZeros,hc as leastSignificantBit,Qn as minExpirationTime,Ac as mostSignificantBit,rc as openPositionFromBaseInstruction,nc as openPositionFromLiquidityInstruction,X as parseBigNumberish,fa as parseSimulateLogToJson,me as parseSimulateValue,We as poolTypeV6,q as publicKey,Mt as s32,$ as seq,uc as setRewardInstruction,ma as simulateMultipleInstruction,pa as simulateTransaction,ba as splitNumber,at as splitTxAndSigners,F as struct,Ai as swapInstruction,Kr as tenExponentiate,is as trailingZeros,J as u128,tn as u16,Ut as u32,y as u64,V as u8,sr as validateAndParsePublicKey};
